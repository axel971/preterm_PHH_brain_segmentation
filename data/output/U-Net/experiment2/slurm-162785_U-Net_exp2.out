U-Net cross-validation
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2021-09-18 09:34:31.993598: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(41, 256, 128, 256)
..loading data finished Sat Sep 18 09:34:57 2021
2021-09-18 09:34:57.746735: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-09-18 09:34:57.799225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-18 09:34:57.799266: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-18 09:34:57.806355: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-18 09:34:57.806434: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-09-18 09:34:57.809229: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-09-18 09:34:57.809883: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-09-18 09:34:57.810786: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-09-18 09:34:57.811951: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-09-18 09:34:57.812441: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-18 09:34:57.816348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-18 09:34:57.821402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-18 09:34:57.825250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-18 09:34:57.825290: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-18 09:34:58.299315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-18 09:34:58.299378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-09-18 09:34:58.299435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-09-18 09:34:58.305034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38184 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:3b:00.0, compute capability: 8.0)
---------fold--1---------
training set:  [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [0 1 2 3 4 5 6 7 8 9]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
2021-09-18 09:35:00.600495: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-09-18 09:35:00.600975: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2100000000 Hz
2021-09-18 09:35:02.900175: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-18 09:35:03.876136: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2021-09-18 09:35:04.850326: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-18 09:35:05.641341: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 126s - loss: 0.6744 - dice_multi: 0.3776
Epoch 2/100
400/400 - 97s - loss: 0.5098 - dice_multi: 0.4608
Epoch 3/100
400/400 - 97s - loss: 0.4252 - dice_multi: 0.5143
Epoch 4/100
400/400 - 97s - loss: 0.3643 - dice_multi: 0.5774
Epoch 5/100
400/400 - 97s - loss: 0.3016 - dice_multi: 0.6323
Epoch 6/100
400/400 - 97s - loss: 0.2712 - dice_multi: 0.6703
Epoch 7/100
400/400 - 97s - loss: 0.2284 - dice_multi: 0.7088
Epoch 8/100
400/400 - 98s - loss: 0.2187 - dice_multi: 0.7244
Epoch 9/100
400/400 - 97s - loss: 0.1782 - dice_multi: 0.7581
Epoch 10/100
400/400 - 98s - loss: 0.1730 - dice_multi: 0.7708
Epoch 11/100
400/400 - 97s - loss: 0.1699 - dice_multi: 0.7722
Epoch 12/100
400/400 - 97s - loss: 0.1609 - dice_multi: 0.7790
Epoch 13/100
400/400 - 97s - loss: 0.1587 - dice_multi: 0.7880
Epoch 14/100
400/400 - 97s - loss: 0.1584 - dice_multi: 0.7870
Epoch 15/100
400/400 - 97s - loss: 0.1442 - dice_multi: 0.8089
Epoch 16/100
400/400 - 97s - loss: 0.1438 - dice_multi: 0.7993
Epoch 17/100
400/400 - 97s - loss: 0.1364 - dice_multi: 0.8194
Epoch 18/100
400/400 - 97s - loss: 0.1416 - dice_multi: 0.8168
Epoch 19/100
400/400 - 98s - loss: 0.1403 - dice_multi: 0.8118
Epoch 20/100
400/400 - 97s - loss: 0.1290 - dice_multi: 0.8228
Epoch 21/100
400/400 - 97s - loss: 0.1230 - dice_multi: 0.8366
Epoch 22/100
400/400 - 97s - loss: 0.1241 - dice_multi: 0.8303
Epoch 23/100
400/400 - 97s - loss: 0.1381 - dice_multi: 0.8091
Epoch 24/100
400/400 - 97s - loss: 0.1224 - dice_multi: 0.8349
Epoch 25/100
400/400 - 97s - loss: 0.1185 - dice_multi: 0.8364
Epoch 26/100
400/400 - 97s - loss: 0.1470 - dice_multi: 0.8126
Epoch 27/100
400/400 - 97s - loss: 0.1158 - dice_multi: 0.8374
Epoch 28/100
400/400 - 97s - loss: 0.1138 - dice_multi: 0.8446
Epoch 29/100
400/400 - 97s - loss: 0.1224 - dice_multi: 0.8403
Epoch 30/100
400/400 - 97s - loss: 0.1119 - dice_multi: 0.8496
Epoch 31/100
400/400 - 97s - loss: 0.1059 - dice_multi: 0.8500
Epoch 32/100
400/400 - 97s - loss: 0.1079 - dice_multi: 0.8541
Epoch 33/100
400/400 - 97s - loss: 0.1104 - dice_multi: 0.8541
Epoch 34/100
400/400 - 97s - loss: 0.1346 - dice_multi: 0.8217
Epoch 35/100
400/400 - 97s - loss: 0.1137 - dice_multi: 0.8398
Epoch 36/100
400/400 - 97s - loss: 0.1070 - dice_multi: 0.8503
Epoch 37/100
400/400 - 98s - loss: 0.1052 - dice_multi: 0.8612
Epoch 38/100
400/400 - 97s - loss: 0.1069 - dice_multi: 0.8492
Epoch 39/100
400/400 - 97s - loss: 0.1087 - dice_multi: 0.8504
Epoch 40/100
400/400 - 98s - loss: 0.1051 - dice_multi: 0.8498
Epoch 41/100
400/400 - 97s - loss: 0.1030 - dice_multi: 0.8572
Epoch 42/100
400/400 - 98s - loss: 0.1007 - dice_multi: 0.8603
Epoch 43/100
400/400 - 97s - loss: 0.0992 - dice_multi: 0.8553
Epoch 44/100
400/400 - 98s - loss: 0.0997 - dice_multi: 0.8563
Epoch 45/100
400/400 - 97s - loss: 0.1192 - dice_multi: 0.8431
Epoch 46/100
400/400 - 97s - loss: 0.0983 - dice_multi: 0.8680
Epoch 47/100
400/400 - 97s - loss: 0.1014 - dice_multi: 0.8609
Epoch 48/100
400/400 - 97s - loss: 0.1099 - dice_multi: 0.8451
Epoch 49/100
400/400 - 97s - loss: 0.1058 - dice_multi: 0.8504
Epoch 50/100
400/400 - 97s - loss: 0.0969 - dice_multi: 0.8615
Epoch 51/100
400/400 - 97s - loss: 0.0940 - dice_multi: 0.8665
Epoch 52/100
400/400 - 97s - loss: 0.0947 - dice_multi: 0.8687
Epoch 53/100
400/400 - 97s - loss: 0.0954 - dice_multi: 0.8675
Epoch 54/100
400/400 - 97s - loss: 0.0955 - dice_multi: 0.8625
Epoch 55/100
400/400 - 97s - loss: 0.0958 - dice_multi: 0.8685
Epoch 56/100
400/400 - 97s - loss: 0.0927 - dice_multi: 0.8692
Epoch 57/100
400/400 - 97s - loss: 0.0905 - dice_multi: 0.8595
Epoch 58/100
400/400 - 97s - loss: 0.1073 - dice_multi: 0.8540
Epoch 59/100
400/400 - 97s - loss: 0.0942 - dice_multi: 0.8698
Epoch 60/100
400/400 - 97s - loss: 0.0924 - dice_multi: 0.8659
Epoch 61/100
400/400 - 97s - loss: 0.0929 - dice_multi: 0.8714
Epoch 62/100
400/400 - 97s - loss: 0.0895 - dice_multi: 0.8693
Epoch 63/100
400/400 - 97s - loss: 0.0917 - dice_multi: 0.8698
Epoch 64/100
400/400 - 97s - loss: 0.0959 - dice_multi: 0.8676
Epoch 65/100
400/400 - 97s - loss: 0.0897 - dice_multi: 0.8692
Epoch 66/100
400/400 - 97s - loss: 0.0894 - dice_multi: 0.8778
Epoch 67/100
400/400 - 97s - loss: 0.0875 - dice_multi: 0.8647
Epoch 68/100
400/400 - 98s - loss: 0.0899 - dice_multi: 0.8750
Epoch 69/100
400/400 - 98s - loss: 0.0881 - dice_multi: 0.8739
Epoch 70/100
400/400 - 98s - loss: 0.0878 - dice_multi: 0.8734
Epoch 71/100
400/400 - 98s - loss: 0.0880 - dice_multi: 0.8729
Epoch 72/100
400/400 - 98s - loss: 0.0865 - dice_multi: 0.8734
Epoch 73/100
400/400 - 98s - loss: 0.0881 - dice_multi: 0.8774
Epoch 74/100
400/400 - 97s - loss: 0.1017 - dice_multi: 0.8567
Epoch 75/100
400/400 - 98s - loss: 0.0865 - dice_multi: 0.8729
Epoch 76/100
400/400 - 97s - loss: 0.0845 - dice_multi: 0.8776
Epoch 77/100
400/400 - 97s - loss: 0.0847 - dice_multi: 0.8824
Epoch 78/100
400/400 - 97s - loss: 0.0851 - dice_multi: 0.8815
Epoch 79/100
400/400 - 98s - loss: 0.0820 - dice_multi: 0.8749
Epoch 80/100
400/400 - 97s - loss: 0.0851 - dice_multi: 0.8756
Epoch 81/100
400/400 - 97s - loss: 0.0833 - dice_multi: 0.8777
Epoch 82/100
400/400 - 97s - loss: 0.0843 - dice_multi: 0.8792
Epoch 83/100
400/400 - 97s - loss: 0.0842 - dice_multi: 0.8756
Epoch 84/100
400/400 - 97s - loss: 0.0840 - dice_multi: 0.8811
Epoch 85/100
400/400 - 97s - loss: 0.0842 - dice_multi: 0.8769
Epoch 86/100
400/400 - 97s - loss: 0.0850 - dice_multi: 0.8766
Epoch 87/100
400/400 - 97s - loss: 0.0811 - dice_multi: 0.8790
Epoch 88/100
400/400 - 97s - loss: 0.0999 - dice_multi: 0.8627
Epoch 89/100
400/400 - 98s - loss: 0.0944 - dice_multi: 0.8633
Epoch 90/100
400/400 - 97s - loss: 0.0854 - dice_multi: 0.8798
Epoch 91/100
400/400 - 97s - loss: 0.0807 - dice_multi: 0.8800
Epoch 92/100
400/400 - 97s - loss: 0.0808 - dice_multi: 0.8809
Epoch 93/100
400/400 - 97s - loss: 0.0812 - dice_multi: 0.8773
Epoch 94/100
400/400 - 97s - loss: 0.0817 - dice_multi: 0.8863
Epoch 95/100
400/400 - 97s - loss: 0.0791 - dice_multi: 0.8799
Epoch 96/100
400/400 - 97s - loss: 0.0816 - dice_multi: 0.8887
Epoch 97/100
400/400 - 97s - loss: 0.0781 - dice_multi: 0.8783
Epoch 98/100
400/400 - 97s - loss: 0.0795 - dice_multi: 0.8849
Epoch 99/100
400/400 - 97s - loss: 0.0767 - dice_multi: 0.8832
Epoch 100/100
400/400 - 97s - loss: 0.0782 - dice_multi: 0.8874
2021-09-18 12:17:55.049112: I tensorflow/stream_executor/cuda/cuda_blas.cc:1839] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
training time: 9769.632344961166
executation time:22.74946539402008
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [10 11 12 13 14 15 16 17 18 19]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 100s - loss: 0.6401 - dice_multi: 0.3726
Epoch 2/100
400/400 - 98s - loss: 0.5039 - dice_multi: 0.4530
Epoch 3/100
400/400 - 98s - loss: 0.4430 - dice_multi: 0.5032
Epoch 4/100
400/400 - 98s - loss: 0.3760 - dice_multi: 0.5601
Epoch 5/100
400/400 - 98s - loss: 0.3065 - dice_multi: 0.6303
Epoch 6/100
400/400 - 98s - loss: 0.2764 - dice_multi: 0.6659
Epoch 7/100
400/400 - 98s - loss: 0.2436 - dice_multi: 0.6918
Epoch 8/100
400/400 - 98s - loss: 0.2183 - dice_multi: 0.7155
Epoch 9/100
400/400 - 98s - loss: 0.2068 - dice_multi: 0.7332
Epoch 10/100
400/400 - 98s - loss: 0.1876 - dice_multi: 0.7541
Epoch 11/100
400/400 - 98s - loss: 0.1803 - dice_multi: 0.7578
Epoch 12/100
400/400 - 98s - loss: 0.1682 - dice_multi: 0.7807
Epoch 13/100
400/400 - 98s - loss: 0.1702 - dice_multi: 0.7798
Epoch 14/100
400/400 - 98s - loss: 0.1651 - dice_multi: 0.7796
Epoch 15/100
400/400 - 98s - loss: 0.1629 - dice_multi: 0.7814
Epoch 16/100
400/400 - 98s - loss: 0.1490 - dice_multi: 0.7907
Epoch 17/100
400/400 - 98s - loss: 0.1416 - dice_multi: 0.8023
Epoch 18/100
400/400 - 98s - loss: 0.1428 - dice_multi: 0.8010
Epoch 19/100
400/400 - 98s - loss: 0.1450 - dice_multi: 0.8027
Epoch 20/100
400/400 - 98s - loss: 0.1490 - dice_multi: 0.8052
Epoch 21/100
400/400 - 99s - loss: 0.1529 - dice_multi: 0.7974
Epoch 22/100
400/400 - 98s - loss: 0.1298 - dice_multi: 0.8147
Epoch 23/100
400/400 - 98s - loss: 0.1259 - dice_multi: 0.8132
Epoch 24/100
400/400 - 99s - loss: 0.1292 - dice_multi: 0.8189
Epoch 25/100
400/400 - 98s - loss: 0.1354 - dice_multi: 0.8095
Epoch 26/100
400/400 - 98s - loss: 0.1222 - dice_multi: 0.8224
Epoch 27/100
400/400 - 98s - loss: 0.1200 - dice_multi: 0.8323
Epoch 28/100
400/400 - 99s - loss: 0.1274 - dice_multi: 0.8209
Epoch 29/100
400/400 - 99s - loss: 0.1378 - dice_multi: 0.8116
Epoch 30/100
400/400 - 99s - loss: 0.1162 - dice_multi: 0.8345
Epoch 31/100
400/400 - 99s - loss: 0.1145 - dice_multi: 0.8380
Epoch 32/100
400/400 - 99s - loss: 0.1150 - dice_multi: 0.8276
Epoch 33/100
400/400 - 98s - loss: 0.1317 - dice_multi: 0.8154
Epoch 34/100
400/400 - 98s - loss: 0.1133 - dice_multi: 0.8344
Epoch 35/100
400/400 - 98s - loss: 0.1107 - dice_multi: 0.8417
Epoch 36/100
400/400 - 98s - loss: 0.1082 - dice_multi: 0.8389
Epoch 37/100
400/400 - 98s - loss: 0.1092 - dice_multi: 0.8417
Epoch 38/100
400/400 - 98s - loss: 0.1099 - dice_multi: 0.8428
Epoch 39/100
400/400 - 98s - loss: 0.1378 - dice_multi: 0.8076
Epoch 40/100
400/400 - 98s - loss: 0.1083 - dice_multi: 0.8350
Epoch 41/100
400/400 - 98s - loss: 0.1063 - dice_multi: 0.8473
Epoch 42/100
400/400 - 98s - loss: 0.1078 - dice_multi: 0.8443
Epoch 43/100
400/400 - 98s - loss: 0.1053 - dice_multi: 0.8520
Epoch 44/100
400/400 - 98s - loss: 0.1042 - dice_multi: 0.8464
Epoch 45/100
400/400 - 98s - loss: 0.1043 - dice_multi: 0.8497
Epoch 46/100
400/400 - 98s - loss: 0.1054 - dice_multi: 0.8457
Epoch 47/100
400/400 - 98s - loss: 0.1002 - dice_multi: 0.8496
Epoch 48/100
400/400 - 98s - loss: 0.1257 - dice_multi: 0.8258
Epoch 49/100
400/400 - 98s - loss: 0.1205 - dice_multi: 0.8378
Epoch 50/100
400/400 - 98s - loss: 0.1043 - dice_multi: 0.8526
Epoch 51/100
400/400 - 98s - loss: 0.1012 - dice_multi: 0.8563
Epoch 52/100
400/400 - 98s - loss: 0.1298 - dice_multi: 0.8245
Epoch 53/100
400/400 - 98s - loss: 0.1029 - dice_multi: 0.8523
Epoch 54/100
400/400 - 98s - loss: 0.0993 - dice_multi: 0.8509
Epoch 55/100
400/400 - 98s - loss: 0.0997 - dice_multi: 0.8577
Epoch 56/100
400/400 - 98s - loss: 0.0981 - dice_multi: 0.8571
Epoch 57/100
400/400 - 98s - loss: 0.0959 - dice_multi: 0.8571
Epoch 58/100
400/400 - 98s - loss: 0.1127 - dice_multi: 0.8427
Epoch 59/100
400/400 - 98s - loss: 0.0973 - dice_multi: 0.8546
Epoch 60/100
400/400 - 98s - loss: 0.0966 - dice_multi: 0.8562
Epoch 61/100
400/400 - 98s - loss: 0.0977 - dice_multi: 0.8615
Epoch 62/100
400/400 - 98s - loss: 0.0963 - dice_multi: 0.8503
Epoch 63/100
400/400 - 98s - loss: 0.1135 - dice_multi: 0.8394
Epoch 64/100
400/400 - 98s - loss: 0.1036 - dice_multi: 0.8479
Epoch 65/100
400/400 - 98s - loss: 0.1050 - dice_multi: 0.8476
Epoch 66/100
400/400 - 98s - loss: 0.0966 - dice_multi: 0.8625
Epoch 67/100
400/400 - 98s - loss: 0.0958 - dice_multi: 0.8605
Epoch 68/100
400/400 - 99s - loss: 0.0949 - dice_multi: 0.8575
Epoch 69/100
400/400 - 99s - loss: 0.0945 - dice_multi: 0.8616
Epoch 70/100
400/400 - 99s - loss: 0.0929 - dice_multi: 0.8629
Epoch 71/100
400/400 - 98s - loss: 0.0929 - dice_multi: 0.8569
Epoch 72/100
400/400 - 98s - loss: 0.0949 - dice_multi: 0.8605
Epoch 73/100
400/400 - 99s - loss: 0.0941 - dice_multi: 0.8631
Epoch 74/100
400/400 - 98s - loss: 0.1109 - dice_multi: 0.8449
Epoch 75/100
400/400 - 99s - loss: 0.0995 - dice_multi: 0.8563
Epoch 76/100
400/400 - 99s - loss: 0.0945 - dice_multi: 0.8608
Epoch 77/100
400/400 - 98s - loss: 0.0917 - dice_multi: 0.8657
Epoch 78/100
400/400 - 98s - loss: 0.0903 - dice_multi: 0.8616
Epoch 79/100
400/400 - 98s - loss: 0.0896 - dice_multi: 0.8618
Epoch 80/100
400/400 - 98s - loss: 0.0907 - dice_multi: 0.8635
Epoch 81/100
400/400 - 99s - loss: 0.0933 - dice_multi: 0.8611
Epoch 82/100
400/400 - 99s - loss: 0.0876 - dice_multi: 0.8643
Epoch 83/100
400/400 - 98s - loss: 0.0873 - dice_multi: 0.8638
Epoch 84/100
400/400 - 98s - loss: 0.0912 - dice_multi: 0.8680
Epoch 85/100
400/400 - 98s - loss: 0.0909 - dice_multi: 0.8668
Epoch 86/100
400/400 - 99s - loss: 0.0897 - dice_multi: 0.8646
Epoch 87/100
400/400 - 98s - loss: 0.0891 - dice_multi: 0.8667
Epoch 88/100
400/400 - 98s - loss: 0.0919 - dice_multi: 0.8588
Epoch 89/100
400/400 - 98s - loss: 0.0892 - dice_multi: 0.8637
Epoch 90/100
400/400 - 98s - loss: 0.0853 - dice_multi: 0.8628
Epoch 91/100
400/400 - 99s - loss: 0.0893 - dice_multi: 0.8672
Epoch 92/100
400/400 - 99s - loss: 0.0866 - dice_multi: 0.8664
Epoch 93/100
400/400 - 98s - loss: 0.0865 - dice_multi: 0.8714
Epoch 94/100
400/400 - 99s - loss: 0.0845 - dice_multi: 0.8679
Epoch 95/100
400/400 - 98s - loss: 0.0884 - dice_multi: 0.8654
Epoch 96/100
400/400 - 99s - loss: 0.0848 - dice_multi: 0.8624
Epoch 97/100
400/400 - 99s - loss: 0.0848 - dice_multi: 0.8688
Epoch 98/100
400/400 - 99s - loss: 0.0852 - dice_multi: 0.8641
Epoch 99/100
400/400 - 99s - loss: 0.0822 - dice_multi: 0.8716
Epoch 100/100
400/400 - 99s - loss: 0.1033 - dice_multi: 0.8507
training time: 9847.912306070328
executation time:23.049944591522216
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [20 21 22 23 24 25 26 27 28 29]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 101s - loss: 0.6362 - dice_multi: 0.3565
Epoch 2/100
400/400 - 99s - loss: 0.5195 - dice_multi: 0.4158
Epoch 3/100
400/400 - 99s - loss: 0.4450 - dice_multi: 0.4663
Epoch 4/100
400/400 - 99s - loss: 0.3995 - dice_multi: 0.4972
Epoch 5/100
400/400 - 99s - loss: 0.3695 - dice_multi: 0.5388
Epoch 6/100
400/400 - 99s - loss: 0.3436 - dice_multi: 0.5753
Epoch 7/100
400/400 - 98s - loss: 0.2932 - dice_multi: 0.6129
Epoch 8/100
400/400 - 98s - loss: 0.2814 - dice_multi: 0.6415
Epoch 9/100
400/400 - 98s - loss: 0.2420 - dice_multi: 0.6724
Epoch 10/100
400/400 - 98s - loss: 0.2349 - dice_multi: 0.6939
Epoch 11/100
400/400 - 98s - loss: 0.2011 - dice_multi: 0.7227
Epoch 12/100
400/400 - 98s - loss: 0.1956 - dice_multi: 0.7308
Epoch 13/100
400/400 - 98s - loss: 0.1864 - dice_multi: 0.7341
Epoch 14/100
400/400 - 99s - loss: 0.1817 - dice_multi: 0.7538
Epoch 15/100
400/400 - 99s - loss: 0.1607 - dice_multi: 0.7597
Epoch 16/100
400/400 - 98s - loss: 0.1651 - dice_multi: 0.7674
Epoch 17/100
400/400 - 98s - loss: 0.1775 - dice_multi: 0.7537
Epoch 18/100
400/400 - 99s - loss: 0.1605 - dice_multi: 0.7691
Epoch 19/100
400/400 - 98s - loss: 0.1537 - dice_multi: 0.7855
Epoch 20/100
400/400 - 98s - loss: 0.1544 - dice_multi: 0.7827
Epoch 21/100
400/400 - 99s - loss: 0.1362 - dice_multi: 0.7939
Epoch 22/100
400/400 - 98s - loss: 0.1418 - dice_multi: 0.8009
Epoch 23/100
400/400 - 98s - loss: 0.1342 - dice_multi: 0.8086
Epoch 24/100
400/400 - 99s - loss: 0.1337 - dice_multi: 0.8009
Epoch 25/100
400/400 - 99s - loss: 0.1367 - dice_multi: 0.8061
Epoch 26/100
400/400 - 99s - loss: 0.1332 - dice_multi: 0.8067
Epoch 27/100
400/400 - 99s - loss: 0.1273 - dice_multi: 0.8176
Epoch 28/100
400/400 - 99s - loss: 0.1500 - dice_multi: 0.7787
Epoch 29/100
400/400 - 99s - loss: 0.1258 - dice_multi: 0.8166
Epoch 30/100
400/400 - 99s - loss: 0.1232 - dice_multi: 0.8198
Epoch 31/100
400/400 - 99s - loss: 0.1187 - dice_multi: 0.8245
Epoch 32/100
400/400 - 99s - loss: 0.1179 - dice_multi: 0.8262
Epoch 33/100
400/400 - 99s - loss: 0.1213 - dice_multi: 0.8162
Epoch 34/100
400/400 - 99s - loss: 0.1191 - dice_multi: 0.8241
Epoch 35/100
400/400 - 99s - loss: 0.1186 - dice_multi: 0.8179
Epoch 36/100
400/400 - 99s - loss: 0.1100 - dice_multi: 0.8320
Epoch 37/100
400/400 - 99s - loss: 0.1126 - dice_multi: 0.8327
Epoch 38/100
400/400 - 99s - loss: 0.1249 - dice_multi: 0.8087
Epoch 39/100
400/400 - 99s - loss: 0.1125 - dice_multi: 0.8346
Epoch 40/100
400/400 - 99s - loss: 0.1042 - dice_multi: 0.8322
Epoch 41/100
400/400 - 99s - loss: 0.1240 - dice_multi: 0.8224
Epoch 42/100
400/400 - 99s - loss: 0.1119 - dice_multi: 0.8366
Epoch 43/100
400/400 - 98s - loss: 0.1057 - dice_multi: 0.8335
Epoch 44/100
400/400 - 99s - loss: 0.1054 - dice_multi: 0.8361
Epoch 45/100
400/400 - 99s - loss: 0.1013 - dice_multi: 0.8380
Epoch 46/100
400/400 - 99s - loss: 0.0997 - dice_multi: 0.8383
Epoch 47/100
400/400 - 99s - loss: 0.1017 - dice_multi: 0.8350
Epoch 48/100
400/400 - 99s - loss: 0.1085 - dice_multi: 0.8389
Epoch 49/100
400/400 - 99s - loss: 0.1068 - dice_multi: 0.8420
Epoch 50/100
400/400 - 99s - loss: 0.1013 - dice_multi: 0.8459
Epoch 51/100
400/400 - 99s - loss: 0.1068 - dice_multi: 0.8418
Epoch 52/100
400/400 - 99s - loss: 0.1044 - dice_multi: 0.8399
Epoch 53/100
400/400 - 99s - loss: 0.0979 - dice_multi: 0.8455
Epoch 54/100
400/400 - 99s - loss: 0.0993 - dice_multi: 0.8503
Epoch 55/100
400/400 - 99s - loss: 0.1008 - dice_multi: 0.8521
Epoch 56/100
400/400 - 99s - loss: 0.0988 - dice_multi: 0.8431
Epoch 57/100
400/400 - 99s - loss: 0.0976 - dice_multi: 0.8461
Epoch 58/100
400/400 - 99s - loss: 0.0951 - dice_multi: 0.8439
Epoch 59/100
400/400 - 99s - loss: 0.0969 - dice_multi: 0.8479
Epoch 60/100
400/400 - 99s - loss: 0.1411 - dice_multi: 0.8112
Epoch 61/100
400/400 - 99s - loss: 0.1027 - dice_multi: 0.8342
Epoch 62/100
400/400 - 98s - loss: 0.0986 - dice_multi: 0.8466
Epoch 63/100
400/400 - 98s - loss: 0.0945 - dice_multi: 0.8578
Epoch 64/100
400/400 - 99s - loss: 0.0953 - dice_multi: 0.8577
Epoch 65/100
400/400 - 99s - loss: 0.0914 - dice_multi: 0.8538
Epoch 66/100
400/400 - 99s - loss: 0.0976 - dice_multi: 0.8511
Epoch 67/100
400/400 - 98s - loss: 0.0963 - dice_multi: 0.8516
Epoch 68/100
400/400 - 99s - loss: 0.0915 - dice_multi: 0.8522
Epoch 69/100
400/400 - 98s - loss: 0.0915 - dice_multi: 0.8523
Epoch 70/100
400/400 - 98s - loss: 0.0909 - dice_multi: 0.8536
Epoch 71/100
400/400 - 99s - loss: 0.0918 - dice_multi: 0.8573
Epoch 72/100
400/400 - 99s - loss: 0.0922 - dice_multi: 0.8641
Epoch 73/100
400/400 - 99s - loss: 0.0917 - dice_multi: 0.8581
Epoch 74/100
400/400 - 99s - loss: 0.0948 - dice_multi: 0.8497
Epoch 75/100
400/400 - 99s - loss: 0.0889 - dice_multi: 0.8544
Epoch 76/100
400/400 - 99s - loss: 0.0927 - dice_multi: 0.8590
Epoch 77/100
400/400 - 98s - loss: 0.0888 - dice_multi: 0.8567
Epoch 78/100
400/400 - 99s - loss: 0.1075 - dice_multi: 0.8385
Epoch 79/100
400/400 - 99s - loss: 0.0909 - dice_multi: 0.8525
Epoch 80/100
400/400 - 99s - loss: 0.0903 - dice_multi: 0.8613
Epoch 81/100
400/400 - 99s - loss: 0.0880 - dice_multi: 0.8516
Epoch 82/100
400/400 - 99s - loss: 0.0863 - dice_multi: 0.8647
Epoch 83/100
400/400 - 99s - loss: 0.0882 - dice_multi: 0.8566
Epoch 84/100
400/400 - 99s - loss: 0.0882 - dice_multi: 0.8615
Epoch 85/100
400/400 - 99s - loss: 0.0867 - dice_multi: 0.8631
Epoch 86/100
400/400 - 99s - loss: 0.0881 - dice_multi: 0.8622
Epoch 87/100
400/400 - 99s - loss: 0.1013 - dice_multi: 0.8444
Epoch 88/100
400/400 - 99s - loss: 0.0862 - dice_multi: 0.8592
Epoch 89/100
400/400 - 99s - loss: 0.0876 - dice_multi: 0.8616
Epoch 90/100
400/400 - 98s - loss: 0.0867 - dice_multi: 0.8704
Epoch 91/100
400/400 - 99s - loss: 0.0841 - dice_multi: 0.8650
Epoch 92/100
400/400 - 99s - loss: 0.0870 - dice_multi: 0.8705
Epoch 93/100
400/400 - 99s - loss: 0.0846 - dice_multi: 0.8630
Epoch 94/100
400/400 - 99s - loss: 0.0841 - dice_multi: 0.8646
Epoch 95/100
400/400 - 99s - loss: 0.0837 - dice_multi: 0.8582
Epoch 96/100
400/400 - 98s - loss: 0.0843 - dice_multi: 0.8598
Epoch 97/100
400/400 - 99s - loss: 0.0830 - dice_multi: 0.8650
Epoch 98/100
400/400 - 99s - loss: 0.0849 - dice_multi: 0.8686
Epoch 99/100
400/400 - 98s - loss: 0.0838 - dice_multi: 0.8652
Epoch 100/100
400/400 - 99s - loss: 0.0971 - dice_multi: 0.8531
training time: 9873.753983259201
executation time:22.947545886039734
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]
training set size:  30
testing set:  [30 31 32 33 34 35 36 37 38 39 40]
testing set size:  11
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 100s - loss: 0.6876 - dice_multi: 0.3969
Epoch 2/100
400/400 - 98s - loss: 0.5502 - dice_multi: 0.4593
Epoch 3/100
400/400 - 98s - loss: 0.4701 - dice_multi: 0.5125
Epoch 4/100
400/400 - 99s - loss: 0.4157 - dice_multi: 0.5667
Epoch 5/100
400/400 - 99s - loss: 0.3583 - dice_multi: 0.6109
Epoch 6/100
400/400 - 98s - loss: 0.3041 - dice_multi: 0.6663
Epoch 7/100
400/400 - 99s - loss: 0.2766 - dice_multi: 0.6988
Epoch 8/100
400/400 - 99s - loss: 0.2468 - dice_multi: 0.7225
Epoch 9/100
400/400 - 98s - loss: 0.2214 - dice_multi: 0.7398
Epoch 10/100
400/400 - 99s - loss: 0.2154 - dice_multi: 0.7478
Epoch 11/100
400/400 - 98s - loss: 0.1980 - dice_multi: 0.7643
Epoch 12/100
400/400 - 98s - loss: 0.1894 - dice_multi: 0.7745
Epoch 13/100
400/400 - 98s - loss: 0.1756 - dice_multi: 0.7856
Epoch 14/100
400/400 - 98s - loss: 0.1721 - dice_multi: 0.7946
Epoch 15/100
400/400 - 99s - loss: 0.1943 - dice_multi: 0.7771
Epoch 16/100
400/400 - 99s - loss: 0.1582 - dice_multi: 0.8089
Epoch 17/100
400/400 - 98s - loss: 0.1482 - dice_multi: 0.8177
Epoch 18/100
400/400 - 99s - loss: 0.1587 - dice_multi: 0.8122
Epoch 19/100
400/400 - 99s - loss: 0.1623 - dice_multi: 0.8000
Epoch 20/100
400/400 - 98s - loss: 0.1451 - dice_multi: 0.8237
Epoch 21/100
400/400 - 99s - loss: 0.1545 - dice_multi: 0.8103
Epoch 22/100
400/400 - 99s - loss: 0.1418 - dice_multi: 0.8356
Epoch 23/100
400/400 - 99s - loss: 0.1332 - dice_multi: 0.8316
Epoch 24/100
400/400 - 99s - loss: 0.1359 - dice_multi: 0.8283
Epoch 25/100
400/400 - 99s - loss: 0.1306 - dice_multi: 0.8388
Epoch 26/100
400/400 - 99s - loss: 0.1381 - dice_multi: 0.8363
Epoch 27/100
400/400 - 99s - loss: 0.1389 - dice_multi: 0.8299
Epoch 28/100
400/400 - 99s - loss: 0.1291 - dice_multi: 0.8372
Epoch 29/100
400/400 - 98s - loss: 0.1243 - dice_multi: 0.8359
Epoch 30/100
400/400 - 99s - loss: 0.1253 - dice_multi: 0.8372
Epoch 31/100
400/400 - 99s - loss: 0.1254 - dice_multi: 0.8440
Epoch 32/100
400/400 - 98s - loss: 0.1305 - dice_multi: 0.8372
Epoch 33/100
400/400 - 98s - loss: 0.1227 - dice_multi: 0.8484
Epoch 34/100
400/400 - 99s - loss: 0.1182 - dice_multi: 0.8480
Epoch 35/100
400/400 - 98s - loss: 0.1217 - dice_multi: 0.8466
Epoch 36/100
400/400 - 99s - loss: 0.1604 - dice_multi: 0.8070
Epoch 37/100
400/400 - 99s - loss: 0.1198 - dice_multi: 0.8471
Epoch 38/100
400/400 - 99s - loss: 0.1173 - dice_multi: 0.8545
Epoch 39/100
400/400 - 99s - loss: 0.1163 - dice_multi: 0.8525
Epoch 40/100
400/400 - 99s - loss: 0.1183 - dice_multi: 0.8434
Epoch 41/100
400/400 - 99s - loss: 0.1144 - dice_multi: 0.8467
Epoch 42/100
400/400 - 99s - loss: 0.1124 - dice_multi: 0.8544
Epoch 43/100
400/400 - 99s - loss: 0.1150 - dice_multi: 0.8602
Epoch 44/100
400/400 - 98s - loss: 0.1122 - dice_multi: 0.8573
Epoch 45/100
400/400 - 99s - loss: 0.1101 - dice_multi: 0.8610
Epoch 46/100
400/400 - 99s - loss: 0.1093 - dice_multi: 0.8563
Epoch 47/100
400/400 - 99s - loss: 0.1097 - dice_multi: 0.8542
Epoch 48/100
400/400 - 99s - loss: 0.1097 - dice_multi: 0.8652
Epoch 49/100
400/400 - 99s - loss: 0.1093 - dice_multi: 0.8680
Epoch 50/100
400/400 - 99s - loss: 0.1181 - dice_multi: 0.8494
Epoch 51/100
400/400 - 99s - loss: 0.1092 - dice_multi: 0.8638
Epoch 52/100
400/400 - 99s - loss: 0.1035 - dice_multi: 0.8615
Epoch 53/100
400/400 - 98s - loss: 0.1147 - dice_multi: 0.8511
Epoch 54/100
400/400 - 99s - loss: 0.1030 - dice_multi: 0.8616
Epoch 55/100
400/400 - 99s - loss: 0.1028 - dice_multi: 0.8689
Epoch 56/100
400/400 - 98s - loss: 0.1360 - dice_multi: 0.8398
Epoch 57/100
400/400 - 99s - loss: 0.1067 - dice_multi: 0.8617
Epoch 58/100
400/400 - 99s - loss: 0.1025 - dice_multi: 0.8618
Epoch 59/100
400/400 - 99s - loss: 0.1014 - dice_multi: 0.8718
Epoch 60/100
400/400 - 99s - loss: 0.1032 - dice_multi: 0.8652
Epoch 61/100
400/400 - 98s - loss: 0.1011 - dice_multi: 0.8659
Epoch 62/100
400/400 - 99s - loss: 0.0985 - dice_multi: 0.8692
Epoch 63/100
400/400 - 99s - loss: 0.1009 - dice_multi: 0.8750
Epoch 64/100
400/400 - 99s - loss: 0.0986 - dice_multi: 0.8715
Epoch 65/100
400/400 - 99s - loss: 0.0980 - dice_multi: 0.8699
Epoch 66/100
400/400 - 99s - loss: 0.0996 - dice_multi: 0.8731
Epoch 67/100
400/400 - 99s - loss: 0.0985 - dice_multi: 0.8728
Epoch 68/100
400/400 - 99s - loss: 0.1028 - dice_multi: 0.8590
Epoch 69/100
400/400 - 99s - loss: 0.1009 - dice_multi: 0.8684
Epoch 70/100
400/400 - 99s - loss: 0.0981 - dice_multi: 0.8758
Epoch 71/100
400/400 - 99s - loss: 0.0954 - dice_multi: 0.8748
Epoch 72/100
400/400 - 99s - loss: 0.0963 - dice_multi: 0.8742
Epoch 73/100
400/400 - 99s - loss: 0.0958 - dice_multi: 0.8738
Epoch 74/100
400/400 - 99s - loss: 0.0947 - dice_multi: 0.8761
Epoch 75/100
400/400 - 99s - loss: 0.0938 - dice_multi: 0.8739
Epoch 76/100
400/400 - 99s - loss: 0.1060 - dice_multi: 0.8565
Epoch 77/100
400/400 - 99s - loss: 0.1029 - dice_multi: 0.8623
Epoch 78/100
400/400 - 99s - loss: 0.0930 - dice_multi: 0.8713
Epoch 79/100
400/400 - 99s - loss: 0.0932 - dice_multi: 0.8789
Epoch 80/100
400/400 - 99s - loss: 0.0937 - dice_multi: 0.8783
Epoch 81/100
400/400 - 98s - loss: 0.0913 - dice_multi: 0.8714
Epoch 82/100
400/400 - 99s - loss: 0.0899 - dice_multi: 0.8748
Epoch 83/100
400/400 - 99s - loss: 0.0915 - dice_multi: 0.8757
Epoch 84/100
400/400 - 99s - loss: 0.0915 - dice_multi: 0.8756
Epoch 85/100
400/400 - 99s - loss: 0.0905 - dice_multi: 0.8760
Epoch 86/100
400/400 - 99s - loss: 0.0902 - dice_multi: 0.8782
Epoch 87/100
400/400 - 99s - loss: 0.0884 - dice_multi: 0.8773
Epoch 88/100
400/400 - 99s - loss: 0.0893 - dice_multi: 0.8779
Epoch 89/100
400/400 - 99s - loss: 0.0899 - dice_multi: 0.8775
Epoch 90/100
400/400 - 99s - loss: 0.0889 - dice_multi: 0.8767
Epoch 91/100
400/400 - 98s - loss: 0.0906 - dice_multi: 0.8803
Epoch 92/100
400/400 - 99s - loss: 0.0894 - dice_multi: 0.8742
Epoch 93/100
400/400 - 99s - loss: 0.0898 - dice_multi: 0.8778
Epoch 94/100
400/400 - 100s - loss: 0.0890 - dice_multi: 0.8803
Epoch 95/100
400/400 - 99s - loss: 0.0967 - dice_multi: 0.8777
Epoch 96/100
400/400 - 100s - loss: 0.0940 - dice_multi: 0.8800
Epoch 97/100
400/400 - 99s - loss: 0.0881 - dice_multi: 0.8831
Epoch 98/100
400/400 - 99s - loss: 0.0877 - dice_multi: 0.8852
Epoch 99/100
400/400 - 99s - loss: 0.0865 - dice_multi: 0.8831
Epoch 100/100
400/400 - 99s - loss: 0.0860 - dice_multi: 0.8875
training time: 9881.271566152573
executation time:23.1818200674924
[0.99291295 0.94663954 0.8243828  0.89792883 0.84215593 0.9059718
 0.9040416 ]
