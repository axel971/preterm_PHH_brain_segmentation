Loading tensorflow/2.5
  Loading requirement: cuda11.2/toolkit/11.2.2 cudnn8.1-cuda11.2/8.1.1.33
    hdf5_18/1.8.20
denseNet
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2021-09-21 17:03:33.939990: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(41, 256, 128, 256)
..loading data finished Tue Sep 21 17:04:01 2021
2021-09-21 17:04:01.863910: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-09-21 17:04:01.928106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-21 17:04:01.928151: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-21 17:04:01.967102: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-21 17:04:01.967218: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-09-21 17:04:01.980018: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-09-21 17:04:01.996401: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-09-21 17:04:01.999283: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-09-21 17:04:02.002755: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-09-21 17:04:02.004647: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-21 17:04:02.014000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-21 17:04:02.019682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-21 17:04:02.024135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-21 17:04:02.024174: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-21 17:04:02.543213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-21 17:04:02.543279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-09-21 17:04:02.543303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-09-21 17:04:02.549293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38184 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:3b:00.0, compute capability: 8.0)
---------fold--1---------
training set:  [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [0 1 2 3 4 5 6 7 8 9]
testing set size:  10
d1 shape is: [None, 32, 32, 32, 96]
t1 shape is: [None, 16, 16, 16, 48]
d2 shape is: [None, 16, 16, 16, 112]
t2 shape is: [None, 8, 8, 8, 56]
d3 shape is: [None, 8, 8, 8, 120]
t3 shape is: [None, 4, 4, 4, 60]
last layer shape is: [None, 64, 64, 64, 7]
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
..step_by_epoch:400
..self.current_epoch:0
2021-09-21 17:04:05.805098: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-09-21 17:04:05.805575: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2100000000 Hz
2021-09-21 17:04:11.003653: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-21 17:04:12.104303: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2021-09-21 17:04:13.188538: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-21 17:04:13.927265: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 101s - loss: 0.6599 - dice_multi: 0.3738
Epoch 2/100
400/400 - 82s - loss: 0.5462 - dice_multi: 0.4383
Epoch 3/100
400/400 - 83s - loss: 0.4755 - dice_multi: 0.4794
Epoch 4/100
400/400 - 88s - loss: 0.4477 - dice_multi: 0.5062
Epoch 5/100
400/400 - 88s - loss: 0.4060 - dice_multi: 0.5278
Epoch 6/100
400/400 - 88s - loss: 0.3964 - dice_multi: 0.5407
Epoch 7/100
400/400 - 85s - loss: 0.3775 - dice_multi: 0.5447
Epoch 8/100
400/400 - 84s - loss: 0.3527 - dice_multi: 0.5661
Epoch 9/100
400/400 - 83s - loss: 0.3413 - dice_multi: 0.5787
Epoch 10/100
400/400 - 84s - loss: 0.3323 - dice_multi: 0.5922
Epoch 11/100
400/400 - 85s - loss: 0.3058 - dice_multi: 0.5998
Epoch 12/100
400/400 - 90s - loss: 0.3172 - dice_multi: 0.6099
Epoch 13/100
400/400 - 88s - loss: 0.2972 - dice_multi: 0.6235
Epoch 14/100
400/400 - 89s - loss: 0.2952 - dice_multi: 0.6204
Epoch 15/100
400/400 - 90s - loss: 0.2929 - dice_multi: 0.6282
Epoch 16/100
400/400 - 89s - loss: 0.2830 - dice_multi: 0.6347
Epoch 17/100
400/400 - 87s - loss: 0.2724 - dice_multi: 0.6444
Epoch 18/100
400/400 - 86s - loss: 0.2819 - dice_multi: 0.6438
Epoch 19/100
400/400 - 86s - loss: 0.2718 - dice_multi: 0.6487
Epoch 20/100
400/400 - 87s - loss: 0.2629 - dice_multi: 0.6578
Epoch 21/100
400/400 - 84s - loss: 0.2696 - dice_multi: 0.6567
Epoch 22/100
400/400 - 86s - loss: 0.2667 - dice_multi: 0.6570
Epoch 23/100
400/400 - 84s - loss: 0.2668 - dice_multi: 0.6594
Epoch 24/100
400/400 - 84s - loss: 0.2609 - dice_multi: 0.6651
Epoch 25/100
400/400 - 87s - loss: 0.2499 - dice_multi: 0.6735
Epoch 26/100
400/400 - 87s - loss: 0.2527 - dice_multi: 0.6694
Epoch 27/100
400/400 - 85s - loss: 0.2492 - dice_multi: 0.6708
Epoch 28/100
400/400 - 85s - loss: 0.2457 - dice_multi: 0.6792
Epoch 29/100
400/400 - 87s - loss: 0.2399 - dice_multi: 0.6830
Epoch 30/100
400/400 - 87s - loss: 0.2415 - dice_multi: 0.6780
Epoch 31/100
400/400 - 87s - loss: 0.2325 - dice_multi: 0.6892
Epoch 32/100
400/400 - 84s - loss: 0.2404 - dice_multi: 0.6870
Epoch 33/100
400/400 - 87s - loss: 0.2391 - dice_multi: 0.6879
Epoch 34/100
400/400 - 88s - loss: 0.2394 - dice_multi: 0.6926
Epoch 35/100
400/400 - 85s - loss: 0.2268 - dice_multi: 0.6964
Epoch 36/100
400/400 - 87s - loss: 0.2387 - dice_multi: 0.7002
Epoch 37/100
400/400 - 87s - loss: 0.2270 - dice_multi: 0.7031
Epoch 38/100
400/400 - 88s - loss: 0.2154 - dice_multi: 0.7032
Epoch 39/100
400/400 - 90s - loss: 0.2240 - dice_multi: 0.7081
Epoch 40/100
400/400 - 88s - loss: 0.2188 - dice_multi: 0.7088
Epoch 41/100
400/400 - 87s - loss: 0.2192 - dice_multi: 0.7008
Epoch 42/100
400/400 - 88s - loss: 0.2265 - dice_multi: 0.7026
Epoch 43/100
400/400 - 90s - loss: 0.2193 - dice_multi: 0.7094
Epoch 44/100
400/400 - 86s - loss: 0.2164 - dice_multi: 0.7068
Epoch 45/100
400/400 - 86s - loss: 0.2130 - dice_multi: 0.7125
Epoch 46/100
400/400 - 86s - loss: 0.2129 - dice_multi: 0.7126
Epoch 47/100
400/400 - 85s - loss: 0.2244 - dice_multi: 0.7119
Epoch 48/100
400/400 - 83s - loss: 0.2140 - dice_multi: 0.7085
Epoch 49/100
400/400 - 82s - loss: 0.2162 - dice_multi: 0.7114
Epoch 50/100
400/400 - 82s - loss: 0.2085 - dice_multi: 0.7174
Epoch 51/100
400/400 - 84s - loss: 0.2113 - dice_multi: 0.7169
Epoch 52/100
400/400 - 81s - loss: 0.2095 - dice_multi: 0.7217
Epoch 53/100
400/400 - 83s - loss: 0.2095 - dice_multi: 0.7296
Epoch 54/100
400/400 - 85s - loss: 0.2091 - dice_multi: 0.7302
Epoch 55/100
400/400 - 82s - loss: 0.2053 - dice_multi: 0.7313
Epoch 56/100
400/400 - 87s - loss: 0.2071 - dice_multi: 0.7206
Epoch 57/100
400/400 - 86s - loss: 0.2094 - dice_multi: 0.7248
Epoch 58/100
400/400 - 86s - loss: 0.2060 - dice_multi: 0.7276
Epoch 59/100
400/400 - 85s - loss: 0.2063 - dice_multi: 0.7311
Epoch 60/100
400/400 - 88s - loss: 0.1933 - dice_multi: 0.7388
Epoch 61/100
400/400 - 89s - loss: 0.2043 - dice_multi: 0.7262
Epoch 62/100
400/400 - 87s - loss: 0.1966 - dice_multi: 0.7434
Epoch 63/100
400/400 - 91s - loss: 0.2052 - dice_multi: 0.7295
Epoch 64/100
400/400 - 90s - loss: 0.2066 - dice_multi: 0.7346
Epoch 65/100
400/400 - 91s - loss: 0.1956 - dice_multi: 0.7461
Epoch 66/100
400/400 - 93s - loss: 0.1956 - dice_multi: 0.7426
Epoch 67/100
400/400 - 92s - loss: 0.2006 - dice_multi: 0.7395
Epoch 68/100
400/400 - 90s - loss: 0.2099 - dice_multi: 0.7261
Epoch 69/100
400/400 - 89s - loss: 0.1950 - dice_multi: 0.7392
Epoch 70/100
400/400 - 90s - loss: 0.1890 - dice_multi: 0.7474
Epoch 71/100
400/400 - 91s - loss: 0.1950 - dice_multi: 0.7361
Epoch 72/100
400/400 - 89s - loss: 0.2005 - dice_multi: 0.7324
Epoch 73/100
400/400 - 93s - loss: 0.1943 - dice_multi: 0.7469
Epoch 74/100
400/400 - 90s - loss: 0.1942 - dice_multi: 0.7487
Epoch 75/100
400/400 - 93s - loss: 0.1948 - dice_multi: 0.7369
Epoch 76/100
400/400 - 91s - loss: 0.1925 - dice_multi: 0.7437
Epoch 77/100
400/400 - 91s - loss: 0.1974 - dice_multi: 0.7425
Epoch 78/100
400/400 - 93s - loss: 0.1900 - dice_multi: 0.7444
Epoch 79/100
400/400 - 93s - loss: 0.1901 - dice_multi: 0.7399
Epoch 80/100
400/400 - 91s - loss: 0.1920 - dice_multi: 0.7443
Epoch 81/100
400/400 - 95s - loss: 0.1882 - dice_multi: 0.7508
Epoch 82/100
400/400 - 92s - loss: 0.1897 - dice_multi: 0.7488
Epoch 83/100
400/400 - 94s - loss: 0.1919 - dice_multi: 0.7405
Epoch 84/100
400/400 - 94s - loss: 0.1891 - dice_multi: 0.7495
Epoch 85/100
400/400 - 93s - loss: 0.1851 - dice_multi: 0.7459
Epoch 86/100
400/400 - 93s - loss: 0.1887 - dice_multi: 0.7502
Epoch 87/100
400/400 - 93s - loss: 0.1842 - dice_multi: 0.7531
Epoch 88/100
400/400 - 94s - loss: 0.1890 - dice_multi: 0.7488
Epoch 89/100
400/400 - 93s - loss: 0.1926 - dice_multi: 0.7473
Epoch 90/100
400/400 - 95s - loss: 0.1926 - dice_multi: 0.7443
Epoch 91/100
400/400 - 92s - loss: 0.1900 - dice_multi: 0.7482
Epoch 92/100
400/400 - 93s - loss: 0.1822 - dice_multi: 0.7526
Epoch 93/100
400/400 - 92s - loss: 0.1889 - dice_multi: 0.7550
Epoch 94/100
400/400 - 93s - loss: 0.1847 - dice_multi: 0.7516
Epoch 95/100
400/400 - 94s - loss: 0.1898 - dice_multi: 0.7530
Epoch 96/100
400/400 - 92s - loss: 0.1807 - dice_multi: 0.7565
Epoch 97/100
400/400 - 94s - loss: 0.1919 - dice_multi: 0.7550
Epoch 98/100
400/400 - 94s - loss: 0.1877 - dice_multi: 0.7571
Epoch 99/100
400/400 - 93s - loss: 0.1820 - dice_multi: 0.7576
Epoch 100/100
400/400 - 92s - loss: 0.1837 - dice_multi: 0.7522
2021-09-21 19:31:51.088092: I tensorflow/stream_executor/cuda/cuda_blas.cc:1839] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
taining time:8863.236164808273
execution time:20.765117263793947
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [10 11 12 13 14 15 16 17 18 19]
testing set size:  10
d1 shape is: [None, 32, 32, 32, 96]
t1 shape is: [None, 16, 16, 16, 48]
d2 shape is: [None, 16, 16, 16, 112]
t2 shape is: [None, 8, 8, 8, 56]
d3 shape is: [None, 8, 8, 8, 120]
t3 shape is: [None, 4, 4, 4, 60]
last layer shape is: [None, 64, 64, 64, 7]
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
..step_by_epoch:400
..self.current_epoch:0
Epoch 1/100
400/400 - 98s - loss: 0.6694 - dice_multi: 0.3594
Epoch 2/100
400/400 - 93s - loss: 0.5574 - dice_multi: 0.4151
Epoch 3/100
400/400 - 93s - loss: 0.4935 - dice_multi: 0.4564
Epoch 4/100
400/400 - 92s - loss: 0.4382 - dice_multi: 0.4872
Epoch 5/100
400/400 - 95s - loss: 0.4186 - dice_multi: 0.5039
Epoch 6/100
400/400 - 92s - loss: 0.4002 - dice_multi: 0.5154
Epoch 7/100
400/400 - 92s - loss: 0.3989 - dice_multi: 0.5284
Epoch 8/100
400/400 - 93s - loss: 0.3659 - dice_multi: 0.5453
Epoch 9/100
400/400 - 93s - loss: 0.3512 - dice_multi: 0.5594
Epoch 10/100
400/400 - 94s - loss: 0.3452 - dice_multi: 0.5652
Epoch 11/100
400/400 - 94s - loss: 0.3462 - dice_multi: 0.5780
Epoch 12/100
400/400 - 95s - loss: 0.3263 - dice_multi: 0.5805
Epoch 13/100
400/400 - 93s - loss: 0.3253 - dice_multi: 0.5836
Epoch 14/100
400/400 - 94s - loss: 0.3165 - dice_multi: 0.6015
Epoch 15/100
400/400 - 93s - loss: 0.3231 - dice_multi: 0.6021
Epoch 16/100
400/400 - 95s - loss: 0.3100 - dice_multi: 0.6064
Epoch 17/100
400/400 - 94s - loss: 0.3068 - dice_multi: 0.6056
Epoch 18/100
400/400 - 92s - loss: 0.2979 - dice_multi: 0.6106
Epoch 19/100
400/400 - 93s - loss: 0.2892 - dice_multi: 0.6169
Epoch 20/100
400/400 - 93s - loss: 0.2867 - dice_multi: 0.6250
Epoch 21/100
400/400 - 95s - loss: 0.2830 - dice_multi: 0.6295
Epoch 22/100
400/400 - 94s - loss: 0.2825 - dice_multi: 0.6361
Epoch 23/100
400/400 - 94s - loss: 0.2756 - dice_multi: 0.6363
Epoch 24/100
400/400 - 93s - loss: 0.2866 - dice_multi: 0.6300
Epoch 25/100
400/400 - 93s - loss: 0.2636 - dice_multi: 0.6424
Epoch 26/100
400/400 - 93s - loss: 0.2809 - dice_multi: 0.6461
Epoch 27/100
400/400 - 96s - loss: 0.2787 - dice_multi: 0.6448
Epoch 28/100
400/400 - 95s - loss: 0.2570 - dice_multi: 0.6506
Epoch 29/100
400/400 - 92s - loss: 0.2586 - dice_multi: 0.6543
Epoch 30/100
400/400 - 92s - loss: 0.2574 - dice_multi: 0.6570
Epoch 31/100
400/400 - 93s - loss: 0.2597 - dice_multi: 0.6584
Epoch 32/100
400/400 - 93s - loss: 0.2508 - dice_multi: 0.6567
Epoch 33/100
400/400 - 95s - loss: 0.2536 - dice_multi: 0.6639
Epoch 34/100
400/400 - 93s - loss: 0.2453 - dice_multi: 0.6636
Epoch 35/100
400/400 - 92s - loss: 0.2471 - dice_multi: 0.6650
Epoch 36/100
400/400 - 94s - loss: 0.2556 - dice_multi: 0.6660
Epoch 37/100
400/400 - 92s - loss: 0.2453 - dice_multi: 0.6733
Epoch 38/100
400/400 - 92s - loss: 0.2460 - dice_multi: 0.6685
Epoch 39/100
400/400 - 92s - loss: 0.2349 - dice_multi: 0.6701
Epoch 40/100
400/400 - 94s - loss: 0.2421 - dice_multi: 0.6844
Epoch 41/100
400/400 - 93s - loss: 0.2423 - dice_multi: 0.6770
Epoch 42/100
400/400 - 92s - loss: 0.2482 - dice_multi: 0.6736
Epoch 43/100
400/400 - 93s - loss: 0.2416 - dice_multi: 0.6782
Epoch 44/100
400/400 - 92s - loss: 0.2345 - dice_multi: 0.6786
Epoch 45/100
400/400 - 93s - loss: 0.2326 - dice_multi: 0.6873
Epoch 46/100
400/400 - 93s - loss: 0.2375 - dice_multi: 0.6824
Epoch 47/100
400/400 - 94s - loss: 0.2389 - dice_multi: 0.6890
Epoch 48/100
400/400 - 93s - loss: 0.2363 - dice_multi: 0.6868
Epoch 49/100
400/400 - 94s - loss: 0.2292 - dice_multi: 0.6902
Epoch 50/100
400/400 - 93s - loss: 0.2222 - dice_multi: 0.6867
Epoch 51/100
400/400 - 93s - loss: 0.2325 - dice_multi: 0.6901
Epoch 52/100
400/400 - 93s - loss: 0.2285 - dice_multi: 0.6927
Epoch 53/100
400/400 - 93s - loss: 0.2297 - dice_multi: 0.6896
Epoch 54/100
400/400 - 94s - loss: 0.2233 - dice_multi: 0.6958
Epoch 55/100
400/400 - 93s - loss: 0.2210 - dice_multi: 0.6980
Epoch 56/100
400/400 - 93s - loss: 0.2243 - dice_multi: 0.7002
Epoch 57/100
400/400 - 94s - loss: 0.2277 - dice_multi: 0.7014
Epoch 58/100
400/400 - 92s - loss: 0.2223 - dice_multi: 0.6996
Epoch 59/100
400/400 - 93s - loss: 0.2269 - dice_multi: 0.7006
Epoch 60/100
400/400 - 94s - loss: 0.2188 - dice_multi: 0.7027
Epoch 61/100
400/400 - 94s - loss: 0.2181 - dice_multi: 0.7014
Epoch 62/100
400/400 - 94s - loss: 0.2213 - dice_multi: 0.7023
Epoch 63/100
400/400 - 93s - loss: 0.2171 - dice_multi: 0.7045
Epoch 64/100
400/400 - 93s - loss: 0.2142 - dice_multi: 0.6976
Epoch 65/100
400/400 - 92s - loss: 0.2174 - dice_multi: 0.7047
Epoch 66/100
400/400 - 92s - loss: 0.2134 - dice_multi: 0.7024
Epoch 67/100
400/400 - 92s - loss: 0.2197 - dice_multi: 0.7060
Epoch 68/100
400/400 - 93s - loss: 0.2080 - dice_multi: 0.7099
Epoch 69/100
400/400 - 91s - loss: 0.2126 - dice_multi: 0.7141
Epoch 70/100
400/400 - 92s - loss: 0.2073 - dice_multi: 0.7165
Epoch 71/100
400/400 - 93s - loss: 0.2119 - dice_multi: 0.7064
Epoch 72/100
400/400 - 93s - loss: 0.2128 - dice_multi: 0.7203
Epoch 73/100
400/400 - 90s - loss: 0.2151 - dice_multi: 0.7175
Epoch 74/100
400/400 - 92s - loss: 0.2114 - dice_multi: 0.7123
Epoch 75/100
400/400 - 93s - loss: 0.2056 - dice_multi: 0.7215
Epoch 76/100
400/400 - 93s - loss: 0.2068 - dice_multi: 0.7192
Epoch 77/100
400/400 - 95s - loss: 0.2056 - dice_multi: 0.7145
Epoch 78/100
400/400 - 93s - loss: 0.2169 - dice_multi: 0.7078
Epoch 79/100
400/400 - 93s - loss: 0.2039 - dice_multi: 0.7137
Epoch 80/100
400/400 - 93s - loss: 0.2019 - dice_multi: 0.7217
Epoch 81/100
400/400 - 94s - loss: 0.2042 - dice_multi: 0.7164
Epoch 82/100
400/400 - 94s - loss: 0.2124 - dice_multi: 0.7222
Epoch 83/100
400/400 - 93s - loss: 0.2071 - dice_multi: 0.7231
Epoch 84/100
400/400 - 92s - loss: 0.2085 - dice_multi: 0.7214
Epoch 85/100
400/400 - 94s - loss: 0.2047 - dice_multi: 0.7120
Epoch 86/100
400/400 - 93s - loss: 0.2055 - dice_multi: 0.7192
Epoch 87/100
400/400 - 93s - loss: 0.2099 - dice_multi: 0.7213
Epoch 88/100
400/400 - 92s - loss: 0.2023 - dice_multi: 0.7216
Epoch 89/100
400/400 - 93s - loss: 0.2078 - dice_multi: 0.7221
Epoch 90/100
400/400 - 92s - loss: 0.2044 - dice_multi: 0.7212
Epoch 91/100
400/400 - 92s - loss: 0.2005 - dice_multi: 0.7287
Epoch 92/100
400/400 - 95s - loss: 0.1945 - dice_multi: 0.7250
Epoch 93/100
400/400 - 93s - loss: 0.2006 - dice_multi: 0.7264
Epoch 94/100
400/400 - 94s - loss: 0.1972 - dice_multi: 0.7228
Epoch 95/100
400/400 - 93s - loss: 0.1994 - dice_multi: 0.7226
Epoch 96/100
400/400 - 94s - loss: 0.1970 - dice_multi: 0.7283
Epoch 97/100
400/400 - 94s - loss: 0.1938 - dice_multi: 0.7290
Epoch 98/100
400/400 - 93s - loss: 0.2035 - dice_multi: 0.7195
Epoch 99/100
400/400 - 94s - loss: 0.1921 - dice_multi: 0.7239
Epoch 100/100
400/400 - 93s - loss: 0.2031 - dice_multi: 0.7285
taining time:9325.823811292648
execution time:20.659081172943115
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [20 21 22 23 24 25 26 27 28 29]
testing set size:  10
d1 shape is: [None, 32, 32, 32, 96]
t1 shape is: [None, 16, 16, 16, 48]
d2 shape is: [None, 16, 16, 16, 112]
t2 shape is: [None, 8, 8, 8, 56]
d3 shape is: [None, 8, 8, 8, 120]
t3 shape is: [None, 4, 4, 4, 60]
last layer shape is: [None, 64, 64, 64, 7]
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
..step_by_epoch:400
..self.current_epoch:0
Epoch 1/100
400/400 - 98s - loss: 0.6350 - dice_multi: 0.3428
Epoch 2/100
400/400 - 94s - loss: 0.5487 - dice_multi: 0.4062
Epoch 3/100
400/400 - 94s - loss: 0.4806 - dice_multi: 0.4406
Epoch 4/100
400/400 - 94s - loss: 0.4570 - dice_multi: 0.4626
Epoch 5/100
400/400 - 93s - loss: 0.4171 - dice_multi: 0.4885
Epoch 6/100
400/400 - 93s - loss: 0.4064 - dice_multi: 0.5038
Epoch 7/100
400/400 - 93s - loss: 0.3794 - dice_multi: 0.5131
Epoch 8/100
400/400 - 94s - loss: 0.3780 - dice_multi: 0.5213
Epoch 9/100
400/400 - 93s - loss: 0.3651 - dice_multi: 0.5344
Epoch 10/100
400/400 - 92s - loss: 0.3486 - dice_multi: 0.5501
Epoch 11/100
400/400 - 94s - loss: 0.3371 - dice_multi: 0.5506
Epoch 12/100
400/400 - 94s - loss: 0.3424 - dice_multi: 0.5574
Epoch 13/100
400/400 - 93s - loss: 0.3206 - dice_multi: 0.5662
Epoch 14/100
400/400 - 95s - loss: 0.3186 - dice_multi: 0.5739
Epoch 15/100
400/400 - 93s - loss: 0.3136 - dice_multi: 0.5788
Epoch 16/100
400/400 - 95s - loss: 0.3139 - dice_multi: 0.5918
Epoch 17/100
400/400 - 93s - loss: 0.2864 - dice_multi: 0.6021
Epoch 18/100
400/400 - 94s - loss: 0.2886 - dice_multi: 0.6042
Epoch 19/100
400/400 - 95s - loss: 0.2829 - dice_multi: 0.6097
Epoch 20/100
400/400 - 95s - loss: 0.2842 - dice_multi: 0.6081
Epoch 21/100
400/400 - 94s - loss: 0.2905 - dice_multi: 0.6127
Epoch 22/100
400/400 - 93s - loss: 0.2847 - dice_multi: 0.6217
Epoch 23/100
400/400 - 93s - loss: 0.2816 - dice_multi: 0.6195
Epoch 24/100
400/400 - 94s - loss: 0.2866 - dice_multi: 0.6268
Epoch 25/100
400/400 - 94s - loss: 0.2751 - dice_multi: 0.6206
Epoch 26/100
400/400 - 94s - loss: 0.2742 - dice_multi: 0.6255
Epoch 27/100
400/400 - 94s - loss: 0.2668 - dice_multi: 0.6314
Epoch 28/100
400/400 - 93s - loss: 0.2636 - dice_multi: 0.6334
Epoch 29/100
400/400 - 94s - loss: 0.2578 - dice_multi: 0.6398
Epoch 30/100
400/400 - 93s - loss: 0.2568 - dice_multi: 0.6391
Epoch 31/100
400/400 - 95s - loss: 0.2484 - dice_multi: 0.6422
Epoch 32/100
400/400 - 94s - loss: 0.2618 - dice_multi: 0.6466
Epoch 33/100
400/400 - 95s - loss: 0.2468 - dice_multi: 0.6416
Epoch 34/100
400/400 - 94s - loss: 0.2449 - dice_multi: 0.6594
Epoch 35/100
400/400 - 93s - loss: 0.2394 - dice_multi: 0.6563
Epoch 36/100
400/400 - 94s - loss: 0.2475 - dice_multi: 0.6549
Epoch 37/100
400/400 - 93s - loss: 0.2505 - dice_multi: 0.6506
Epoch 38/100
400/400 - 94s - loss: 0.2466 - dice_multi: 0.6571
Epoch 39/100
400/400 - 93s - loss: 0.2412 - dice_multi: 0.6674
Epoch 40/100
400/400 - 92s - loss: 0.2416 - dice_multi: 0.6642
Epoch 41/100
400/400 - 94s - loss: 0.2438 - dice_multi: 0.6669
Epoch 42/100
400/400 - 93s - loss: 0.2400 - dice_multi: 0.6644
Epoch 43/100
400/400 - 93s - loss: 0.2422 - dice_multi: 0.6637
Epoch 44/100
400/400 - 95s - loss: 0.2328 - dice_multi: 0.6661
Epoch 45/100
400/400 - 94s - loss: 0.2404 - dice_multi: 0.6748
Epoch 46/100
400/400 - 94s - loss: 0.2370 - dice_multi: 0.6748
Epoch 47/100
400/400 - 92s - loss: 0.2319 - dice_multi: 0.6762
Epoch 48/100
400/400 - 95s - loss: 0.2232 - dice_multi: 0.6863
Epoch 49/100
400/400 - 95s - loss: 0.2335 - dice_multi: 0.6826
Epoch 50/100
400/400 - 95s - loss: 0.2309 - dice_multi: 0.6782
Epoch 51/100
400/400 - 94s - loss: 0.2327 - dice_multi: 0.6773
Epoch 52/100
400/400 - 95s - loss: 0.2290 - dice_multi: 0.6765
Epoch 53/100
400/400 - 94s - loss: 0.2247 - dice_multi: 0.6869
Epoch 54/100
400/400 - 93s - loss: 0.2272 - dice_multi: 0.6770
Epoch 55/100
400/400 - 96s - loss: 0.2233 - dice_multi: 0.6866
Epoch 56/100
400/400 - 92s - loss: 0.2187 - dice_multi: 0.6917
Epoch 57/100
400/400 - 93s - loss: 0.2171 - dice_multi: 0.6910
Epoch 58/100
400/400 - 94s - loss: 0.2256 - dice_multi: 0.6873
Epoch 59/100
400/400 - 93s - loss: 0.2215 - dice_multi: 0.6875
Epoch 60/100
400/400 - 93s - loss: 0.2259 - dice_multi: 0.6930
Epoch 61/100
400/400 - 95s - loss: 0.2118 - dice_multi: 0.6932
Epoch 62/100
400/400 - 94s - loss: 0.2147 - dice_multi: 0.6951
Epoch 63/100
400/400 - 94s - loss: 0.2255 - dice_multi: 0.6888
Epoch 64/100
400/400 - 93s - loss: 0.2187 - dice_multi: 0.6942
Epoch 65/100
400/400 - 94s - loss: 0.2158 - dice_multi: 0.6956
Epoch 66/100
400/400 - 93s - loss: 0.2088 - dice_multi: 0.6960
Epoch 67/100
400/400 - 94s - loss: 0.2178 - dice_multi: 0.6963
Epoch 68/100
400/400 - 94s - loss: 0.2104 - dice_multi: 0.7044
Epoch 69/100
400/400 - 93s - loss: 0.2105 - dice_multi: 0.7003
Epoch 70/100
400/400 - 92s - loss: 0.2171 - dice_multi: 0.6951
Epoch 71/100
400/400 - 94s - loss: 0.2160 - dice_multi: 0.6977
Epoch 72/100
400/400 - 92s - loss: 0.2152 - dice_multi: 0.7048
Epoch 73/100
400/400 - 93s - loss: 0.2008 - dice_multi: 0.7058
Epoch 74/100
400/400 - 94s - loss: 0.2049 - dice_multi: 0.7072
Epoch 75/100
400/400 - 93s - loss: 0.2063 - dice_multi: 0.6996
Epoch 76/100
400/400 - 93s - loss: 0.2137 - dice_multi: 0.7060
Epoch 77/100
400/400 - 92s - loss: 0.2072 - dice_multi: 0.7052
Epoch 78/100
400/400 - 91s - loss: 0.2041 - dice_multi: 0.7025
Epoch 79/100
400/400 - 93s - loss: 0.2059 - dice_multi: 0.7056
Epoch 80/100
400/400 - 93s - loss: 0.2102 - dice_multi: 0.7029
Epoch 81/100
400/400 - 95s - loss: 0.2074 - dice_multi: 0.7082
Epoch 82/100
400/400 - 94s - loss: 0.2019 - dice_multi: 0.7102
Epoch 83/100
400/400 - 92s - loss: 0.2086 - dice_multi: 0.7097
Epoch 84/100
400/400 - 92s - loss: 0.2049 - dice_multi: 0.7036
Epoch 85/100
400/400 - 93s - loss: 0.2046 - dice_multi: 0.7094
Epoch 86/100
400/400 - 92s - loss: 0.2004 - dice_multi: 0.7145
Epoch 87/100
400/400 - 95s - loss: 0.2009 - dice_multi: 0.7109
Epoch 88/100
400/400 - 93s - loss: 0.2019 - dice_multi: 0.7152
Epoch 89/100
400/400 - 92s - loss: 0.2042 - dice_multi: 0.7187
Epoch 90/100
400/400 - 94s - loss: 0.2023 - dice_multi: 0.7126
Epoch 91/100
400/400 - 93s - loss: 0.2009 - dice_multi: 0.7080
Epoch 92/100
400/400 - 94s - loss: 0.2032 - dice_multi: 0.7136
Epoch 93/100
400/400 - 91s - loss: 0.1999 - dice_multi: 0.7205
Epoch 94/100
400/400 - 95s - loss: 0.1995 - dice_multi: 0.7154
Epoch 95/100
400/400 - 94s - loss: 0.1966 - dice_multi: 0.7200
Epoch 96/100
400/400 - 94s - loss: 0.2002 - dice_multi: 0.7162
Epoch 97/100
400/400 - 94s - loss: 0.2068 - dice_multi: 0.7195
Epoch 98/100
400/400 - 92s - loss: 0.1985 - dice_multi: 0.7143
Epoch 99/100
400/400 - 94s - loss: 0.1951 - dice_multi: 0.7196
Epoch 100/100
400/400 - 94s - loss: 0.2016 - dice_multi: 0.7192
taining time:9368.049668312073
execution time:20.44397394657135
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]
training set size:  30
testing set:  [30 31 32 33 34 35 36 37 38 39 40]
testing set size:  11
d1 shape is: [None, 32, 32, 32, 96]
t1 shape is: [None, 16, 16, 16, 48]
d2 shape is: [None, 16, 16, 16, 112]
t2 shape is: [None, 8, 8, 8, 56]
d3 shape is: [None, 8, 8, 8, 120]
t3 shape is: [None, 4, 4, 4, 60]
last layer shape is: [None, 64, 64, 64, 7]
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
..step_by_epoch:400
..self.current_epoch:0
Epoch 1/100
400/400 - 96s - loss: 0.6805 - dice_multi: 0.3861
Epoch 2/100
400/400 - 92s - loss: 0.5529 - dice_multi: 0.4578
Epoch 3/100
400/400 - 94s - loss: 0.4961 - dice_multi: 0.4812
Epoch 4/100
400/400 - 93s - loss: 0.4610 - dice_multi: 0.5123
Epoch 5/100
400/400 - 94s - loss: 0.4259 - dice_multi: 0.5379
Epoch 6/100
400/400 - 93s - loss: 0.4208 - dice_multi: 0.5501
Epoch 7/100
400/400 - 93s - loss: 0.3937 - dice_multi: 0.5583
Epoch 8/100
400/400 - 93s - loss: 0.3896 - dice_multi: 0.5815
Epoch 9/100
400/400 - 95s - loss: 0.3644 - dice_multi: 0.5836
Epoch 10/100
400/400 - 93s - loss: 0.3501 - dice_multi: 0.5998
Epoch 11/100
400/400 - 93s - loss: 0.3467 - dice_multi: 0.6050
Epoch 12/100
400/400 - 96s - loss: 0.3353 - dice_multi: 0.6128
Epoch 13/100
400/400 - 94s - loss: 0.3324 - dice_multi: 0.6189
Epoch 14/100
400/400 - 94s - loss: 0.3388 - dice_multi: 0.6219
Epoch 15/100
400/400 - 94s - loss: 0.3204 - dice_multi: 0.6345
Epoch 16/100
400/400 - 96s - loss: 0.3177 - dice_multi: 0.6310
Epoch 17/100
400/400 - 93s - loss: 0.3165 - dice_multi: 0.6269
Epoch 18/100
400/400 - 93s - loss: 0.3089 - dice_multi: 0.6457
Epoch 19/100
400/400 - 92s - loss: 0.3166 - dice_multi: 0.6489
Epoch 20/100
400/400 - 94s - loss: 0.2923 - dice_multi: 0.6495
Epoch 21/100
400/400 - 91s - loss: 0.2905 - dice_multi: 0.6561
Epoch 22/100
400/400 - 93s - loss: 0.2885 - dice_multi: 0.6493
Epoch 23/100
400/400 - 94s - loss: 0.3009 - dice_multi: 0.6617
Epoch 24/100
400/400 - 95s - loss: 0.2883 - dice_multi: 0.6630
Epoch 25/100
400/400 - 95s - loss: 0.2838 - dice_multi: 0.6670
Epoch 26/100
400/400 - 93s - loss: 0.2798 - dice_multi: 0.6660
Epoch 27/100
400/400 - 94s - loss: 0.2744 - dice_multi: 0.6746
Epoch 28/100
400/400 - 96s - loss: 0.2796 - dice_multi: 0.6774
Epoch 29/100
400/400 - 93s - loss: 0.2795 - dice_multi: 0.6758
Epoch 30/100
400/400 - 92s - loss: 0.2763 - dice_multi: 0.6723
Epoch 31/100
400/400 - 94s - loss: 0.2717 - dice_multi: 0.6833
Epoch 32/100
400/400 - 94s - loss: 0.2659 - dice_multi: 0.6921
Epoch 33/100
400/400 - 92s - loss: 0.2623 - dice_multi: 0.6828
Epoch 34/100
400/400 - 94s - loss: 0.2733 - dice_multi: 0.6895
Epoch 35/100
400/400 - 94s - loss: 0.2621 - dice_multi: 0.6896
Epoch 36/100
400/400 - 95s - loss: 0.2608 - dice_multi: 0.6904
Epoch 37/100
400/400 - 94s - loss: 0.2618 - dice_multi: 0.6915
Epoch 38/100
400/400 - 93s - loss: 0.2669 - dice_multi: 0.6923
Epoch 39/100
400/400 - 94s - loss: 0.2553 - dice_multi: 0.7033
Epoch 40/100
400/400 - 96s - loss: 0.2557 - dice_multi: 0.6923
Epoch 41/100
400/400 - 95s - loss: 0.2565 - dice_multi: 0.7042
Epoch 42/100
400/400 - 93s - loss: 0.2501 - dice_multi: 0.7049
Epoch 43/100
400/400 - 94s - loss: 0.2491 - dice_multi: 0.7011
Epoch 44/100
400/400 - 93s - loss: 0.2488 - dice_multi: 0.7060
Epoch 45/100
400/400 - 94s - loss: 0.2518 - dice_multi: 0.7058
Epoch 46/100
400/400 - 94s - loss: 0.2478 - dice_multi: 0.7044
Epoch 47/100
400/400 - 92s - loss: 0.2482 - dice_multi: 0.7055
Epoch 48/100
400/400 - 93s - loss: 0.2467 - dice_multi: 0.7043
Epoch 49/100
400/400 - 96s - loss: 0.2559 - dice_multi: 0.7065
Epoch 50/100
400/400 - 94s - loss: 0.2539 - dice_multi: 0.7075
Epoch 51/100
400/400 - 94s - loss: 0.2348 - dice_multi: 0.7131
Epoch 52/100
400/400 - 95s - loss: 0.2424 - dice_multi: 0.7071
Epoch 53/100
400/400 - 94s - loss: 0.2489 - dice_multi: 0.7032
Epoch 54/100
400/400 - 94s - loss: 0.2381 - dice_multi: 0.7104
Epoch 55/100
400/400 - 93s - loss: 0.2420 - dice_multi: 0.7136
Epoch 56/100
400/400 - 93s - loss: 0.2412 - dice_multi: 0.7165
Epoch 57/100
400/400 - 95s - loss: 0.2406 - dice_multi: 0.7070
Epoch 58/100
400/400 - 94s - loss: 0.2468 - dice_multi: 0.7214
Epoch 59/100
400/400 - 94s - loss: 0.2284 - dice_multi: 0.7192
Epoch 60/100
400/400 - 94s - loss: 0.2306 - dice_multi: 0.7251
Epoch 61/100
400/400 - 93s - loss: 0.2273 - dice_multi: 0.7281
Epoch 62/100
400/400 - 92s - loss: 0.2309 - dice_multi: 0.7239
Epoch 63/100
400/400 - 95s - loss: 0.2376 - dice_multi: 0.7100
Epoch 64/100
400/400 - 92s - loss: 0.2373 - dice_multi: 0.7189
Epoch 65/100
400/400 - 94s - loss: 0.2303 - dice_multi: 0.7280
Epoch 66/100
400/400 - 94s - loss: 0.2276 - dice_multi: 0.7304
Epoch 67/100
400/400 - 94s - loss: 0.2200 - dice_multi: 0.7287
Epoch 68/100
400/400 - 94s - loss: 0.2256 - dice_multi: 0.7253
Epoch 69/100
400/400 - 94s - loss: 0.2297 - dice_multi: 0.7352
Epoch 70/100
400/400 - 95s - loss: 0.2296 - dice_multi: 0.7282
Epoch 71/100
400/400 - 96s - loss: 0.2315 - dice_multi: 0.7254
Epoch 72/100
400/400 - 94s - loss: 0.2278 - dice_multi: 0.7267
Epoch 73/100
400/400 - 96s - loss: 0.2252 - dice_multi: 0.7290
Epoch 74/100
400/400 - 95s - loss: 0.2302 - dice_multi: 0.7331
Epoch 75/100
400/400 - 93s - loss: 0.2234 - dice_multi: 0.7229
Epoch 76/100
400/400 - 94s - loss: 0.2183 - dice_multi: 0.7335
Epoch 77/100
400/400 - 94s - loss: 0.2264 - dice_multi: 0.7365
Epoch 78/100
400/400 - 93s - loss: 0.2282 - dice_multi: 0.7314
Epoch 79/100
400/400 - 96s - loss: 0.2247 - dice_multi: 0.7373
Epoch 80/100
400/400 - 93s - loss: 0.2208 - dice_multi: 0.7273
Epoch 81/100
400/400 - 97s - loss: 0.2212 - dice_multi: 0.7276
Epoch 82/100
400/400 - 94s - loss: 0.2227 - dice_multi: 0.7339
Epoch 83/100
400/400 - 93s - loss: 0.2158 - dice_multi: 0.7325
Epoch 84/100
400/400 - 96s - loss: 0.2146 - dice_multi: 0.7383
Epoch 85/100
400/400 - 93s - loss: 0.2172 - dice_multi: 0.7397
Epoch 86/100
400/400 - 93s - loss: 0.2162 - dice_multi: 0.7427
Epoch 87/100
400/400 - 95s - loss: 0.2267 - dice_multi: 0.7344
Epoch 88/100
400/400 - 94s - loss: 0.2212 - dice_multi: 0.7258
Epoch 89/100
400/400 - 96s - loss: 0.2169 - dice_multi: 0.7411
Epoch 90/100
400/400 - 94s - loss: 0.2154 - dice_multi: 0.7410
Epoch 91/100
400/400 - 96s - loss: 0.2176 - dice_multi: 0.7337
Epoch 92/100
400/400 - 92s - loss: 0.2185 - dice_multi: 0.7416
Epoch 93/100
400/400 - 93s - loss: 0.2216 - dice_multi: 0.7348
Epoch 94/100
400/400 - 93s - loss: 0.2161 - dice_multi: 0.7421
Epoch 95/100
400/400 - 93s - loss: 0.2158 - dice_multi: 0.7472
Epoch 96/100
400/400 - 94s - loss: 0.2092 - dice_multi: 0.7367
Epoch 97/100
400/400 - 94s - loss: 0.2156 - dice_multi: 0.7375
Epoch 98/100
400/400 - 93s - loss: 0.2160 - dice_multi: 0.7444
Epoch 99/100
400/400 - 95s - loss: 0.2099 - dice_multi: 0.7404
Epoch 100/100
400/400 - 95s - loss: 0.2129 - dice_multi: 0.7422
taining time:9398.374792814255
execution time:20.743464253165506
[0.9858032  0.81428015 0.7319596  0.84750783 0.7500223  0.52702427
 0.61006767]
