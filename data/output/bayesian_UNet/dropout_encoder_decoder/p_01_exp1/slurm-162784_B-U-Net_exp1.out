Loading tensorflow/2.5
  Loading requirement: cuda11.2/toolkit/11.2.2 cudnn8.1-cuda11.2/8.1.1.33
    hdf5_18/1.8.20
run_bayesian_U-Net
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2021-09-17 21:00:20.170548: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(41, 256, 128, 256)
..loading data finished Fri Sep 17 21:00:46 2021
2021-09-17 21:00:46.552984: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-09-17 21:00:46.608052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-17 21:00:46.608094: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-17 21:00:46.615185: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-17 21:00:46.615263: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-09-17 21:00:46.617990: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-09-17 21:00:46.619274: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-09-17 21:00:46.621369: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-09-17 21:00:46.624391: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-09-17 21:00:46.625247: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-17 21:00:46.635666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-17 21:00:46.641801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-17 21:00:46.646051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-17 21:00:46.646090: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-17 21:00:47.130898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-17 21:00:47.130963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-09-17 21:00:47.130988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-09-17 21:00:47.136711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38184 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:3b:00.0, compute capability: 8.0)
---------fold--1---------
training set:  [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [0 1 2 3 4 5 6 7 8 9]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
2021-09-17 21:00:49.640886: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-09-17 21:00:49.641336: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2100000000 Hz
2021-09-17 21:00:52.006195: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-17 21:00:52.918004: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2021-09-17 21:00:53.843869: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-17 21:00:54.594155: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 128s - loss: 0.6816 - dice_multi: 0.3794
Epoch 2/100
400/400 - 97s - loss: 0.5304 - dice_multi: 0.4468
Epoch 3/100
400/400 - 98s - loss: 0.4461 - dice_multi: 0.5048
Epoch 4/100
400/400 - 98s - loss: 0.3884 - dice_multi: 0.5574
Epoch 5/100
400/400 - 98s - loss: 0.3354 - dice_multi: 0.6036
Epoch 6/100
400/400 - 98s - loss: 0.3013 - dice_multi: 0.6426
Epoch 7/100
400/400 - 98s - loss: 0.2587 - dice_multi: 0.6846
Epoch 8/100
400/400 - 98s - loss: 0.2441 - dice_multi: 0.7044
Epoch 9/100
400/400 - 98s - loss: 0.2118 - dice_multi: 0.7368
Epoch 10/100
400/400 - 98s - loss: 0.2093 - dice_multi: 0.7501
Epoch 11/100
400/400 - 98s - loss: 0.1813 - dice_multi: 0.7719
Epoch 12/100
400/400 - 98s - loss: 0.1748 - dice_multi: 0.7731
Epoch 13/100
400/400 - 98s - loss: 0.1680 - dice_multi: 0.7860
Epoch 14/100
400/400 - 98s - loss: 0.1529 - dice_multi: 0.7979
Epoch 15/100
400/400 - 98s - loss: 0.1526 - dice_multi: 0.8025
Epoch 16/100
400/400 - 98s - loss: 0.1640 - dice_multi: 0.7877
Epoch 17/100
400/400 - 98s - loss: 0.1499 - dice_multi: 0.8008
Epoch 18/100
400/400 - 98s - loss: 0.1336 - dice_multi: 0.8123
Epoch 19/100
400/400 - 98s - loss: 0.1381 - dice_multi: 0.8155
Epoch 20/100
400/400 - 98s - loss: 0.1326 - dice_multi: 0.8199
Epoch 21/100
400/400 - 98s - loss: 0.1281 - dice_multi: 0.8176
Epoch 22/100
400/400 - 98s - loss: 0.1671 - dice_multi: 0.7909
Epoch 23/100
400/400 - 98s - loss: 0.1324 - dice_multi: 0.8291
Epoch 24/100
400/400 - 98s - loss: 0.1221 - dice_multi: 0.8292
Epoch 25/100
400/400 - 98s - loss: 0.1169 - dice_multi: 0.8317
Epoch 26/100
400/400 - 98s - loss: 0.1243 - dice_multi: 0.8283
Epoch 27/100
400/400 - 98s - loss: 0.1198 - dice_multi: 0.8353
Epoch 28/100
400/400 - 98s - loss: 0.1139 - dice_multi: 0.8390
Epoch 29/100
400/400 - 98s - loss: 0.1306 - dice_multi: 0.8244
Epoch 30/100
400/400 - 98s - loss: 0.1169 - dice_multi: 0.8443
Epoch 31/100
400/400 - 98s - loss: 0.1397 - dice_multi: 0.8146
Epoch 32/100
400/400 - 98s - loss: 0.1153 - dice_multi: 0.8417
Epoch 33/100
400/400 - 98s - loss: 0.1136 - dice_multi: 0.8435
Epoch 34/100
400/400 - 98s - loss: 0.1105 - dice_multi: 0.8493
Epoch 35/100
400/400 - 98s - loss: 0.1169 - dice_multi: 0.8430
Epoch 36/100
400/400 - 98s - loss: 0.1060 - dice_multi: 0.8472
Epoch 37/100
400/400 - 98s - loss: 0.1081 - dice_multi: 0.8505
Epoch 38/100
400/400 - 98s - loss: 0.1075 - dice_multi: 0.8513
Epoch 39/100
400/400 - 98s - loss: 0.1064 - dice_multi: 0.8482
Epoch 40/100
400/400 - 98s - loss: 0.1138 - dice_multi: 0.8420
Epoch 41/100
400/400 - 98s - loss: 0.1050 - dice_multi: 0.8577
Epoch 42/100
400/400 - 98s - loss: 0.1080 - dice_multi: 0.8573
Epoch 43/100
400/400 - 98s - loss: 0.1135 - dice_multi: 0.8443
Epoch 44/100
400/400 - 98s - loss: 0.1097 - dice_multi: 0.8480
Epoch 45/100
400/400 - 98s - loss: 0.1039 - dice_multi: 0.8561
Epoch 46/100
400/400 - 98s - loss: 0.1028 - dice_multi: 0.8570
Epoch 47/100
400/400 - 98s - loss: 0.1002 - dice_multi: 0.8580
Epoch 48/100
400/400 - 98s - loss: 0.1048 - dice_multi: 0.8503
Epoch 49/100
400/400 - 98s - loss: 0.1019 - dice_multi: 0.8587
Epoch 50/100
400/400 - 98s - loss: 0.0994 - dice_multi: 0.8577
Epoch 51/100
400/400 - 98s - loss: 0.1009 - dice_multi: 0.8586
Epoch 52/100
400/400 - 98s - loss: 0.0968 - dice_multi: 0.8621
Epoch 53/100
400/400 - 98s - loss: 0.0972 - dice_multi: 0.8606
Epoch 54/100
400/400 - 98s - loss: 0.1118 - dice_multi: 0.8425
Epoch 55/100
400/400 - 98s - loss: 0.1000 - dice_multi: 0.8592
Epoch 56/100
400/400 - 98s - loss: 0.0949 - dice_multi: 0.8650
Epoch 57/100
400/400 - 98s - loss: 0.1013 - dice_multi: 0.8663
Epoch 58/100
400/400 - 97s - loss: 0.1009 - dice_multi: 0.8550
Epoch 59/100
400/400 - 98s - loss: 0.0963 - dice_multi: 0.8617
Epoch 60/100
400/400 - 97s - loss: 0.0933 - dice_multi: 0.8688
Epoch 61/100
400/400 - 98s - loss: 0.0941 - dice_multi: 0.8656
Epoch 62/100
400/400 - 98s - loss: 0.0951 - dice_multi: 0.8752
Epoch 63/100
400/400 - 98s - loss: 0.0963 - dice_multi: 0.8653
Epoch 64/100
400/400 - 98s - loss: 0.0946 - dice_multi: 0.8696
Epoch 65/100
400/400 - 97s - loss: 0.0956 - dice_multi: 0.8608
Epoch 66/100
400/400 - 98s - loss: 0.0900 - dice_multi: 0.8677
Epoch 67/100
400/400 - 98s - loss: 0.0889 - dice_multi: 0.8760
Epoch 68/100
400/400 - 98s - loss: 0.0936 - dice_multi: 0.8707
Epoch 69/100
400/400 - 98s - loss: 0.0914 - dice_multi: 0.8671
Epoch 70/100
400/400 - 98s - loss: 0.0904 - dice_multi: 0.8619
Epoch 71/100
400/400 - 98s - loss: 0.1119 - dice_multi: 0.8490
Epoch 72/100
400/400 - 98s - loss: 0.0907 - dice_multi: 0.8629
Epoch 73/100
400/400 - 98s - loss: 0.0883 - dice_multi: 0.8638
Epoch 74/100
400/400 - 98s - loss: 0.0873 - dice_multi: 0.8690
Epoch 75/100
400/400 - 98s - loss: 0.0919 - dice_multi: 0.8747
Epoch 76/100
400/400 - 98s - loss: 0.0885 - dice_multi: 0.8645
Epoch 77/100
400/400 - 98s - loss: 0.0880 - dice_multi: 0.8714
Epoch 78/100
400/400 - 98s - loss: 0.0894 - dice_multi: 0.8704
Epoch 79/100
400/400 - 98s - loss: 0.0861 - dice_multi: 0.8689
Epoch 80/100
400/400 - 99s - loss: 0.0867 - dice_multi: 0.8770
Epoch 81/100
400/400 - 98s - loss: 0.0888 - dice_multi: 0.8751
Epoch 82/100
400/400 - 97s - loss: 0.0879 - dice_multi: 0.8731
Epoch 83/100
400/400 - 98s - loss: 0.0889 - dice_multi: 0.8749
Epoch 84/100
400/400 - 98s - loss: 0.0861 - dice_multi: 0.8751
Epoch 85/100
400/400 - 98s - loss: 0.0862 - dice_multi: 0.8778
Epoch 86/100
400/400 - 98s - loss: 0.1061 - dice_multi: 0.8510
Epoch 87/100
400/400 - 98s - loss: 0.0901 - dice_multi: 0.8691
Epoch 88/100
400/400 - 98s - loss: 0.0877 - dice_multi: 0.8703
Epoch 89/100
400/400 - 98s - loss: 0.0850 - dice_multi: 0.8747
Epoch 90/100
400/400 - 98s - loss: 0.0845 - dice_multi: 0.8783
Epoch 91/100
400/400 - 98s - loss: 0.0865 - dice_multi: 0.8751
Epoch 92/100
400/400 - 98s - loss: 0.0833 - dice_multi: 0.8811
Epoch 93/100
400/400 - 98s - loss: 0.0862 - dice_multi: 0.8731
Epoch 94/100
400/400 - 98s - loss: 0.0842 - dice_multi: 0.8797
Epoch 95/100
400/400 - 98s - loss: 0.0987 - dice_multi: 0.8613
Epoch 96/100
400/400 - 98s - loss: 0.0875 - dice_multi: 0.8754
Epoch 97/100
400/400 - 98s - loss: 0.0855 - dice_multi: 0.8768
Epoch 98/100
400/400 - 98s - loss: 0.0844 - dice_multi: 0.8707
Epoch 99/100
400/400 - 97s - loss: 0.0827 - dice_multi: 0.8764
Epoch 100/100
400/400 - 97s - loss: 0.0824 - dice_multi: 0.8738
2021-09-17 23:44:33.470042: I tensorflow/stream_executor/cuda/cuda_blas.cc:1839] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
training time: 9819.162619113922
executation time:141.0001885652542
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [10 11 12 13 14 15 16 17 18 19]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 100s - loss: 0.6726 - dice_multi: 0.3661
Epoch 2/100
400/400 - 98s - loss: 0.5326 - dice_multi: 0.4345
Epoch 3/100
400/400 - 97s - loss: 0.4534 - dice_multi: 0.4899
Epoch 4/100
400/400 - 97s - loss: 0.4031 - dice_multi: 0.5351
Epoch 5/100
400/400 - 98s - loss: 0.3513 - dice_multi: 0.5641
Epoch 6/100
400/400 - 98s - loss: 0.3087 - dice_multi: 0.6116
Epoch 7/100
400/400 - 98s - loss: 0.2837 - dice_multi: 0.6448
Epoch 8/100
400/400 - 98s - loss: 0.2442 - dice_multi: 0.6885
Epoch 9/100
400/400 - 98s - loss: 0.2302 - dice_multi: 0.7045
Epoch 10/100
400/400 - 98s - loss: 0.2222 - dice_multi: 0.7134
Epoch 11/100
400/400 - 98s - loss: 0.2058 - dice_multi: 0.7326
Epoch 12/100
400/400 - 98s - loss: 0.2020 - dice_multi: 0.7347
Epoch 13/100
400/400 - 98s - loss: 0.1844 - dice_multi: 0.7600
Epoch 14/100
400/400 - 98s - loss: 0.1769 - dice_multi: 0.7597
Epoch 15/100
400/400 - 98s - loss: 0.1719 - dice_multi: 0.7728
Epoch 16/100
400/400 - 98s - loss: 0.1619 - dice_multi: 0.7774
Epoch 17/100
400/400 - 98s - loss: 0.1595 - dice_multi: 0.7922
Epoch 18/100
400/400 - 98s - loss: 0.1460 - dice_multi: 0.7915
Epoch 19/100
400/400 - 98s - loss: 0.1506 - dice_multi: 0.7967
Epoch 20/100
400/400 - 98s - loss: 0.1504 - dice_multi: 0.7950
Epoch 21/100
400/400 - 98s - loss: 0.1392 - dice_multi: 0.8019
Epoch 22/100
400/400 - 98s - loss: 0.1360 - dice_multi: 0.8055
Epoch 23/100
400/400 - 98s - loss: 0.1335 - dice_multi: 0.8075
Epoch 24/100
400/400 - 98s - loss: 0.1354 - dice_multi: 0.8065
Epoch 25/100
400/400 - 98s - loss: 0.1396 - dice_multi: 0.7984
Epoch 26/100
400/400 - 98s - loss: 0.1491 - dice_multi: 0.8020
Epoch 27/100
400/400 - 98s - loss: 0.1400 - dice_multi: 0.8186
Epoch 28/100
400/400 - 98s - loss: 0.1301 - dice_multi: 0.8120
Epoch 29/100
400/400 - 98s - loss: 0.1227 - dice_multi: 0.8233
Epoch 30/100
400/400 - 98s - loss: 0.1280 - dice_multi: 0.8186
Epoch 31/100
400/400 - 98s - loss: 0.1222 - dice_multi: 0.8226
Epoch 32/100
400/400 - 98s - loss: 0.1195 - dice_multi: 0.8285
Epoch 33/100
400/400 - 98s - loss: 0.1308 - dice_multi: 0.8251
Epoch 34/100
400/400 - 98s - loss: 0.1406 - dice_multi: 0.8103
Epoch 35/100
400/400 - 98s - loss: 0.1157 - dice_multi: 0.8291
Epoch 36/100
400/400 - 98s - loss: 0.1211 - dice_multi: 0.8358
Epoch 37/100
400/400 - 98s - loss: 0.1173 - dice_multi: 0.8349
Epoch 38/100
400/400 - 98s - loss: 0.1133 - dice_multi: 0.8342
Epoch 39/100
400/400 - 98s - loss: 0.1097 - dice_multi: 0.8364
Epoch 40/100
400/400 - 98s - loss: 0.1290 - dice_multi: 0.8182
Epoch 41/100
400/400 - 98s - loss: 0.1116 - dice_multi: 0.8376
Epoch 42/100
400/400 - 98s - loss: 0.1086 - dice_multi: 0.8325
Epoch 43/100
400/400 - 98s - loss: 0.1093 - dice_multi: 0.8304
Epoch 44/100
400/400 - 98s - loss: 0.1113 - dice_multi: 0.8334
Epoch 45/100
400/400 - 98s - loss: 0.1084 - dice_multi: 0.8385
Epoch 46/100
400/400 - 98s - loss: 0.1077 - dice_multi: 0.8395
Epoch 47/100
400/400 - 99s - loss: 0.1049 - dice_multi: 0.8391
Epoch 48/100
400/400 - 99s - loss: 0.1063 - dice_multi: 0.8394
Epoch 49/100
400/400 - 99s - loss: 0.1069 - dice_multi: 0.8408
Epoch 50/100
400/400 - 98s - loss: 0.1168 - dice_multi: 0.8376
Epoch 51/100
400/400 - 98s - loss: 0.1200 - dice_multi: 0.8295
Epoch 52/100
400/400 - 98s - loss: 0.1181 - dice_multi: 0.8376
Epoch 53/100
400/400 - 98s - loss: 0.1055 - dice_multi: 0.8404
Epoch 54/100
400/400 - 98s - loss: 0.1007 - dice_multi: 0.8442
Epoch 55/100
400/400 - 98s - loss: 0.1008 - dice_multi: 0.8507
Epoch 56/100
400/400 - 98s - loss: 0.1033 - dice_multi: 0.8435
Epoch 57/100
400/400 - 98s - loss: 0.0998 - dice_multi: 0.8530
Epoch 58/100
400/400 - 99s - loss: 0.0984 - dice_multi: 0.8431
Epoch 59/100
400/400 - 99s - loss: 0.1060 - dice_multi: 0.8490
Epoch 60/100
400/400 - 99s - loss: 0.1001 - dice_multi: 0.8538
Epoch 61/100
400/400 - 99s - loss: 0.1026 - dice_multi: 0.8521
Epoch 62/100
400/400 - 98s - loss: 0.1067 - dice_multi: 0.8420
Epoch 63/100
400/400 - 98s - loss: 0.1026 - dice_multi: 0.8540
Epoch 64/100
400/400 - 98s - loss: 0.0998 - dice_multi: 0.8533
Epoch 65/100
400/400 - 99s - loss: 0.0975 - dice_multi: 0.8560
Epoch 66/100
400/400 - 99s - loss: 0.0962 - dice_multi: 0.8566
Epoch 67/100
400/400 - 98s - loss: 0.0981 - dice_multi: 0.8534
Epoch 68/100
400/400 - 99s - loss: 0.0964 - dice_multi: 0.8540
Epoch 69/100
400/400 - 99s - loss: 0.1007 - dice_multi: 0.8503
Epoch 70/100
400/400 - 98s - loss: 0.0969 - dice_multi: 0.8574
Epoch 71/100
400/400 - 98s - loss: 0.0934 - dice_multi: 0.8527
Epoch 72/100
400/400 - 99s - loss: 0.0940 - dice_multi: 0.8563
Epoch 73/100
400/400 - 99s - loss: 0.0980 - dice_multi: 0.8616
Epoch 74/100
400/400 - 98s - loss: 0.0947 - dice_multi: 0.8617
Epoch 75/100
400/400 - 99s - loss: 0.0971 - dice_multi: 0.8624
Epoch 76/100
400/400 - 98s - loss: 0.0939 - dice_multi: 0.8581
Epoch 77/100
400/400 - 99s - loss: 0.0960 - dice_multi: 0.8577
Epoch 78/100
400/400 - 98s - loss: 0.0930 - dice_multi: 0.8612
Epoch 79/100
400/400 - 98s - loss: 0.1114 - dice_multi: 0.8381
Epoch 80/100
400/400 - 99s - loss: 0.0940 - dice_multi: 0.8564
Epoch 81/100
400/400 - 99s - loss: 0.0927 - dice_multi: 0.8647
Epoch 82/100
400/400 - 99s - loss: 0.0923 - dice_multi: 0.8549
Epoch 83/100
400/400 - 99s - loss: 0.0906 - dice_multi: 0.8613
Epoch 84/100
400/400 - 99s - loss: 0.0915 - dice_multi: 0.8646
Epoch 85/100
400/400 - 99s - loss: 0.0923 - dice_multi: 0.8671
Epoch 86/100
400/400 - 99s - loss: 0.0912 - dice_multi: 0.8581
Epoch 87/100
400/400 - 98s - loss: 0.0919 - dice_multi: 0.8640
Epoch 88/100
400/400 - 98s - loss: 0.0895 - dice_multi: 0.8615
Epoch 89/100
400/400 - 98s - loss: 0.0925 - dice_multi: 0.8661
Epoch 90/100
400/400 - 98s - loss: 0.1034 - dice_multi: 0.8457
Epoch 91/100
400/400 - 99s - loss: 0.0898 - dice_multi: 0.8602
Epoch 92/100
400/400 - 98s - loss: 0.0878 - dice_multi: 0.8617
Epoch 93/100
400/400 - 99s - loss: 0.0908 - dice_multi: 0.8598
Epoch 94/100
400/400 - 99s - loss: 0.0897 - dice_multi: 0.8670
Epoch 95/100
400/400 - 98s - loss: 0.0880 - dice_multi: 0.8672
Epoch 96/100
400/400 - 99s - loss: 0.0876 - dice_multi: 0.8701
Epoch 97/100
400/400 - 98s - loss: 0.0876 - dice_multi: 0.8645
Epoch 98/100
400/400 - 98s - loss: 0.0879 - dice_multi: 0.8673
Epoch 99/100
400/400 - 99s - loss: 0.0885 - dice_multi: 0.8642
Epoch 100/100
400/400 - 98s - loss: 0.0874 - dice_multi: 0.8635
training time: 9829.430631875992
executation time:144.79810802936555
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [20 21 22 23 24 25 26 27 28 29]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 99s - loss: 0.6210 - dice_multi: 0.3583
Epoch 2/100
400/400 - 98s - loss: 0.5147 - dice_multi: 0.4167
Epoch 3/100
400/400 - 97s - loss: 0.4379 - dice_multi: 0.4694
Epoch 4/100
400/400 - 97s - loss: 0.3930 - dice_multi: 0.5208
Epoch 5/100
400/400 - 98s - loss: 0.3414 - dice_multi: 0.5881
Epoch 6/100
400/400 - 98s - loss: 0.2960 - dice_multi: 0.6213
Epoch 7/100
400/400 - 98s - loss: 0.2630 - dice_multi: 0.6628
Epoch 8/100
400/400 - 98s - loss: 0.2335 - dice_multi: 0.6853
Epoch 9/100
400/400 - 98s - loss: 0.2165 - dice_multi: 0.7055
Epoch 10/100
400/400 - 98s - loss: 0.2108 - dice_multi: 0.7271
Epoch 11/100
400/400 - 98s - loss: 0.1895 - dice_multi: 0.7434
Epoch 12/100
400/400 - 98s - loss: 0.1914 - dice_multi: 0.7394
Epoch 13/100
400/400 - 98s - loss: 0.1791 - dice_multi: 0.7519
Epoch 14/100
400/400 - 98s - loss: 0.1685 - dice_multi: 0.7668
Epoch 15/100
400/400 - 98s - loss: 0.1637 - dice_multi: 0.7761
Epoch 16/100
400/400 - 98s - loss: 0.1642 - dice_multi: 0.7813
Epoch 17/100
400/400 - 99s - loss: 0.1536 - dice_multi: 0.7783
Epoch 18/100
400/400 - 99s - loss: 0.1450 - dice_multi: 0.7917
Epoch 19/100
400/400 - 98s - loss: 0.1380 - dice_multi: 0.7961
Epoch 20/100
400/400 - 98s - loss: 0.1386 - dice_multi: 0.7980
Epoch 21/100
400/400 - 97s - loss: 0.1479 - dice_multi: 0.7881
Epoch 22/100
400/400 - 97s - loss: 0.1481 - dice_multi: 0.7915
Epoch 23/100
400/400 - 98s - loss: 0.1362 - dice_multi: 0.8041
Epoch 24/100
400/400 - 98s - loss: 0.1406 - dice_multi: 0.7970
Epoch 25/100
400/400 - 98s - loss: 0.1231 - dice_multi: 0.8206
Epoch 26/100
400/400 - 98s - loss: 0.1273 - dice_multi: 0.8166
Epoch 27/100
400/400 - 97s - loss: 0.1291 - dice_multi: 0.8109
Epoch 28/100
400/400 - 98s - loss: 0.1224 - dice_multi: 0.8201
Epoch 29/100
400/400 - 98s - loss: 0.1281 - dice_multi: 0.8029
Epoch 30/100
400/400 - 98s - loss: 0.1604 - dice_multi: 0.7754
Epoch 31/100
400/400 - 98s - loss: 0.1242 - dice_multi: 0.8193
Epoch 32/100
400/400 - 97s - loss: 0.1190 - dice_multi: 0.8230
Epoch 33/100
400/400 - 98s - loss: 0.1181 - dice_multi: 0.8237
Epoch 34/100
400/400 - 98s - loss: 0.1202 - dice_multi: 0.8267
Epoch 35/100
400/400 - 98s - loss: 0.1170 - dice_multi: 0.8244
Epoch 36/100
400/400 - 98s - loss: 0.1154 - dice_multi: 0.8264
Epoch 37/100
400/400 - 98s - loss: 0.1139 - dice_multi: 0.8277
Epoch 38/100
400/400 - 98s - loss: 0.1118 - dice_multi: 0.8252
Epoch 39/100
400/400 - 98s - loss: 0.1166 - dice_multi: 0.8295
Epoch 40/100
400/400 - 98s - loss: 0.1119 - dice_multi: 0.8323
Epoch 41/100
400/400 - 98s - loss: 0.1268 - dice_multi: 0.8174
Epoch 42/100
400/400 - 98s - loss: 0.1109 - dice_multi: 0.8338
Epoch 43/100
400/400 - 98s - loss: 0.1099 - dice_multi: 0.8355
Epoch 44/100
400/400 - 98s - loss: 0.1079 - dice_multi: 0.8334
Epoch 45/100
400/400 - 98s - loss: 0.1128 - dice_multi: 0.8300
Epoch 46/100
400/400 - 99s - loss: 0.1037 - dice_multi: 0.8389
Epoch 47/100
400/400 - 99s - loss: 0.1080 - dice_multi: 0.8345
Epoch 48/100
400/400 - 98s - loss: 0.1093 - dice_multi: 0.8320
Epoch 49/100
400/400 - 98s - loss: 0.1165 - dice_multi: 0.8240
Epoch 50/100
400/400 - 98s - loss: 0.1046 - dice_multi: 0.8440
Epoch 51/100
400/400 - 98s - loss: 0.1055 - dice_multi: 0.8403
Epoch 52/100
400/400 - 98s - loss: 0.1010 - dice_multi: 0.8494
Epoch 53/100
400/400 - 98s - loss: 0.1076 - dice_multi: 0.8371
Epoch 54/100
400/400 - 98s - loss: 0.1055 - dice_multi: 0.8397
Epoch 55/100
400/400 - 98s - loss: 0.0985 - dice_multi: 0.8466
Epoch 56/100
400/400 - 98s - loss: 0.1011 - dice_multi: 0.8471
Epoch 57/100
400/400 - 98s - loss: 0.1005 - dice_multi: 0.8474
Epoch 58/100
400/400 - 99s - loss: 0.1002 - dice_multi: 0.8479
Epoch 59/100
400/400 - 98s - loss: 0.1000 - dice_multi: 0.8470
Epoch 60/100
400/400 - 98s - loss: 0.1007 - dice_multi: 0.8475
Epoch 61/100
400/400 - 99s - loss: 0.0984 - dice_multi: 0.8451
Epoch 62/100
400/400 - 98s - loss: 0.0966 - dice_multi: 0.8539
Epoch 63/100
400/400 - 98s - loss: 0.0964 - dice_multi: 0.8500
Epoch 64/100
400/400 - 99s - loss: 0.0966 - dice_multi: 0.8434
Epoch 65/100
400/400 - 98s - loss: 0.1117 - dice_multi: 0.8318
Epoch 66/100
400/400 - 99s - loss: 0.0958 - dice_multi: 0.8490
Epoch 67/100
400/400 - 98s - loss: 0.0952 - dice_multi: 0.8453
Epoch 68/100
400/400 - 98s - loss: 0.0942 - dice_multi: 0.8506
Epoch 69/100
400/400 - 98s - loss: 0.0944 - dice_multi: 0.8597
Epoch 70/100
400/400 - 98s - loss: 0.0966 - dice_multi: 0.8445
Epoch 71/100
400/400 - 98s - loss: 0.1101 - dice_multi: 0.8382
Epoch 72/100
400/400 - 98s - loss: 0.0941 - dice_multi: 0.8510
Epoch 73/100
400/400 - 98s - loss: 0.0920 - dice_multi: 0.8568
Epoch 74/100
400/400 - 98s - loss: 0.0925 - dice_multi: 0.8556
Epoch 75/100
400/400 - 99s - loss: 0.0924 - dice_multi: 0.8584
Epoch 76/100
400/400 - 98s - loss: 0.0935 - dice_multi: 0.8602
Epoch 77/100
400/400 - 99s - loss: 0.0942 - dice_multi: 0.8615
Epoch 78/100
400/400 - 99s - loss: 0.0911 - dice_multi: 0.8650
Epoch 79/100
400/400 - 98s - loss: 0.0932 - dice_multi: 0.8509
Epoch 80/100
400/400 - 98s - loss: 0.0908 - dice_multi: 0.8580
Epoch 81/100
400/400 - 98s - loss: 0.1116 - dice_multi: 0.8252
Epoch 82/100
400/400 - 99s - loss: 0.0936 - dice_multi: 0.8498
Epoch 83/100
400/400 - 99s - loss: 0.0904 - dice_multi: 0.8568
Epoch 84/100
400/400 - 99s - loss: 0.0888 - dice_multi: 0.8557
Epoch 85/100
400/400 - 99s - loss: 0.0913 - dice_multi: 0.8613
Epoch 86/100
400/400 - 98s - loss: 0.0866 - dice_multi: 0.8609
Epoch 87/100
400/400 - 99s - loss: 0.0897 - dice_multi: 0.8561
Epoch 88/100
400/400 - 98s - loss: 0.0912 - dice_multi: 0.8628
Epoch 89/100
400/400 - 98s - loss: 0.0880 - dice_multi: 0.8601
Epoch 90/100
400/400 - 99s - loss: 0.0864 - dice_multi: 0.8603
Epoch 91/100
400/400 - 99s - loss: 0.0888 - dice_multi: 0.8644
Epoch 92/100
400/400 - 99s - loss: 0.0881 - dice_multi: 0.8630
Epoch 93/100
400/400 - 98s - loss: 0.0892 - dice_multi: 0.8625
Epoch 94/100
400/400 - 98s - loss: 0.0891 - dice_multi: 0.8617
Epoch 95/100
400/400 - 98s - loss: 0.0858 - dice_multi: 0.8571
Epoch 96/100
400/400 - 98s - loss: 0.0862 - dice_multi: 0.8631
Epoch 97/100
400/400 - 98s - loss: 0.0850 - dice_multi: 0.8593
Epoch 98/100
400/400 - 98s - loss: 0.0875 - dice_multi: 0.8653
Epoch 99/100
400/400 - 98s - loss: 0.0873 - dice_multi: 0.8593
Epoch 100/100
400/400 - 99s - loss: 0.1130 - dice_multi: 0.8252
training time: 9820.764489889145
executation time:145.20548012256623
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]
training set size:  30
testing set:  [30 31 32 33 34 35 36 37 38 39 40]
testing set size:  11
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 99s - loss: 0.6374 - dice_multi: 0.4132
Epoch 2/100
400/400 - 97s - loss: 0.5007 - dice_multi: 0.4947
Epoch 3/100
400/400 - 97s - loss: 0.4215 - dice_multi: 0.5638
Epoch 4/100
400/400 - 98s - loss: 0.3531 - dice_multi: 0.6220
Epoch 5/100
400/400 - 98s - loss: 0.3203 - dice_multi: 0.6656
Epoch 6/100
400/400 - 98s - loss: 0.2827 - dice_multi: 0.6875
Epoch 7/100
400/400 - 98s - loss: 0.2483 - dice_multi: 0.7183
Epoch 8/100
400/400 - 98s - loss: 0.2397 - dice_multi: 0.7307
Epoch 9/100
400/400 - 98s - loss: 0.2089 - dice_multi: 0.7492
Epoch 10/100
400/400 - 98s - loss: 0.2068 - dice_multi: 0.7601
Epoch 11/100
400/400 - 98s - loss: 0.1932 - dice_multi: 0.7769
Epoch 12/100
400/400 - 98s - loss: 0.1844 - dice_multi: 0.7849
Epoch 13/100
400/400 - 98s - loss: 0.1872 - dice_multi: 0.7820
Epoch 14/100
400/400 - 98s - loss: 0.1704 - dice_multi: 0.7989
Epoch 15/100
400/400 - 98s - loss: 0.1662 - dice_multi: 0.7983
Epoch 16/100
400/400 - 98s - loss: 0.1571 - dice_multi: 0.8089
Epoch 17/100
400/400 - 98s - loss: 0.1649 - dice_multi: 0.8002
Epoch 18/100
400/400 - 98s - loss: 0.1704 - dice_multi: 0.8054
Epoch 19/100
400/400 - 98s - loss: 0.1484 - dice_multi: 0.8175
Epoch 20/100
400/400 - 98s - loss: 0.1530 - dice_multi: 0.8087
Epoch 21/100
400/400 - 98s - loss: 0.1420 - dice_multi: 0.8291
Epoch 22/100
400/400 - 98s - loss: 0.1738 - dice_multi: 0.8009
Epoch 23/100
400/400 - 98s - loss: 0.1411 - dice_multi: 0.8270
Epoch 24/100
400/400 - 98s - loss: 0.1371 - dice_multi: 0.8330
Epoch 25/100
400/400 - 98s - loss: 0.1413 - dice_multi: 0.8282
Epoch 26/100
400/400 - 98s - loss: 0.1346 - dice_multi: 0.8301
Epoch 27/100
400/400 - 98s - loss: 0.1357 - dice_multi: 0.8353
Epoch 28/100
400/400 - 98s - loss: 0.1302 - dice_multi: 0.8365
Epoch 29/100
400/400 - 98s - loss: 0.1283 - dice_multi: 0.8368
Epoch 30/100
400/400 - 97s - loss: 0.1636 - dice_multi: 0.8096
Epoch 31/100
400/400 - 98s - loss: 0.1371 - dice_multi: 0.8329
Epoch 32/100
400/400 - 98s - loss: 0.1270 - dice_multi: 0.8380
Epoch 33/100
400/400 - 98s - loss: 0.1223 - dice_multi: 0.8391
Epoch 34/100
400/400 - 98s - loss: 0.1213 - dice_multi: 0.8448
Epoch 35/100
400/400 - 98s - loss: 0.1320 - dice_multi: 0.8371
Epoch 36/100
400/400 - 98s - loss: 0.1213 - dice_multi: 0.8503
Epoch 37/100
400/400 - 98s - loss: 0.1370 - dice_multi: 0.8317
Epoch 38/100
400/400 - 98s - loss: 0.1218 - dice_multi: 0.8442
Epoch 39/100
400/400 - 98s - loss: 0.1200 - dice_multi: 0.8521
Epoch 40/100
400/400 - 98s - loss: 0.1193 - dice_multi: 0.8485
Epoch 41/100
400/400 - 98s - loss: 0.1195 - dice_multi: 0.8484
Epoch 42/100
400/400 - 98s - loss: 0.1168 - dice_multi: 0.8498
Epoch 43/100
400/400 - 98s - loss: 0.1176 - dice_multi: 0.8492
Epoch 44/100
400/400 - 98s - loss: 0.1157 - dice_multi: 0.8494
Epoch 45/100
400/400 - 98s - loss: 0.1171 - dice_multi: 0.8447
Epoch 46/100
400/400 - 98s - loss: 0.1130 - dice_multi: 0.8561
Epoch 47/100
400/400 - 98s - loss: 0.1345 - dice_multi: 0.8295
Epoch 48/100
400/400 - 98s - loss: 0.1164 - dice_multi: 0.8559
Epoch 49/100
400/400 - 98s - loss: 0.1186 - dice_multi: 0.8468
Epoch 50/100
400/400 - 98s - loss: 0.1149 - dice_multi: 0.8559
Epoch 51/100
400/400 - 98s - loss: 0.1110 - dice_multi: 0.8511
Epoch 52/100
400/400 - 98s - loss: 0.1106 - dice_multi: 0.8596
Epoch 53/100
400/400 - 98s - loss: 0.1088 - dice_multi: 0.8633
Epoch 54/100
400/400 - 98s - loss: 0.1110 - dice_multi: 0.8619
Epoch 55/100
400/400 - 98s - loss: 0.1110 - dice_multi: 0.8624
Epoch 56/100
400/400 - 98s - loss: 0.1344 - dice_multi: 0.8415
Epoch 57/100
400/400 - 98s - loss: 0.1110 - dice_multi: 0.8551
Epoch 58/100
400/400 - 98s - loss: 0.1095 - dice_multi: 0.8686
Epoch 59/100
400/400 - 98s - loss: 0.1059 - dice_multi: 0.8641
Epoch 60/100
400/400 - 98s - loss: 0.1252 - dice_multi: 0.8377
Epoch 61/100
400/400 - 98s - loss: 0.1086 - dice_multi: 0.8657
Epoch 62/100
400/400 - 98s - loss: 0.1088 - dice_multi: 0.8590
Epoch 63/100
400/400 - 98s - loss: 0.1057 - dice_multi: 0.8611
Epoch 64/100
400/400 - 97s - loss: 0.1053 - dice_multi: 0.8649
Epoch 65/100
400/400 - 98s - loss: 0.1081 - dice_multi: 0.8652
Epoch 66/100
400/400 - 98s - loss: 0.1037 - dice_multi: 0.8617
Epoch 67/100
400/400 - 98s - loss: 0.1109 - dice_multi: 0.8633
Epoch 68/100
400/400 - 98s - loss: 0.1024 - dice_multi: 0.8647
Epoch 69/100
400/400 - 98s - loss: 0.1043 - dice_multi: 0.8637
Epoch 70/100
400/400 - 98s - loss: 0.1046 - dice_multi: 0.8669
Epoch 71/100
400/400 - 98s - loss: 0.1008 - dice_multi: 0.8637
Epoch 72/100
400/400 - 98s - loss: 0.1052 - dice_multi: 0.8657
Epoch 73/100
400/400 - 98s - loss: 0.1021 - dice_multi: 0.8618
Epoch 74/100
400/400 - 98s - loss: 0.1153 - dice_multi: 0.8548
Epoch 75/100
400/400 - 98s - loss: 0.1080 - dice_multi: 0.8681
Epoch 76/100
400/400 - 98s - loss: 0.1046 - dice_multi: 0.8703
Epoch 77/100
400/400 - 98s - loss: 0.1005 - dice_multi: 0.8693
Epoch 78/100
400/400 - 98s - loss: 0.0990 - dice_multi: 0.8683
Epoch 79/100
400/400 - 98s - loss: 0.0994 - dice_multi: 0.8753
Epoch 80/100
400/400 - 98s - loss: 0.0985 - dice_multi: 0.8722
Epoch 81/100
400/400 - 98s - loss: 0.0991 - dice_multi: 0.8654
Epoch 82/100
400/400 - 98s - loss: 0.0996 - dice_multi: 0.8649
Epoch 83/100
400/400 - 98s - loss: 0.0980 - dice_multi: 0.8694
Epoch 84/100
400/400 - 98s - loss: 0.0998 - dice_multi: 0.8704
Epoch 85/100
400/400 - 98s - loss: 0.0954 - dice_multi: 0.8730
Epoch 86/100
400/400 - 98s - loss: 0.0985 - dice_multi: 0.8716
Epoch 87/100
400/400 - 98s - loss: 0.0998 - dice_multi: 0.8595
Epoch 88/100
400/400 - 98s - loss: 0.0958 - dice_multi: 0.8723
Epoch 89/100
400/400 - 98s - loss: 0.1017 - dice_multi: 0.8696
Epoch 90/100
400/400 - 98s - loss: 0.0969 - dice_multi: 0.8658
Epoch 91/100
400/400 - 98s - loss: 0.0970 - dice_multi: 0.8746
Epoch 92/100
400/400 - 98s - loss: 0.0965 - dice_multi: 0.8745
Epoch 93/100
400/400 - 97s - loss: 0.0971 - dice_multi: 0.8699
Epoch 94/100
400/400 - 98s - loss: 0.0958 - dice_multi: 0.8790
Epoch 95/100
400/400 - 98s - loss: 0.0980 - dice_multi: 0.8683
Epoch 96/100
400/400 - 98s - loss: 0.0955 - dice_multi: 0.8704
Epoch 97/100
400/400 - 98s - loss: 0.0945 - dice_multi: 0.8757
Epoch 98/100
400/400 - 98s - loss: 0.0950 - dice_multi: 0.8754
Epoch 99/100
400/400 - 98s - loss: 0.0956 - dice_multi: 0.8731
Epoch 100/100
400/400 - 98s - loss: 0.0957 - dice_multi: 0.8757
training time: 9789.851314544678
executation time:147.4828268181194
[0.9926018  0.9451107  0.81360066 0.89775646 0.8383273  0.88599443
 0.89726883]
