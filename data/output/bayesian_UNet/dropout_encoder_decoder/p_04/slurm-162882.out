Loading tensorflow/2.5
  Loading requirement: cuda11.2/toolkit/11.2.2 cudnn8.1-cuda11.2/8.1.1.33
    hdf5_18/1.8.20
run_bayesian_U-Net
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2021-09-23 05:18:43.226619: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(41, 256, 128, 256)
..loading data finished Thu Sep 23 05:19:10 2021
2021-09-23 05:19:10.043923: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-09-23 05:19:10.097321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-23 05:19:10.097362: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-23 05:19:10.112855: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-23 05:19:10.112949: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-09-23 05:19:10.116677: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-09-23 05:19:10.117655: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-09-23 05:19:10.119430: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-09-23 05:19:10.121279: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-09-23 05:19:10.121824: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-23 05:19:10.125536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-23 05:19:10.130650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-23 05:19:10.134374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-23 05:19:10.134427: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-23 05:19:10.646154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-23 05:19:10.646203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-09-23 05:19:10.646215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-09-23 05:19:10.652326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38184 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:3b:00.0, compute capability: 8.0)
---------fold--1---------
training set:  [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [0 1 2 3 4 5 6 7 8 9]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
2021-09-23 05:19:13.376431: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-09-23 05:19:13.376901: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2100000000 Hz
2021-09-23 05:19:16.038556: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-23 05:19:17.043656: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2021-09-23 05:19:18.043256: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-23 05:19:18.825121: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 130s - loss: 0.6529 - dice_multi: 0.3873
Epoch 2/100
400/400 - 98s - loss: 0.5029 - dice_multi: 0.4649
Epoch 3/100
400/400 - 98s - loss: 0.4207 - dice_multi: 0.5225
Epoch 4/100
400/400 - 99s - loss: 0.3614 - dice_multi: 0.5693
Epoch 5/100
400/400 - 99s - loss: 0.2996 - dice_multi: 0.6339
Epoch 6/100
400/400 - 99s - loss: 0.2778 - dice_multi: 0.6656
Epoch 7/100
400/400 - 99s - loss: 0.2312 - dice_multi: 0.7168
Epoch 8/100
400/400 - 99s - loss: 0.2127 - dice_multi: 0.7246
Epoch 9/100
400/400 - 99s - loss: 0.2002 - dice_multi: 0.7521
Epoch 10/100
400/400 - 99s - loss: 0.1961 - dice_multi: 0.7487
Epoch 11/100
400/400 - 99s - loss: 0.1835 - dice_multi: 0.7536
Epoch 12/100
400/400 - 99s - loss: 0.1698 - dice_multi: 0.7795
Epoch 13/100
400/400 - 99s - loss: 0.1768 - dice_multi: 0.7727
Epoch 14/100
400/400 - 99s - loss: 0.1628 - dice_multi: 0.7820
Epoch 15/100
400/400 - 99s - loss: 0.1542 - dice_multi: 0.7943
Epoch 16/100
400/400 - 99s - loss: 0.1392 - dice_multi: 0.8021
Epoch 17/100
400/400 - 98s - loss: 0.1451 - dice_multi: 0.8054
Epoch 18/100
400/400 - 99s - loss: 0.1480 - dice_multi: 0.8004
Epoch 19/100
400/400 - 99s - loss: 0.1356 - dice_multi: 0.8132
Epoch 20/100
400/400 - 99s - loss: 0.1489 - dice_multi: 0.7999
Epoch 21/100
400/400 - 99s - loss: 0.1348 - dice_multi: 0.8257
Epoch 22/100
400/400 - 98s - loss: 0.1268 - dice_multi: 0.8202
Epoch 23/100
400/400 - 99s - loss: 0.1293 - dice_multi: 0.8227
Epoch 24/100
400/400 - 99s - loss: 0.1293 - dice_multi: 0.8264
Epoch 25/100
400/400 - 99s - loss: 0.1317 - dice_multi: 0.8205
Epoch 26/100
400/400 - 99s - loss: 0.1237 - dice_multi: 0.8321
Epoch 27/100
400/400 - 99s - loss: 0.1320 - dice_multi: 0.8193
Epoch 28/100
400/400 - 98s - loss: 0.1191 - dice_multi: 0.8308
Epoch 29/100
400/400 - 99s - loss: 0.1206 - dice_multi: 0.8358
Epoch 30/100
400/400 - 99s - loss: 0.1160 - dice_multi: 0.8392
Epoch 31/100
400/400 - 99s - loss: 0.1295 - dice_multi: 0.8295
Epoch 32/100
400/400 - 99s - loss: 0.1195 - dice_multi: 0.8347
Epoch 33/100
400/400 - 99s - loss: 0.1179 - dice_multi: 0.8389
Epoch 34/100
400/400 - 98s - loss: 0.1255 - dice_multi: 0.8325
Epoch 35/100
400/400 - 99s - loss: 0.1098 - dice_multi: 0.8507
Epoch 36/100
400/400 - 99s - loss: 0.1154 - dice_multi: 0.8444
Epoch 37/100
400/400 - 99s - loss: 0.1093 - dice_multi: 0.8442
Epoch 38/100
400/400 - 100s - loss: 0.1198 - dice_multi: 0.8321
Epoch 39/100
400/400 - 100s - loss: 0.1085 - dice_multi: 0.8422
Epoch 40/100
400/400 - 100s - loss: 0.1115 - dice_multi: 0.8426
Epoch 41/100
400/400 - 100s - loss: 0.1103 - dice_multi: 0.8503
Epoch 42/100
400/400 - 100s - loss: 0.1061 - dice_multi: 0.8437
Epoch 43/100
400/400 - 100s - loss: 0.1093 - dice_multi: 0.8473
Epoch 44/100
400/400 - 100s - loss: 0.1092 - dice_multi: 0.8521
Epoch 45/100
400/400 - 100s - loss: 0.1057 - dice_multi: 0.8529
Epoch 46/100
400/400 - 101s - loss: 0.1141 - dice_multi: 0.8441
Epoch 47/100
400/400 - 100s - loss: 0.1059 - dice_multi: 0.8519
Epoch 48/100
400/400 - 100s - loss: 0.1015 - dice_multi: 0.8503
Epoch 49/100
400/400 - 101s - loss: 0.1003 - dice_multi: 0.8535
Epoch 50/100
400/400 - 101s - loss: 0.1016 - dice_multi: 0.8511
Epoch 51/100
400/400 - 100s - loss: 0.1184 - dice_multi: 0.8349
Epoch 52/100
400/400 - 101s - loss: 0.1145 - dice_multi: 0.8444
Epoch 53/100
400/400 - 100s - loss: 0.1018 - dice_multi: 0.8551
Epoch 54/100
400/400 - 101s - loss: 0.1016 - dice_multi: 0.8613
Epoch 55/100
400/400 - 101s - loss: 0.1004 - dice_multi: 0.8597
Epoch 56/100
400/400 - 101s - loss: 0.0989 - dice_multi: 0.8658
Epoch 57/100
400/400 - 101s - loss: 0.0975 - dice_multi: 0.8583
Epoch 58/100
400/400 - 101s - loss: 0.0983 - dice_multi: 0.8578
Epoch 59/100
400/400 - 101s - loss: 0.1007 - dice_multi: 0.8566
Epoch 60/100
400/400 - 101s - loss: 0.0972 - dice_multi: 0.8574
Epoch 61/100
400/400 - 102s - loss: 0.1020 - dice_multi: 0.8601
Epoch 62/100
400/400 - 101s - loss: 0.0995 - dice_multi: 0.8651
Epoch 63/100
400/400 - 101s - loss: 0.0946 - dice_multi: 0.8610
Epoch 64/100
400/400 - 101s - loss: 0.0950 - dice_multi: 0.8586
Epoch 65/100
400/400 - 101s - loss: 0.0960 - dice_multi: 0.8691
Epoch 66/100
400/400 - 101s - loss: 0.1208 - dice_multi: 0.8305
Epoch 67/100
400/400 - 101s - loss: 0.0983 - dice_multi: 0.8665
Epoch 68/100
400/400 - 100s - loss: 0.0946 - dice_multi: 0.8627
Epoch 69/100
400/400 - 101s - loss: 0.0942 - dice_multi: 0.8614
Epoch 70/100
400/400 - 101s - loss: 0.0935 - dice_multi: 0.8629
Epoch 71/100
400/400 - 101s - loss: 0.0906 - dice_multi: 0.8641
Epoch 72/100
400/400 - 101s - loss: 0.1138 - dice_multi: 0.8481
Epoch 73/100
400/400 - 100s - loss: 0.0966 - dice_multi: 0.8626
Epoch 74/100
400/400 - 101s - loss: 0.0954 - dice_multi: 0.8680
Epoch 75/100
400/400 - 101s - loss: 0.0930 - dice_multi: 0.8660
Epoch 76/100
400/400 - 101s - loss: 0.0921 - dice_multi: 0.8752
Epoch 77/100
400/400 - 101s - loss: 0.0936 - dice_multi: 0.8705
Epoch 78/100
400/400 - 101s - loss: 0.0929 - dice_multi: 0.8648
Epoch 79/100
400/400 - 101s - loss: 0.1011 - dice_multi: 0.8508
Epoch 80/100
400/400 - 101s - loss: 0.0950 - dice_multi: 0.8640
Epoch 81/100
400/400 - 101s - loss: 0.0914 - dice_multi: 0.8677
Epoch 82/100
400/400 - 101s - loss: 0.0916 - dice_multi: 0.8572
Epoch 83/100
400/400 - 101s - loss: 0.1001 - dice_multi: 0.8584
Epoch 84/100
400/400 - 100s - loss: 0.0923 - dice_multi: 0.8724
Epoch 85/100
400/400 - 101s - loss: 0.0904 - dice_multi: 0.8670
Epoch 86/100
400/400 - 101s - loss: 0.0892 - dice_multi: 0.8676
Epoch 87/100
400/400 - 101s - loss: 0.0912 - dice_multi: 0.8701
Epoch 88/100
400/400 - 100s - loss: 0.0897 - dice_multi: 0.8719
Epoch 89/100
400/400 - 101s - loss: 0.0895 - dice_multi: 0.8750
Epoch 90/100
400/400 - 100s - loss: 0.1073 - dice_multi: 0.8552
Epoch 91/100
400/400 - 101s - loss: 0.0924 - dice_multi: 0.8719
Epoch 92/100
400/400 - 101s - loss: 0.0888 - dice_multi: 0.8763
Epoch 93/100
400/400 - 101s - loss: 0.0883 - dice_multi: 0.8702
Epoch 94/100
400/400 - 100s - loss: 0.0909 - dice_multi: 0.8757
Epoch 95/100
400/400 - 101s - loss: 0.0892 - dice_multi: 0.8725
Epoch 96/100
400/400 - 101s - loss: 0.0883 - dice_multi: 0.8759
Epoch 97/100
400/400 - 101s - loss: 0.0901 - dice_multi: 0.8668
Epoch 98/100
400/400 - 101s - loss: 0.0878 - dice_multi: 0.8740
Epoch 99/100
400/400 - 100s - loss: 0.0890 - dice_multi: 0.8701
Epoch 100/100
400/400 - 101s - loss: 0.0886 - dice_multi: 0.8698
2021-09-23 08:06:35.312856: I tensorflow/stream_executor/cuda/cuda_blas.cc:1839] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
training time: 10037.237879514694
executation time:144.2203369140625
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [10 11 12 13 14 15 16 17 18 19]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 105s - loss: 0.6595 - dice_multi: 0.3678
Epoch 2/100
400/400 - 102s - loss: 0.5251 - dice_multi: 0.4431
Epoch 3/100
400/400 - 101s - loss: 0.4597 - dice_multi: 0.4908
Epoch 4/100
400/400 - 102s - loss: 0.4051 - dice_multi: 0.5375
Epoch 5/100
400/400 - 103s - loss: 0.3597 - dice_multi: 0.5768
Epoch 6/100
400/400 - 103s - loss: 0.3247 - dice_multi: 0.6221
Epoch 7/100
400/400 - 104s - loss: 0.2911 - dice_multi: 0.6486
Epoch 8/100
400/400 - 102s - loss: 0.2570 - dice_multi: 0.6773
Epoch 9/100
400/400 - 103s - loss: 0.2344 - dice_multi: 0.6912
Epoch 10/100
400/400 - 102s - loss: 0.2288 - dice_multi: 0.7086
Epoch 11/100
400/400 - 103s - loss: 0.2127 - dice_multi: 0.7269
Epoch 12/100
400/400 - 103s - loss: 0.2104 - dice_multi: 0.7336
Epoch 13/100
400/400 - 102s - loss: 0.2018 - dice_multi: 0.7407
Epoch 14/100
400/400 - 101s - loss: 0.1909 - dice_multi: 0.7514
Epoch 15/100
400/400 - 101s - loss: 0.1758 - dice_multi: 0.7645
Epoch 16/100
400/400 - 101s - loss: 0.1676 - dice_multi: 0.7664
Epoch 17/100
400/400 - 101s - loss: 0.1697 - dice_multi: 0.7720
Epoch 18/100
400/400 - 101s - loss: 0.1600 - dice_multi: 0.7894
Epoch 19/100
400/400 - 101s - loss: 0.1778 - dice_multi: 0.7688
Epoch 20/100
400/400 - 102s - loss: 0.1604 - dice_multi: 0.7747
Epoch 21/100
400/400 - 101s - loss: 0.1552 - dice_multi: 0.7892
Epoch 22/100
400/400 - 103s - loss: 0.1549 - dice_multi: 0.7889
Epoch 23/100
400/400 - 104s - loss: 0.1433 - dice_multi: 0.7959
Epoch 24/100
400/400 - 102s - loss: 0.1486 - dice_multi: 0.7989
Epoch 25/100
400/400 - 101s - loss: 0.1446 - dice_multi: 0.7952
Epoch 26/100
400/400 - 101s - loss: 0.1485 - dice_multi: 0.7929
Epoch 27/100
400/400 - 103s - loss: 0.1424 - dice_multi: 0.7982
Epoch 28/100
400/400 - 101s - loss: 0.1338 - dice_multi: 0.8124
Epoch 29/100
400/400 - 101s - loss: 0.1399 - dice_multi: 0.8049
Epoch 30/100
400/400 - 101s - loss: 0.1358 - dice_multi: 0.8144
Epoch 31/100
400/400 - 102s - loss: 0.1286 - dice_multi: 0.8157
Epoch 32/100
400/400 - 101s - loss: 0.1361 - dice_multi: 0.8084
Epoch 33/100
400/400 - 101s - loss: 0.1339 - dice_multi: 0.8151
Epoch 34/100
400/400 - 102s - loss: 0.1293 - dice_multi: 0.8144
Epoch 35/100
400/400 - 101s - loss: 0.1236 - dice_multi: 0.8308
Epoch 36/100
400/400 - 102s - loss: 0.1231 - dice_multi: 0.8235
Epoch 37/100
400/400 - 101s - loss: 0.1399 - dice_multi: 0.8143
Epoch 38/100
400/400 - 101s - loss: 0.1297 - dice_multi: 0.8205
Epoch 39/100
400/400 - 101s - loss: 0.1189 - dice_multi: 0.8318
Epoch 40/100
400/400 - 102s - loss: 0.1243 - dice_multi: 0.8272
Epoch 41/100
400/400 - 102s - loss: 0.1195 - dice_multi: 0.8313
Epoch 42/100
400/400 - 104s - loss: 0.1188 - dice_multi: 0.8300
Epoch 43/100
400/400 - 102s - loss: 0.1135 - dice_multi: 0.8270
Epoch 44/100
400/400 - 102s - loss: 0.1177 - dice_multi: 0.8345
Epoch 45/100
400/400 - 102s - loss: 0.1269 - dice_multi: 0.8272
Epoch 46/100
400/400 - 101s - loss: 0.1177 - dice_multi: 0.8301
Epoch 47/100
400/400 - 102s - loss: 0.1118 - dice_multi: 0.8346
Epoch 48/100
400/400 - 104s - loss: 0.1137 - dice_multi: 0.8339
Epoch 49/100
400/400 - 101s - loss: 0.1246 - dice_multi: 0.8363
Epoch 50/100
400/400 - 101s - loss: 0.1128 - dice_multi: 0.8376
Epoch 51/100
400/400 - 101s - loss: 0.1114 - dice_multi: 0.8350
Epoch 52/100
400/400 - 100s - loss: 0.1098 - dice_multi: 0.8416
Epoch 53/100
400/400 - 101s - loss: 0.1112 - dice_multi: 0.8456
Epoch 54/100
400/400 - 103s - loss: 0.1089 - dice_multi: 0.8424
Epoch 55/100
400/400 - 101s - loss: 0.1154 - dice_multi: 0.8322
Epoch 56/100
400/400 - 101s - loss: 0.1105 - dice_multi: 0.8343
Epoch 57/100
400/400 - 104s - loss: 0.1059 - dice_multi: 0.8388
Epoch 58/100
400/400 - 103s - loss: 0.1216 - dice_multi: 0.8274
Epoch 59/100
400/400 - 102s - loss: 0.1121 - dice_multi: 0.8369
Epoch 60/100
400/400 - 103s - loss: 0.1068 - dice_multi: 0.8453
Epoch 61/100
400/400 - 102s - loss: 0.1031 - dice_multi: 0.8466
Epoch 62/100
400/400 - 101s - loss: 0.1033 - dice_multi: 0.8389
Epoch 63/100
400/400 - 101s - loss: 0.1029 - dice_multi: 0.8514
Epoch 64/100
400/400 - 102s - loss: 0.1069 - dice_multi: 0.8490
Epoch 65/100
400/400 - 104s - loss: 0.1034 - dice_multi: 0.8381
Epoch 66/100
400/400 - 103s - loss: 0.1058 - dice_multi: 0.8525
Epoch 67/100
400/400 - 102s - loss: 0.1196 - dice_multi: 0.8256
Epoch 68/100
400/400 - 101s - loss: 0.1034 - dice_multi: 0.8458
Epoch 69/100
400/400 - 102s - loss: 0.1029 - dice_multi: 0.8478
Epoch 70/100
400/400 - 102s - loss: 0.1005 - dice_multi: 0.8481
Epoch 71/100
400/400 - 101s - loss: 0.1043 - dice_multi: 0.8501
Epoch 72/100
400/400 - 102s - loss: 0.1014 - dice_multi: 0.8497
Epoch 73/100
400/400 - 101s - loss: 0.1096 - dice_multi: 0.8431
Epoch 74/100
400/400 - 102s - loss: 0.1031 - dice_multi: 0.8496
Epoch 75/100
400/400 - 102s - loss: 0.1005 - dice_multi: 0.8522
Epoch 76/100
400/400 - 101s - loss: 0.1001 - dice_multi: 0.8480
Epoch 77/100
400/400 - 101s - loss: 0.1054 - dice_multi: 0.8485
Epoch 78/100
400/400 - 101s - loss: 0.1021 - dice_multi: 0.8531
Epoch 79/100
400/400 - 103s - loss: 0.0981 - dice_multi: 0.8517
Epoch 80/100
400/400 - 101s - loss: 0.1159 - dice_multi: 0.8352
Epoch 81/100
400/400 - 101s - loss: 0.1039 - dice_multi: 0.8448
Epoch 82/100
400/400 - 101s - loss: 0.0988 - dice_multi: 0.8513
Epoch 83/100
400/400 - 101s - loss: 0.1038 - dice_multi: 0.8572
Epoch 84/100
400/400 - 102s - loss: 0.0977 - dice_multi: 0.8530
Epoch 85/100
400/400 - 102s - loss: 0.0965 - dice_multi: 0.8480
Epoch 86/100
400/400 - 101s - loss: 0.0969 - dice_multi: 0.8532
Epoch 87/100
400/400 - 104s - loss: 0.0988 - dice_multi: 0.8521
Epoch 88/100
400/400 - 103s - loss: 0.0960 - dice_multi: 0.8542
Epoch 89/100
400/400 - 102s - loss: 0.0975 - dice_multi: 0.8538
Epoch 90/100
400/400 - 101s - loss: 0.0961 - dice_multi: 0.8613
Epoch 91/100
400/400 - 102s - loss: 0.0983 - dice_multi: 0.8609
Epoch 92/100
400/400 - 101s - loss: 0.1262 - dice_multi: 0.8291
Epoch 93/100
400/400 - 101s - loss: 0.1012 - dice_multi: 0.8548
Epoch 94/100
400/400 - 101s - loss: 0.0952 - dice_multi: 0.8548
Epoch 95/100
400/400 - 102s - loss: 0.0952 - dice_multi: 0.8566
Epoch 96/100
400/400 - 102s - loss: 0.0939 - dice_multi: 0.8555
Epoch 97/100
400/400 - 103s - loss: 0.0919 - dice_multi: 0.8554
Epoch 98/100
400/400 - 104s - loss: 0.0960 - dice_multi: 0.8576
Epoch 99/100
400/400 - 106s - loss: 0.0951 - dice_multi: 0.8591
Epoch 100/100
400/400 - 104s - loss: 0.0923 - dice_multi: 0.8587
training time: 10203.118742704391
executation time:143.3682892560959
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [20 21 22 23 24 25 26 27 28 29]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 102s - loss: 0.6422 - dice_multi: 0.3623
Epoch 2/100
400/400 - 100s - loss: 0.4969 - dice_multi: 0.4270
Epoch 3/100
400/400 - 100s - loss: 0.4280 - dice_multi: 0.4722
Epoch 4/100
400/400 - 100s - loss: 0.3949 - dice_multi: 0.5172
Epoch 5/100
400/400 - 100s - loss: 0.3473 - dice_multi: 0.5564
Epoch 6/100
400/400 - 100s - loss: 0.3100 - dice_multi: 0.6065
Epoch 7/100
400/400 - 100s - loss: 0.2798 - dice_multi: 0.6316
Epoch 8/100
400/400 - 100s - loss: 0.2510 - dice_multi: 0.6668
Epoch 9/100
400/400 - 101s - loss: 0.2331 - dice_multi: 0.6770
Epoch 10/100
400/400 - 100s - loss: 0.2133 - dice_multi: 0.7030
Epoch 11/100
400/400 - 101s - loss: 0.2037 - dice_multi: 0.7140
Epoch 12/100
400/400 - 100s - loss: 0.1976 - dice_multi: 0.7197
Epoch 13/100
400/400 - 100s - loss: 0.2003 - dice_multi: 0.7330
Epoch 14/100
400/400 - 101s - loss: 0.1750 - dice_multi: 0.7530
Epoch 15/100
400/400 - 101s - loss: 0.1732 - dice_multi: 0.7578
Epoch 16/100
400/400 - 101s - loss: 0.1689 - dice_multi: 0.7607
Epoch 17/100
400/400 - 100s - loss: 0.1695 - dice_multi: 0.7533
Epoch 18/100
400/400 - 101s - loss: 0.1580 - dice_multi: 0.7754
Epoch 19/100
400/400 - 100s - loss: 0.1593 - dice_multi: 0.7821
Epoch 20/100
400/400 - 101s - loss: 0.1529 - dice_multi: 0.7808
Epoch 21/100
400/400 - 101s - loss: 0.1505 - dice_multi: 0.7914
Epoch 22/100
400/400 - 100s - loss: 0.1478 - dice_multi: 0.7953
Epoch 23/100
400/400 - 101s - loss: 0.1433 - dice_multi: 0.7927
Epoch 24/100
400/400 - 100s - loss: 0.1480 - dice_multi: 0.7828
Epoch 25/100
400/400 - 101s - loss: 0.1375 - dice_multi: 0.7978
Epoch 26/100
400/400 - 101s - loss: 0.1370 - dice_multi: 0.8003
Epoch 27/100
400/400 - 101s - loss: 0.1335 - dice_multi: 0.8033
Epoch 28/100
400/400 - 101s - loss: 0.1318 - dice_multi: 0.8060
Epoch 29/100
400/400 - 102s - loss: 0.1321 - dice_multi: 0.8114
Epoch 30/100
400/400 - 101s - loss: 0.1372 - dice_multi: 0.8063
Epoch 31/100
400/400 - 101s - loss: 0.1273 - dice_multi: 0.8133
Epoch 32/100
400/400 - 101s - loss: 0.1296 - dice_multi: 0.8070
Epoch 33/100
400/400 - 101s - loss: 0.1260 - dice_multi: 0.8126
Epoch 34/100
400/400 - 101s - loss: 0.1426 - dice_multi: 0.7939
Epoch 35/100
400/400 - 101s - loss: 0.1181 - dice_multi: 0.8184
Epoch 36/100
400/400 - 101s - loss: 0.1214 - dice_multi: 0.8146
Epoch 37/100
400/400 - 101s - loss: 0.1174 - dice_multi: 0.8233
Epoch 38/100
400/400 - 100s - loss: 0.1326 - dice_multi: 0.8053
Epoch 39/100
400/400 - 101s - loss: 0.1170 - dice_multi: 0.8248
Epoch 40/100
400/400 - 101s - loss: 0.1187 - dice_multi: 0.8252
Epoch 41/100
400/400 - 101s - loss: 0.1261 - dice_multi: 0.8066
Epoch 42/100
400/400 - 101s - loss: 0.1152 - dice_multi: 0.8234
Epoch 43/100
400/400 - 101s - loss: 0.1118 - dice_multi: 0.8269
Epoch 44/100
400/400 - 101s - loss: 0.1186 - dice_multi: 0.8243
Epoch 45/100
400/400 - 101s - loss: 0.1146 - dice_multi: 0.8244
Epoch 46/100
400/400 - 101s - loss: 0.1091 - dice_multi: 0.8325
Epoch 47/100
400/400 - 100s - loss: 0.1107 - dice_multi: 0.8402
Epoch 48/100
400/400 - 101s - loss: 0.1183 - dice_multi: 0.8307
Epoch 49/100
400/400 - 101s - loss: 0.1180 - dice_multi: 0.8253
Epoch 50/100
400/400 - 101s - loss: 0.1073 - dice_multi: 0.8344
Epoch 51/100
400/400 - 100s - loss: 0.1116 - dice_multi: 0.8314
Epoch 52/100
400/400 - 101s - loss: 0.1113 - dice_multi: 0.8250
Epoch 53/100
400/400 - 101s - loss: 0.1191 - dice_multi: 0.8226
Epoch 54/100
400/400 - 101s - loss: 0.1075 - dice_multi: 0.8365
Epoch 55/100
400/400 - 101s - loss: 0.1055 - dice_multi: 0.8341
Epoch 56/100
400/400 - 101s - loss: 0.1071 - dice_multi: 0.8395
Epoch 57/100
400/400 - 101s - loss: 0.1076 - dice_multi: 0.8334
Epoch 58/100
400/400 - 100s - loss: 0.1112 - dice_multi: 0.8291
Epoch 59/100
400/400 - 101s - loss: 0.1076 - dice_multi: 0.8368
Epoch 60/100
400/400 - 101s - loss: 0.1033 - dice_multi: 0.8438
Epoch 61/100
400/400 - 101s - loss: 0.1026 - dice_multi: 0.8438
Epoch 62/100
400/400 - 101s - loss: 0.1009 - dice_multi: 0.8473
Epoch 63/100
400/400 - 101s - loss: 0.1185 - dice_multi: 0.8236
Epoch 64/100
400/400 - 101s - loss: 0.1035 - dice_multi: 0.8494
Epoch 65/100
400/400 - 101s - loss: 0.1007 - dice_multi: 0.8463
Epoch 66/100
400/400 - 101s - loss: 0.1059 - dice_multi: 0.8395
Epoch 67/100
400/400 - 102s - loss: 0.1108 - dice_multi: 0.8329
Epoch 68/100
400/400 - 101s - loss: 0.0979 - dice_multi: 0.8447
Epoch 69/100
400/400 - 101s - loss: 0.0996 - dice_multi: 0.8400
Epoch 70/100
400/400 - 101s - loss: 0.1014 - dice_multi: 0.8436
Epoch 71/100
400/400 - 101s - loss: 0.1017 - dice_multi: 0.8483
Epoch 72/100
400/400 - 101s - loss: 0.1020 - dice_multi: 0.8502
Epoch 73/100
400/400 - 101s - loss: 0.1015 - dice_multi: 0.8521
Epoch 74/100
400/400 - 102s - loss: 0.1000 - dice_multi: 0.8390
Epoch 75/100
400/400 - 101s - loss: 0.0994 - dice_multi: 0.8425
Epoch 76/100
400/400 - 101s - loss: 0.1001 - dice_multi: 0.8407
Epoch 77/100
400/400 - 101s - loss: 0.1024 - dice_multi: 0.8466
Epoch 78/100
400/400 - 101s - loss: 0.1011 - dice_multi: 0.8379
Epoch 79/100
400/400 - 101s - loss: 0.1119 - dice_multi: 0.8257
Epoch 80/100
400/400 - 101s - loss: 0.0960 - dice_multi: 0.8553
Epoch 81/100
400/400 - 101s - loss: 0.0968 - dice_multi: 0.8496
Epoch 82/100
400/400 - 101s - loss: 0.0991 - dice_multi: 0.8446
Epoch 83/100
400/400 - 101s - loss: 0.0957 - dice_multi: 0.8435
Epoch 84/100
400/400 - 101s - loss: 0.0949 - dice_multi: 0.8493
Epoch 85/100
400/400 - 101s - loss: 0.0938 - dice_multi: 0.8495
Epoch 86/100
400/400 - 101s - loss: 0.0930 - dice_multi: 0.8479
Epoch 87/100
400/400 - 101s - loss: 0.0948 - dice_multi: 0.8585
Epoch 88/100
400/400 - 101s - loss: 0.0963 - dice_multi: 0.8565
Epoch 89/100
400/400 - 101s - loss: 0.0928 - dice_multi: 0.8477
Epoch 90/100
400/400 - 101s - loss: 0.0949 - dice_multi: 0.8539
Epoch 91/100
400/400 - 101s - loss: 0.0963 - dice_multi: 0.8505
Epoch 92/100
400/400 - 101s - loss: 0.0930 - dice_multi: 0.8479
Epoch 93/100
400/400 - 101s - loss: 0.0908 - dice_multi: 0.8567
Epoch 94/100
400/400 - 101s - loss: 0.0971 - dice_multi: 0.8437
Epoch 95/100
400/400 - 101s - loss: 0.0918 - dice_multi: 0.8527
Epoch 96/100
400/400 - 100s - loss: 0.0895 - dice_multi: 0.8546
Epoch 97/100
400/400 - 101s - loss: 0.0895 - dice_multi: 0.8474
Epoch 98/100
400/400 - 101s - loss: 0.0913 - dice_multi: 0.8553
Epoch 99/100
400/400 - 101s - loss: 0.0937 - dice_multi: 0.8557
Epoch 100/100
400/400 - 101s - loss: 0.0931 - dice_multi: 0.8567
training time: 10091.070039510727
executation time:143.61987705230712
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]
training set size:  30
testing set:  [30 31 32 33 34 35 36 37 38 39 40]
testing set size:  11
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 105s - loss: 0.6787 - dice_multi: 0.3951
Epoch 2/100
400/400 - 102s - loss: 0.5397 - dice_multi: 0.4628
Epoch 3/100
400/400 - 102s - loss: 0.4766 - dice_multi: 0.5151
Epoch 4/100
400/400 - 102s - loss: 0.4065 - dice_multi: 0.5656
Epoch 5/100
400/400 - 102s - loss: 0.3642 - dice_multi: 0.6086
Epoch 6/100
400/400 - 101s - loss: 0.3229 - dice_multi: 0.6442
Epoch 7/100
400/400 - 101s - loss: 0.2913 - dice_multi: 0.6774
Epoch 8/100
400/400 - 101s - loss: 0.2673 - dice_multi: 0.6991
Epoch 9/100
400/400 - 102s - loss: 0.2498 - dice_multi: 0.7143
Epoch 10/100
400/400 - 101s - loss: 0.2459 - dice_multi: 0.7203
Epoch 11/100
400/400 - 102s - loss: 0.2179 - dice_multi: 0.7488
Epoch 12/100
400/400 - 101s - loss: 0.2106 - dice_multi: 0.7546
Epoch 13/100
400/400 - 101s - loss: 0.2225 - dice_multi: 0.7483
Epoch 14/100
400/400 - 101s - loss: 0.1947 - dice_multi: 0.7682
Epoch 15/100
400/400 - 101s - loss: 0.1908 - dice_multi: 0.7783
Epoch 16/100
400/400 - 101s - loss: 0.1886 - dice_multi: 0.7833
Epoch 17/100
400/400 - 102s - loss: 0.1875 - dice_multi: 0.7816
Epoch 18/100
400/400 - 101s - loss: 0.1781 - dice_multi: 0.7890
Epoch 19/100
400/400 - 102s - loss: 0.1761 - dice_multi: 0.7950
Epoch 20/100
400/400 - 102s - loss: 0.1713 - dice_multi: 0.7987
Epoch 21/100
400/400 - 101s - loss: 0.1668 - dice_multi: 0.8016
Epoch 22/100
400/400 - 101s - loss: 0.1609 - dice_multi: 0.8043
Epoch 23/100
400/400 - 101s - loss: 0.1671 - dice_multi: 0.8026
Epoch 24/100
400/400 - 102s - loss: 0.1566 - dice_multi: 0.8097
Epoch 25/100
400/400 - 102s - loss: 0.1514 - dice_multi: 0.8169
Epoch 26/100
400/400 - 102s - loss: 0.1561 - dice_multi: 0.8121
Epoch 27/100
400/400 - 101s - loss: 0.1456 - dice_multi: 0.8227
Epoch 28/100
400/400 - 102s - loss: 0.1491 - dice_multi: 0.8215
Epoch 29/100
400/400 - 101s - loss: 0.1417 - dice_multi: 0.8212
Epoch 30/100
400/400 - 102s - loss: 0.1427 - dice_multi: 0.8284
Epoch 31/100
400/400 - 102s - loss: 0.1500 - dice_multi: 0.8159
Epoch 32/100
400/400 - 103s - loss: 0.1344 - dice_multi: 0.8259
Epoch 33/100
400/400 - 104s - loss: 0.1486 - dice_multi: 0.8167
Epoch 34/100
400/400 - 103s - loss: 0.1453 - dice_multi: 0.8266
Epoch 35/100
400/400 - 102s - loss: 0.1555 - dice_multi: 0.8151
Epoch 36/100
400/400 - 101s - loss: 0.1361 - dice_multi: 0.8315
Epoch 37/100
400/400 - 102s - loss: 0.1331 - dice_multi: 0.8378
Epoch 38/100
400/400 - 101s - loss: 0.1287 - dice_multi: 0.8414
Epoch 39/100
400/400 - 101s - loss: 0.1305 - dice_multi: 0.8364
Epoch 40/100
400/400 - 101s - loss: 0.1289 - dice_multi: 0.8349
Epoch 41/100
400/400 - 101s - loss: 0.1291 - dice_multi: 0.8336
Epoch 42/100
400/400 - 102s - loss: 0.1480 - dice_multi: 0.8225
Epoch 43/100
400/400 - 102s - loss: 0.1286 - dice_multi: 0.8370
Epoch 44/100
400/400 - 103s - loss: 0.1245 - dice_multi: 0.8324
Epoch 45/100
400/400 - 103s - loss: 0.1239 - dice_multi: 0.8438
Epoch 46/100
400/400 - 102s - loss: 0.1248 - dice_multi: 0.8415
Epoch 47/100
400/400 - 102s - loss: 0.1441 - dice_multi: 0.8270
Epoch 48/100
400/400 - 104s - loss: 0.1252 - dice_multi: 0.8404
Epoch 49/100
400/400 - 103s - loss: 0.1227 - dice_multi: 0.8454
Epoch 50/100
400/400 - 101s - loss: 0.1197 - dice_multi: 0.8523
Epoch 51/100
400/400 - 101s - loss: 0.1241 - dice_multi: 0.8384
Epoch 52/100
400/400 - 102s - loss: 0.1217 - dice_multi: 0.8479
Epoch 53/100
400/400 - 101s - loss: 0.1219 - dice_multi: 0.8495
Epoch 54/100
400/400 - 101s - loss: 0.1227 - dice_multi: 0.8378
Epoch 55/100
400/400 - 101s - loss: 0.1185 - dice_multi: 0.8502
Epoch 56/100
400/400 - 101s - loss: 0.1212 - dice_multi: 0.8460
Epoch 57/100
400/400 - 101s - loss: 0.1210 - dice_multi: 0.8492
Epoch 58/100
400/400 - 101s - loss: 0.1250 - dice_multi: 0.8420
Epoch 59/100
400/400 - 101s - loss: 0.1172 - dice_multi: 0.8429
Epoch 60/100
400/400 - 101s - loss: 0.1126 - dice_multi: 0.8538
Epoch 61/100
400/400 - 101s - loss: 0.1153 - dice_multi: 0.8547
Epoch 62/100
400/400 - 101s - loss: 0.1175 - dice_multi: 0.8517
Epoch 63/100
400/400 - 102s - loss: 0.1129 - dice_multi: 0.8567
Epoch 64/100
400/400 - 102s - loss: 0.1231 - dice_multi: 0.8532
Epoch 65/100
400/400 - 102s - loss: 0.1129 - dice_multi: 0.8558
Epoch 66/100
400/400 - 101s - loss: 0.1378 - dice_multi: 0.8356
Epoch 67/100
400/400 - 101s - loss: 0.1173 - dice_multi: 0.8488
Epoch 68/100
400/400 - 100s - loss: 0.1106 - dice_multi: 0.8529
Epoch 69/100
400/400 - 101s - loss: 0.1100 - dice_multi: 0.8524
Epoch 70/100
400/400 - 101s - loss: 0.1115 - dice_multi: 0.8550
Epoch 71/100
400/400 - 101s - loss: 0.1182 - dice_multi: 0.8493
Epoch 72/100
400/400 - 101s - loss: 0.1102 - dice_multi: 0.8601
Epoch 73/100
400/400 - 101s - loss: 0.1098 - dice_multi: 0.8646
Epoch 74/100
400/400 - 100s - loss: 0.1095 - dice_multi: 0.8595
Epoch 75/100
400/400 - 101s - loss: 0.1144 - dice_multi: 0.8540
Epoch 76/100
400/400 - 101s - loss: 0.1116 - dice_multi: 0.8577
Epoch 77/100
400/400 - 101s - loss: 0.1080 - dice_multi: 0.8612
Epoch 78/100
400/400 - 101s - loss: 0.1071 - dice_multi: 0.8615
Epoch 79/100
400/400 - 101s - loss: 0.1108 - dice_multi: 0.8636
Epoch 80/100
400/400 - 101s - loss: 0.1113 - dice_multi: 0.8626
Epoch 81/100
400/400 - 101s - loss: 0.1080 - dice_multi: 0.8692
Epoch 82/100
400/400 - 101s - loss: 0.1102 - dice_multi: 0.8569
Epoch 83/100
400/400 - 101s - loss: 0.1083 - dice_multi: 0.8626
Epoch 84/100
400/400 - 101s - loss: 0.1050 - dice_multi: 0.8605
Epoch 85/100
400/400 - 103s - loss: 0.1044 - dice_multi: 0.8643
Epoch 86/100
400/400 - 103s - loss: 0.1168 - dice_multi: 0.8558
Epoch 87/100
400/400 - 101s - loss: 0.1228 - dice_multi: 0.8510
Epoch 88/100
400/400 - 101s - loss: 0.1069 - dice_multi: 0.8604
Epoch 89/100
400/400 - 101s - loss: 0.1049 - dice_multi: 0.8650
Epoch 90/100
400/400 - 101s - loss: 0.1057 - dice_multi: 0.8619
Epoch 91/100
400/400 - 101s - loss: 0.1057 - dice_multi: 0.8658
Epoch 92/100
400/400 - 101s - loss: 0.1038 - dice_multi: 0.8642
Epoch 93/100
400/400 - 101s - loss: 0.1026 - dice_multi: 0.8597
Epoch 94/100
400/400 - 101s - loss: 0.1046 - dice_multi: 0.8694
Epoch 95/100
400/400 - 101s - loss: 0.1044 - dice_multi: 0.8648
Epoch 96/100
400/400 - 101s - loss: 0.1014 - dice_multi: 0.8684
Epoch 97/100
400/400 - 101s - loss: 0.1028 - dice_multi: 0.8655
Epoch 98/100
400/400 - 101s - loss: 0.1015 - dice_multi: 0.8667
Epoch 99/100
400/400 - 101s - loss: 0.1044 - dice_multi: 0.8593
Epoch 100/100
400/400 - 101s - loss: 0.1035 - dice_multi: 0.8720
training time: 10159.15747833252
executation time:146.75244675983083
[0.9928501  0.9353931  0.8206956  0.89312166 0.8313549  0.90013456
 0.9006476 ]
