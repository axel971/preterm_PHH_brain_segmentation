Loading tensorflow/2.5
  Loading requirement: cuda11.2/toolkit/11.2.2 cudnn8.1-cuda11.2/8.1.1.33
    hdf5_18/1.8.20
run_bayesian_U-Net
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2021-09-22 03:34:57.524502: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(41, 256, 128, 256)
..loading data finished Wed Sep 22 03:35:24 2021
2021-09-22 03:35:24.404292: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-09-22 03:35:24.457644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-22 03:35:24.457688: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-22 03:35:24.464545: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-22 03:35:24.464619: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-09-22 03:35:24.467315: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-09-22 03:35:24.467952: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-09-22 03:35:24.468839: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-09-22 03:35:24.470034: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-09-22 03:35:24.470502: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-22 03:35:24.474355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-22 03:35:24.479224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-22 03:35:24.483063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-22 03:35:24.483101: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-22 03:35:24.965060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-22 03:35:24.965106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-09-22 03:35:24.965117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-09-22 03:35:24.970723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38184 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:3b:00.0, compute capability: 8.0)
---------fold--1---------
training set:  [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [0 1 2 3 4 5 6 7 8 9]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
2021-09-22 03:35:27.891986: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-09-22 03:35:27.892516: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2100000000 Hz
2021-09-22 03:35:30.465523: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-22 03:35:31.412928: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2021-09-22 03:35:32.469045: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-22 03:35:33.335762: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 132s - loss: 0.6732 - dice_multi: 0.3800
Epoch 2/100
400/400 - 101s - loss: 0.5161 - dice_multi: 0.4636
Epoch 3/100
400/400 - 101s - loss: 0.4398 - dice_multi: 0.5128
Epoch 4/100
400/400 - 101s - loss: 0.3708 - dice_multi: 0.5783
Epoch 5/100
400/400 - 101s - loss: 0.3104 - dice_multi: 0.6210
Epoch 6/100
400/400 - 101s - loss: 0.2846 - dice_multi: 0.6632
Epoch 7/100
400/400 - 100s - loss: 0.2513 - dice_multi: 0.6904
Epoch 8/100
400/400 - 101s - loss: 0.2380 - dice_multi: 0.7051
Epoch 9/100
400/400 - 100s - loss: 0.2112 - dice_multi: 0.7299
Epoch 10/100
400/400 - 101s - loss: 0.1955 - dice_multi: 0.7443
Epoch 11/100
400/400 - 100s - loss: 0.1901 - dice_multi: 0.7559
Epoch 12/100
400/400 - 101s - loss: 0.1730 - dice_multi: 0.7812
Epoch 13/100
400/400 - 100s - loss: 0.1706 - dice_multi: 0.7814
Epoch 14/100
400/400 - 100s - loss: 0.1663 - dice_multi: 0.7768
Epoch 15/100
400/400 - 101s - loss: 0.1571 - dice_multi: 0.7920
Epoch 16/100
400/400 - 100s - loss: 0.1496 - dice_multi: 0.8017
Epoch 17/100
400/400 - 100s - loss: 0.1498 - dice_multi: 0.8069
Epoch 18/100
400/400 - 100s - loss: 0.1484 - dice_multi: 0.7953
Epoch 19/100
400/400 - 100s - loss: 0.1381 - dice_multi: 0.8198
Epoch 20/100
400/400 - 101s - loss: 0.1655 - dice_multi: 0.7864
Epoch 21/100
400/400 - 100s - loss: 0.1546 - dice_multi: 0.7940
Epoch 22/100
400/400 - 100s - loss: 0.1304 - dice_multi: 0.8224
Epoch 23/100
400/400 - 100s - loss: 0.1343 - dice_multi: 0.8221
Epoch 24/100
400/400 - 100s - loss: 0.1240 - dice_multi: 0.8279
Epoch 25/100
400/400 - 100s - loss: 0.1278 - dice_multi: 0.8307
Epoch 26/100
400/400 - 100s - loss: 0.1286 - dice_multi: 0.8277
Epoch 27/100
400/400 - 100s - loss: 0.1231 - dice_multi: 0.8335
Epoch 28/100
400/400 - 100s - loss: 0.1252 - dice_multi: 0.8277
Epoch 29/100
400/400 - 100s - loss: 0.1252 - dice_multi: 0.8325
Epoch 30/100
400/400 - 100s - loss: 0.1231 - dice_multi: 0.8314
Epoch 31/100
400/400 - 100s - loss: 0.1202 - dice_multi: 0.8446
Epoch 32/100
400/400 - 100s - loss: 0.1575 - dice_multi: 0.8006
Epoch 33/100
400/400 - 100s - loss: 0.1238 - dice_multi: 0.8328
Epoch 34/100
400/400 - 100s - loss: 0.1160 - dice_multi: 0.8364
Epoch 35/100
400/400 - 100s - loss: 0.1136 - dice_multi: 0.8351
Epoch 36/100
400/400 - 100s - loss: 0.1104 - dice_multi: 0.8465
Epoch 37/100
400/400 - 100s - loss: 0.1114 - dice_multi: 0.8502
Epoch 38/100
400/400 - 100s - loss: 0.1089 - dice_multi: 0.8471
Epoch 39/100
400/400 - 100s - loss: 0.1085 - dice_multi: 0.8480
Epoch 40/100
400/400 - 100s - loss: 0.1108 - dice_multi: 0.8555
Epoch 41/100
400/400 - 100s - loss: 0.1312 - dice_multi: 0.8334
Epoch 42/100
400/400 - 100s - loss: 0.1213 - dice_multi: 0.8325
Epoch 43/100
400/400 - 100s - loss: 0.1072 - dice_multi: 0.8454
Epoch 44/100
400/400 - 100s - loss: 0.1035 - dice_multi: 0.8516
Epoch 45/100
400/400 - 100s - loss: 0.1045 - dice_multi: 0.8458
Epoch 46/100
400/400 - 100s - loss: 0.1051 - dice_multi: 0.8509
Epoch 47/100
400/400 - 101s - loss: 0.1090 - dice_multi: 0.8464
Epoch 48/100
400/400 - 101s - loss: 0.1059 - dice_multi: 0.8514
Epoch 49/100
400/400 - 100s - loss: 0.1042 - dice_multi: 0.8514
Epoch 50/100
400/400 - 100s - loss: 0.1054 - dice_multi: 0.8623
Epoch 51/100
400/400 - 100s - loss: 0.1252 - dice_multi: 0.8354
Epoch 52/100
400/400 - 100s - loss: 0.1041 - dice_multi: 0.8534
Epoch 53/100
400/400 - 101s - loss: 0.1020 - dice_multi: 0.8582
Epoch 54/100
400/400 - 100s - loss: 0.0998 - dice_multi: 0.8592
Epoch 55/100
400/400 - 100s - loss: 0.1014 - dice_multi: 0.8515
Epoch 56/100
400/400 - 100s - loss: 0.1029 - dice_multi: 0.8648
Epoch 57/100
400/400 - 100s - loss: 0.1024 - dice_multi: 0.8556
Epoch 58/100
400/400 - 100s - loss: 0.1291 - dice_multi: 0.8341
Epoch 59/100
400/400 - 100s - loss: 0.1030 - dice_multi: 0.8544
Epoch 60/100
400/400 - 100s - loss: 0.1013 - dice_multi: 0.8619
Epoch 61/100
400/400 - 100s - loss: 0.1000 - dice_multi: 0.8570
Epoch 62/100
400/400 - 100s - loss: 0.0968 - dice_multi: 0.8588
Epoch 63/100
400/400 - 100s - loss: 0.0960 - dice_multi: 0.8647
Epoch 64/100
400/400 - 100s - loss: 0.0983 - dice_multi: 0.8689
Epoch 65/100
400/400 - 101s - loss: 0.0965 - dice_multi: 0.8664
Epoch 66/100
400/400 - 101s - loss: 0.0950 - dice_multi: 0.8545
Epoch 67/100
400/400 - 100s - loss: 0.0983 - dice_multi: 0.8627
Epoch 68/100
400/400 - 101s - loss: 0.0971 - dice_multi: 0.8621
Epoch 69/100
400/400 - 101s - loss: 0.0952 - dice_multi: 0.8611
Epoch 70/100
400/400 - 101s - loss: 0.1046 - dice_multi: 0.8588
Epoch 71/100
400/400 - 101s - loss: 0.0959 - dice_multi: 0.8609
Epoch 72/100
400/400 - 102s - loss: 0.0962 - dice_multi: 0.8616
Epoch 73/100
400/400 - 102s - loss: 0.0937 - dice_multi: 0.8655
Epoch 74/100
400/400 - 102s - loss: 0.0927 - dice_multi: 0.8662
Epoch 75/100
400/400 - 102s - loss: 0.0953 - dice_multi: 0.8664
Epoch 76/100
400/400 - 102s - loss: 0.0935 - dice_multi: 0.8713
Epoch 77/100
400/400 - 102s - loss: 0.0909 - dice_multi: 0.8669
Epoch 78/100
400/400 - 102s - loss: 0.0946 - dice_multi: 0.8710
Epoch 79/100
400/400 - 101s - loss: 0.0928 - dice_multi: 0.8721
Epoch 80/100
400/400 - 102s - loss: 0.1373 - dice_multi: 0.8352
Epoch 81/100
400/400 - 102s - loss: 0.1026 - dice_multi: 0.8599
Epoch 82/100
400/400 - 101s - loss: 0.0946 - dice_multi: 0.8612
Epoch 83/100
400/400 - 102s - loss: 0.0917 - dice_multi: 0.8678
Epoch 84/100
400/400 - 102s - loss: 0.0895 - dice_multi: 0.8679
Epoch 85/100
400/400 - 102s - loss: 0.0914 - dice_multi: 0.8667
Epoch 86/100
400/400 - 102s - loss: 0.0908 - dice_multi: 0.8676
Epoch 87/100
400/400 - 102s - loss: 0.0915 - dice_multi: 0.8724
Epoch 88/100
400/400 - 102s - loss: 0.0891 - dice_multi: 0.8770
Epoch 89/100
400/400 - 102s - loss: 0.0894 - dice_multi: 0.8698
Epoch 90/100
400/400 - 102s - loss: 0.0916 - dice_multi: 0.8626
Epoch 91/100
400/400 - 102s - loss: 0.0889 - dice_multi: 0.8681
Epoch 92/100
400/400 - 102s - loss: 0.0894 - dice_multi: 0.8755
Epoch 93/100
400/400 - 102s - loss: 0.0891 - dice_multi: 0.8733
Epoch 94/100
400/400 - 102s - loss: 0.0875 - dice_multi: 0.8696
Epoch 95/100
400/400 - 102s - loss: 0.0879 - dice_multi: 0.8741
Epoch 96/100
400/400 - 102s - loss: 0.0884 - dice_multi: 0.8791
Epoch 97/100
400/400 - 103s - loss: 0.0875 - dice_multi: 0.8729
Epoch 98/100
400/400 - 102s - loss: 0.0878 - dice_multi: 0.8703
Epoch 99/100
400/400 - 102s - loss: 0.0913 - dice_multi: 0.8669
Epoch 100/100
400/400 - 102s - loss: 0.0878 - dice_multi: 0.8783
2021-09-22 06:24:10.778896: I tensorflow/stream_executor/cuda/cuda_blas.cc:1839] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
training time: 10117.155699968338
executation time:143.2495706319809
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [10 11 12 13 14 15 16 17 18 19]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 101s - loss: 0.6773 - dice_multi: 0.3693
Epoch 2/100
400/400 - 99s - loss: 0.5069 - dice_multi: 0.4412
Epoch 3/100
400/400 - 99s - loss: 0.4368 - dice_multi: 0.5005
Epoch 4/100
400/400 - 99s - loss: 0.3752 - dice_multi: 0.5453
Epoch 5/100
400/400 - 99s - loss: 0.3416 - dice_multi: 0.5844
Epoch 6/100
400/400 - 98s - loss: 0.3054 - dice_multi: 0.6265
Epoch 7/100
400/400 - 99s - loss: 0.2786 - dice_multi: 0.6608
Epoch 8/100
400/400 - 99s - loss: 0.2486 - dice_multi: 0.6861
Epoch 9/100
400/400 - 99s - loss: 0.2287 - dice_multi: 0.7035
Epoch 10/100
400/400 - 99s - loss: 0.2285 - dice_multi: 0.7093
Epoch 11/100
400/400 - 99s - loss: 0.2043 - dice_multi: 0.7334
Epoch 12/100
400/400 - 98s - loss: 0.1930 - dice_multi: 0.7363
Epoch 13/100
400/400 - 99s - loss: 0.1812 - dice_multi: 0.7606
Epoch 14/100
400/400 - 98s - loss: 0.1701 - dice_multi: 0.7702
Epoch 15/100
400/400 - 99s - loss: 0.1770 - dice_multi: 0.7684
Epoch 16/100
400/400 - 99s - loss: 0.1723 - dice_multi: 0.7687
Epoch 17/100
400/400 - 99s - loss: 0.1664 - dice_multi: 0.7789
Epoch 18/100
400/400 - 99s - loss: 0.1509 - dice_multi: 0.7991
Epoch 19/100
400/400 - 99s - loss: 0.1620 - dice_multi: 0.7852
Epoch 20/100
400/400 - 99s - loss: 0.1557 - dice_multi: 0.7884
Epoch 21/100
400/400 - 99s - loss: 0.1473 - dice_multi: 0.8033
Epoch 22/100
400/400 - 99s - loss: 0.1432 - dice_multi: 0.7902
Epoch 23/100
400/400 - 99s - loss: 0.1499 - dice_multi: 0.8005
Epoch 24/100
400/400 - 99s - loss: 0.1557 - dice_multi: 0.7859
Epoch 25/100
400/400 - 99s - loss: 0.1313 - dice_multi: 0.8125
Epoch 26/100
400/400 - 99s - loss: 0.1416 - dice_multi: 0.8035
Epoch 27/100
400/400 - 98s - loss: 0.1312 - dice_multi: 0.8032
Epoch 28/100
400/400 - 98s - loss: 0.1296 - dice_multi: 0.8191
Epoch 29/100
400/400 - 99s - loss: 0.1414 - dice_multi: 0.7980
Epoch 30/100
400/400 - 99s - loss: 0.1290 - dice_multi: 0.8170
Epoch 31/100
400/400 - 99s - loss: 0.1229 - dice_multi: 0.8260
Epoch 32/100
400/400 - 98s - loss: 0.1250 - dice_multi: 0.8274
Epoch 33/100
400/400 - 99s - loss: 0.1215 - dice_multi: 0.8311
Epoch 34/100
400/400 - 99s - loss: 0.1309 - dice_multi: 0.8106
Epoch 35/100
400/400 - 99s - loss: 0.1238 - dice_multi: 0.8253
Epoch 36/100
400/400 - 99s - loss: 0.1192 - dice_multi: 0.8266
Epoch 37/100
400/400 - 99s - loss: 0.1173 - dice_multi: 0.8296
Epoch 38/100
400/400 - 99s - loss: 0.1187 - dice_multi: 0.8241
Epoch 39/100
400/400 - 99s - loss: 0.1137 - dice_multi: 0.8365
Epoch 40/100
400/400 - 99s - loss: 0.1490 - dice_multi: 0.7863
Epoch 41/100
400/400 - 99s - loss: 0.1150 - dice_multi: 0.8332
Epoch 42/100
400/400 - 99s - loss: 0.1159 - dice_multi: 0.8307
Epoch 43/100
400/400 - 99s - loss: 0.1166 - dice_multi: 0.8334
Epoch 44/100
400/400 - 99s - loss: 0.1118 - dice_multi: 0.8339
Epoch 45/100
400/400 - 99s - loss: 0.1109 - dice_multi: 0.8359
Epoch 46/100
400/400 - 99s - loss: 0.1109 - dice_multi: 0.8413
Epoch 47/100
400/400 - 99s - loss: 0.1088 - dice_multi: 0.8346
Epoch 48/100
400/400 - 99s - loss: 0.1090 - dice_multi: 0.8432
Epoch 49/100
400/400 - 99s - loss: 0.1080 - dice_multi: 0.8404
Epoch 50/100
400/400 - 99s - loss: 0.1081 - dice_multi: 0.8396
Epoch 51/100
400/400 - 99s - loss: 0.1123 - dice_multi: 0.8333
Epoch 52/100
400/400 - 99s - loss: 0.1066 - dice_multi: 0.8530
Epoch 53/100
400/400 - 99s - loss: 0.1052 - dice_multi: 0.8426
Epoch 54/100
400/400 - 99s - loss: 0.1135 - dice_multi: 0.8392
Epoch 55/100
400/400 - 99s - loss: 0.1114 - dice_multi: 0.8409
Epoch 56/100
400/400 - 100s - loss: 0.1020 - dice_multi: 0.8410
Epoch 57/100
400/400 - 100s - loss: 0.1102 - dice_multi: 0.8412
Epoch 58/100
400/400 - 100s - loss: 0.1068 - dice_multi: 0.8449
Epoch 59/100
400/400 - 100s - loss: 0.1074 - dice_multi: 0.8469
Epoch 60/100
400/400 - 100s - loss: 0.1015 - dice_multi: 0.8430
Epoch 61/100
400/400 - 101s - loss: 0.1027 - dice_multi: 0.8503
Epoch 62/100
400/400 - 100s - loss: 0.1022 - dice_multi: 0.8457
Epoch 63/100
400/400 - 100s - loss: 0.1017 - dice_multi: 0.8497
Epoch 64/100
400/400 - 100s - loss: 0.1003 - dice_multi: 0.8513
Epoch 65/100
400/400 - 100s - loss: 0.1005 - dice_multi: 0.8552
Epoch 66/100
400/400 - 100s - loss: 0.0991 - dice_multi: 0.8479
Epoch 67/100
400/400 - 100s - loss: 0.1074 - dice_multi: 0.8401
Epoch 68/100
400/400 - 100s - loss: 0.0976 - dice_multi: 0.8539
Epoch 69/100
400/400 - 100s - loss: 0.0969 - dice_multi: 0.8562
Epoch 70/100
400/400 - 100s - loss: 0.0993 - dice_multi: 0.8515
Epoch 71/100
400/400 - 100s - loss: 0.0989 - dice_multi: 0.8475
Epoch 72/100
400/400 - 100s - loss: 0.1005 - dice_multi: 0.8556
Epoch 73/100
400/400 - 100s - loss: 0.0982 - dice_multi: 0.8630
Epoch 74/100
400/400 - 100s - loss: 0.1141 - dice_multi: 0.8429
Epoch 75/100
400/400 - 100s - loss: 0.0998 - dice_multi: 0.8448
Epoch 76/100
400/400 - 100s - loss: 0.0945 - dice_multi: 0.8527
Epoch 77/100
400/400 - 100s - loss: 0.0974 - dice_multi: 0.8646
Epoch 78/100
400/400 - 100s - loss: 0.0995 - dice_multi: 0.8549
Epoch 79/100
400/400 - 100s - loss: 0.0984 - dice_multi: 0.8530
Epoch 80/100
400/400 - 100s - loss: 0.0950 - dice_multi: 0.8589
Epoch 81/100
400/400 - 100s - loss: 0.0947 - dice_multi: 0.8575
Epoch 82/100
400/400 - 100s - loss: 0.0948 - dice_multi: 0.8568
Epoch 83/100
400/400 - 100s - loss: 0.0951 - dice_multi: 0.8546
Epoch 84/100
400/400 - 101s - loss: 0.1170 - dice_multi: 0.8379
Epoch 85/100
400/400 - 100s - loss: 0.0964 - dice_multi: 0.8495
Epoch 86/100
400/400 - 100s - loss: 0.0934 - dice_multi: 0.8576
Epoch 87/100
400/400 - 100s - loss: 0.0941 - dice_multi: 0.8606
Epoch 88/100
400/400 - 100s - loss: 0.0945 - dice_multi: 0.8570
Epoch 89/100
400/400 - 99s - loss: 0.0943 - dice_multi: 0.8604
Epoch 90/100
400/400 - 100s - loss: 0.0924 - dice_multi: 0.8672
Epoch 91/100
400/400 - 100s - loss: 0.0924 - dice_multi: 0.8602
Epoch 92/100
400/400 - 100s - loss: 0.0939 - dice_multi: 0.8646
Epoch 93/100
400/400 - 100s - loss: 0.1136 - dice_multi: 0.8365
Epoch 94/100
400/400 - 100s - loss: 0.0944 - dice_multi: 0.8556
Epoch 95/100
400/400 - 100s - loss: 0.0916 - dice_multi: 0.8560
Epoch 96/100
400/400 - 100s - loss: 0.0906 - dice_multi: 0.8580
Epoch 97/100
400/400 - 100s - loss: 0.0911 - dice_multi: 0.8684
Epoch 98/100
400/400 - 100s - loss: 0.1006 - dice_multi: 0.8506
Epoch 99/100
400/400 - 100s - loss: 0.0931 - dice_multi: 0.8649
Epoch 100/100
400/400 - 100s - loss: 0.0907 - dice_multi: 0.8637
training time: 9944.966072559357
executation time:143.6839230298996
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [20 21 22 23 24 25 26 27 28 29]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 101s - loss: 0.6691 - dice_multi: 0.3499
Epoch 2/100
400/400 - 99s - loss: 0.5234 - dice_multi: 0.4180
Epoch 3/100
400/400 - 99s - loss: 0.4520 - dice_multi: 0.4648
Epoch 4/100
400/400 - 99s - loss: 0.4114 - dice_multi: 0.5019
Epoch 5/100
400/400 - 99s - loss: 0.3580 - dice_multi: 0.5477
Epoch 6/100
400/400 - 99s - loss: 0.3281 - dice_multi: 0.5848
Epoch 7/100
400/400 - 99s - loss: 0.3005 - dice_multi: 0.6216
Epoch 8/100
400/400 - 99s - loss: 0.2676 - dice_multi: 0.6435
Epoch 9/100
400/400 - 100s - loss: 0.2484 - dice_multi: 0.6839
Epoch 10/100
400/400 - 98s - loss: 0.2349 - dice_multi: 0.6952
Epoch 11/100
400/400 - 99s - loss: 0.2165 - dice_multi: 0.7009
Epoch 12/100
400/400 - 99s - loss: 0.2101 - dice_multi: 0.7124
Epoch 13/100
400/400 - 99s - loss: 0.1961 - dice_multi: 0.7307
Epoch 14/100
400/400 - 99s - loss: 0.1818 - dice_multi: 0.7413
Epoch 15/100
400/400 - 99s - loss: 0.1820 - dice_multi: 0.7547
Epoch 16/100
400/400 - 99s - loss: 0.1663 - dice_multi: 0.7667
Epoch 17/100
400/400 - 99s - loss: 0.1652 - dice_multi: 0.7610
Epoch 18/100
400/400 - 99s - loss: 0.1642 - dice_multi: 0.7699
Epoch 19/100
400/400 - 99s - loss: 0.1657 - dice_multi: 0.7663
Epoch 20/100
400/400 - 99s - loss: 0.1481 - dice_multi: 0.7900
Epoch 21/100
400/400 - 99s - loss: 0.1568 - dice_multi: 0.7848
Epoch 22/100
400/400 - 99s - loss: 0.1424 - dice_multi: 0.7961
Epoch 23/100
400/400 - 99s - loss: 0.1385 - dice_multi: 0.7948
Epoch 24/100
400/400 - 100s - loss: 0.1577 - dice_multi: 0.7832
Epoch 25/100
400/400 - 100s - loss: 0.1347 - dice_multi: 0.7999
Epoch 26/100
400/400 - 100s - loss: 0.1359 - dice_multi: 0.8079
Epoch 27/100
400/400 - 100s - loss: 0.1486 - dice_multi: 0.7941
Epoch 28/100
400/400 - 100s - loss: 0.1301 - dice_multi: 0.8092
Epoch 29/100
400/400 - 100s - loss: 0.1288 - dice_multi: 0.8120
Epoch 30/100
400/400 - 100s - loss: 0.1335 - dice_multi: 0.8132
Epoch 31/100
400/400 - 100s - loss: 0.1302 - dice_multi: 0.8126
Epoch 32/100
400/400 - 100s - loss: 0.1334 - dice_multi: 0.8069
Epoch 33/100
400/400 - 100s - loss: 0.1209 - dice_multi: 0.8160
Epoch 34/100
400/400 - 100s - loss: 0.1287 - dice_multi: 0.8259
Epoch 35/100
400/400 - 100s - loss: 0.1237 - dice_multi: 0.8179
Epoch 36/100
400/400 - 101s - loss: 0.1168 - dice_multi: 0.8199
Epoch 37/100
400/400 - 100s - loss: 0.1318 - dice_multi: 0.8098
Epoch 38/100
400/400 - 100s - loss: 0.1192 - dice_multi: 0.8211
Epoch 39/100
400/400 - 100s - loss: 0.1152 - dice_multi: 0.8300
Epoch 40/100
400/400 - 100s - loss: 0.1234 - dice_multi: 0.8287
Epoch 41/100
400/400 - 101s - loss: 0.1296 - dice_multi: 0.8203
Epoch 42/100
400/400 - 100s - loss: 0.1158 - dice_multi: 0.8284
Epoch 43/100
400/400 - 101s - loss: 0.1075 - dice_multi: 0.8301
Epoch 44/100
400/400 - 101s - loss: 0.1125 - dice_multi: 0.8319
Epoch 45/100
400/400 - 100s - loss: 0.1277 - dice_multi: 0.8171
Epoch 46/100
400/400 - 101s - loss: 0.1125 - dice_multi: 0.8281
Epoch 47/100
400/400 - 100s - loss: 0.1088 - dice_multi: 0.8387
Epoch 48/100
400/400 - 100s - loss: 0.1080 - dice_multi: 0.8364
Epoch 49/100
400/400 - 100s - loss: 0.1104 - dice_multi: 0.8277
Epoch 50/100
400/400 - 101s - loss: 0.1133 - dice_multi: 0.8296
Epoch 51/100
400/400 - 100s - loss: 0.1121 - dice_multi: 0.8299
Epoch 52/100
400/400 - 100s - loss: 0.1084 - dice_multi: 0.8393
Epoch 53/100
400/400 - 100s - loss: 0.1039 - dice_multi: 0.8473
Epoch 54/100
400/400 - 100s - loss: 0.1072 - dice_multi: 0.8418
Epoch 55/100
400/400 - 100s - loss: 0.1040 - dice_multi: 0.8365
Epoch 56/100
400/400 - 101s - loss: 0.1015 - dice_multi: 0.8431
Epoch 57/100
400/400 - 101s - loss: 0.1045 - dice_multi: 0.8395
Epoch 58/100
400/400 - 100s - loss: 0.1048 - dice_multi: 0.8417
Epoch 59/100
400/400 - 100s - loss: 0.1052 - dice_multi: 0.8357
Epoch 60/100
400/400 - 101s - loss: 0.1037 - dice_multi: 0.8377
Epoch 61/100
400/400 - 100s - loss: 0.1043 - dice_multi: 0.8441
Epoch 62/100
400/400 - 101s - loss: 0.1152 - dice_multi: 0.8253
Epoch 63/100
400/400 - 100s - loss: 0.1104 - dice_multi: 0.8319
Epoch 64/100
400/400 - 101s - loss: 0.1037 - dice_multi: 0.8454
Epoch 65/100
400/400 - 101s - loss: 0.0993 - dice_multi: 0.8428
Epoch 66/100
400/400 - 100s - loss: 0.0961 - dice_multi: 0.8410
Epoch 67/100
400/400 - 100s - loss: 0.0987 - dice_multi: 0.8482
Epoch 68/100
400/400 - 101s - loss: 0.0967 - dice_multi: 0.8537
Epoch 69/100
400/400 - 101s - loss: 0.0991 - dice_multi: 0.8494
Epoch 70/100
400/400 - 100s - loss: 0.0967 - dice_multi: 0.8502
Epoch 71/100
400/400 - 100s - loss: 0.1001 - dice_multi: 0.8468
Epoch 72/100
400/400 - 100s - loss: 0.1011 - dice_multi: 0.8557
Epoch 73/100
400/400 - 101s - loss: 0.1116 - dice_multi: 0.8366
Epoch 74/100
400/400 - 100s - loss: 0.0970 - dice_multi: 0.8442
Epoch 75/100
400/400 - 101s - loss: 0.0968 - dice_multi: 0.8515
Epoch 76/100
400/400 - 101s - loss: 0.0961 - dice_multi: 0.8520
Epoch 77/100
400/400 - 100s - loss: 0.0944 - dice_multi: 0.8526
Epoch 78/100
400/400 - 100s - loss: 0.0975 - dice_multi: 0.8545
Epoch 79/100
400/400 - 100s - loss: 0.0930 - dice_multi: 0.8491
Epoch 80/100
400/400 - 100s - loss: 0.0932 - dice_multi: 0.8464
Epoch 81/100
400/400 - 101s - loss: 0.0983 - dice_multi: 0.8508
Epoch 82/100
400/400 - 100s - loss: 0.1013 - dice_multi: 0.8389
Epoch 83/100
400/400 - 100s - loss: 0.0975 - dice_multi: 0.8439
Epoch 84/100
400/400 - 100s - loss: 0.0944 - dice_multi: 0.8527
Epoch 85/100
400/400 - 100s - loss: 0.0920 - dice_multi: 0.8473
Epoch 86/100
400/400 - 100s - loss: 0.0956 - dice_multi: 0.8536
Epoch 87/100
400/400 - 100s - loss: 0.0909 - dice_multi: 0.8569
Epoch 88/100
400/400 - 100s - loss: 0.1094 - dice_multi: 0.8396
Epoch 89/100
400/400 - 100s - loss: 0.1012 - dice_multi: 0.8421
Epoch 90/100
400/400 - 100s - loss: 0.0931 - dice_multi: 0.8543
Epoch 91/100
400/400 - 100s - loss: 0.0919 - dice_multi: 0.8598
Epoch 92/100
400/400 - 100s - loss: 0.0922 - dice_multi: 0.8617
Epoch 93/100
400/400 - 101s - loss: 0.0915 - dice_multi: 0.8531
Epoch 94/100
400/400 - 100s - loss: 0.0912 - dice_multi: 0.8574
Epoch 95/100
400/400 - 100s - loss: 0.0901 - dice_multi: 0.8599
Epoch 96/100
400/400 - 100s - loss: 0.0909 - dice_multi: 0.8637
Epoch 97/100
400/400 - 100s - loss: 0.0903 - dice_multi: 0.8546
Epoch 98/100
400/400 - 100s - loss: 0.0921 - dice_multi: 0.8603
Epoch 99/100
400/400 - 100s - loss: 0.0894 - dice_multi: 0.8599
Epoch 100/100
400/400 - 100s - loss: 0.0867 - dice_multi: 0.8556
training time: 10011.475242376328
executation time:145.39982736110687
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]
training set size:  30
testing set:  [30 31 32 33 34 35 36 37 38 39 40]
testing set size:  11
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 101s - loss: 0.7086 - dice_multi: 0.3900
Epoch 2/100
400/400 - 101s - loss: 0.5474 - dice_multi: 0.4661
Epoch 3/100
400/400 - 101s - loss: 0.4735 - dice_multi: 0.5130
Epoch 4/100
400/400 - 101s - loss: 0.4223 - dice_multi: 0.5641
Epoch 5/100
400/400 - 102s - loss: 0.3510 - dice_multi: 0.6186
Epoch 6/100
400/400 - 102s - loss: 0.3175 - dice_multi: 0.6563
Epoch 7/100
400/400 - 102s - loss: 0.2908 - dice_multi: 0.6828
Epoch 8/100
400/400 - 102s - loss: 0.2644 - dice_multi: 0.7018
Epoch 9/100
400/400 - 101s - loss: 0.2381 - dice_multi: 0.7324
Epoch 10/100
400/400 - 101s - loss: 0.2244 - dice_multi: 0.7473
Epoch 11/100
400/400 - 101s - loss: 0.2131 - dice_multi: 0.7617
Epoch 12/100
400/400 - 103s - loss: 0.1900 - dice_multi: 0.7709
Epoch 13/100
400/400 - 102s - loss: 0.1917 - dice_multi: 0.7724
Epoch 14/100
400/400 - 101s - loss: 0.1830 - dice_multi: 0.7794
Epoch 15/100
400/400 - 102s - loss: 0.1800 - dice_multi: 0.7858
Epoch 16/100
400/400 - 101s - loss: 0.1748 - dice_multi: 0.7930
Epoch 17/100
400/400 - 102s - loss: 0.1762 - dice_multi: 0.7951
Epoch 18/100
400/400 - 101s - loss: 0.1601 - dice_multi: 0.8065
Epoch 19/100
400/400 - 102s - loss: 0.1599 - dice_multi: 0.8041
Epoch 20/100
400/400 - 102s - loss: 0.1503 - dice_multi: 0.8142
Epoch 21/100
400/400 - 102s - loss: 0.1621 - dice_multi: 0.8047
Epoch 22/100
400/400 - 102s - loss: 0.1502 - dice_multi: 0.8146
Epoch 23/100
400/400 - 102s - loss: 0.1445 - dice_multi: 0.8179
Epoch 24/100
400/400 - 102s - loss: 0.1471 - dice_multi: 0.8209
Epoch 25/100
400/400 - 102s - loss: 0.1440 - dice_multi: 0.8221
Epoch 26/100
400/400 - 102s - loss: 0.1374 - dice_multi: 0.8257
Epoch 27/100
400/400 - 102s - loss: 0.1577 - dice_multi: 0.8077
Epoch 28/100
400/400 - 102s - loss: 0.1437 - dice_multi: 0.8226
Epoch 29/100
400/400 - 102s - loss: 0.1356 - dice_multi: 0.8368
Epoch 30/100
400/400 - 101s - loss: 0.1315 - dice_multi: 0.8401
Epoch 31/100
400/400 - 102s - loss: 0.1307 - dice_multi: 0.8415
Epoch 32/100
400/400 - 102s - loss: 0.1328 - dice_multi: 0.8364
Epoch 33/100
400/400 - 102s - loss: 0.1355 - dice_multi: 0.8262
Epoch 34/100
400/400 - 103s - loss: 0.1279 - dice_multi: 0.8417
Epoch 35/100
400/400 - 102s - loss: 0.1294 - dice_multi: 0.8365
Epoch 36/100
400/400 - 102s - loss: 0.1287 - dice_multi: 0.8407
Epoch 37/100
400/400 - 101s - loss: 0.1249 - dice_multi: 0.8461
Epoch 38/100
400/400 - 101s - loss: 0.1211 - dice_multi: 0.8421
Epoch 39/100
400/400 - 101s - loss: 0.1231 - dice_multi: 0.8470
Epoch 40/100
400/400 - 101s - loss: 0.1409 - dice_multi: 0.8248
Epoch 41/100
400/400 - 103s - loss: 0.1224 - dice_multi: 0.8477
Epoch 42/100
400/400 - 101s - loss: 0.1236 - dice_multi: 0.8451
Epoch 43/100
400/400 - 102s - loss: 0.1192 - dice_multi: 0.8525
Epoch 44/100
400/400 - 101s - loss: 0.1169 - dice_multi: 0.8480
Epoch 45/100
400/400 - 102s - loss: 0.1204 - dice_multi: 0.8499
Epoch 46/100
400/400 - 102s - loss: 0.1137 - dice_multi: 0.8487
Epoch 47/100
400/400 - 103s - loss: 0.1160 - dice_multi: 0.8519
Epoch 48/100
400/400 - 101s - loss: 0.1165 - dice_multi: 0.8492
Epoch 49/100
400/400 - 103s - loss: 0.1181 - dice_multi: 0.8576
Epoch 50/100
400/400 - 101s - loss: 0.1132 - dice_multi: 0.8551
Epoch 51/100
400/400 - 101s - loss: 0.1116 - dice_multi: 0.8468
Epoch 52/100
400/400 - 102s - loss: 0.1134 - dice_multi: 0.8517
Epoch 53/100
400/400 - 102s - loss: 0.1392 - dice_multi: 0.8317
Epoch 54/100
400/400 - 102s - loss: 0.1120 - dice_multi: 0.8534
Epoch 55/100
400/400 - 101s - loss: 0.1109 - dice_multi: 0.8558
Epoch 56/100
400/400 - 101s - loss: 0.1081 - dice_multi: 0.8473
Epoch 57/100
400/400 - 102s - loss: 0.1079 - dice_multi: 0.8639
Epoch 58/100
400/400 - 101s - loss: 0.1110 - dice_multi: 0.8591
Epoch 59/100
400/400 - 102s - loss: 0.1083 - dice_multi: 0.8678
Epoch 60/100
400/400 - 101s - loss: 0.1094 - dice_multi: 0.8609
Epoch 61/100
400/400 - 102s - loss: 0.1083 - dice_multi: 0.8557
Epoch 62/100
400/400 - 102s - loss: 0.1088 - dice_multi: 0.8622
Epoch 63/100
400/400 - 102s - loss: 0.1183 - dice_multi: 0.8500
Epoch 64/100
400/400 - 102s - loss: 0.1126 - dice_multi: 0.8517
Epoch 65/100
400/400 - 103s - loss: 0.1070 - dice_multi: 0.8606
Epoch 66/100
400/400 - 101s - loss: 0.1086 - dice_multi: 0.8604
Epoch 67/100
400/400 - 101s - loss: 0.1059 - dice_multi: 0.8583
Epoch 68/100
400/400 - 101s - loss: 0.1037 - dice_multi: 0.8573
Epoch 69/100
400/400 - 102s - loss: 0.1050 - dice_multi: 0.8709
Epoch 70/100
400/400 - 102s - loss: 0.1023 - dice_multi: 0.8659
Epoch 71/100
400/400 - 101s - loss: 0.1165 - dice_multi: 0.8509
Epoch 72/100
400/400 - 101s - loss: 0.1083 - dice_multi: 0.8547
Epoch 73/100
400/400 - 102s - loss: 0.1037 - dice_multi: 0.8687
Epoch 74/100
400/400 - 102s - loss: 0.1023 - dice_multi: 0.8665
Epoch 75/100
400/400 - 102s - loss: 0.1020 - dice_multi: 0.8700
Epoch 76/100
400/400 - 102s - loss: 0.1020 - dice_multi: 0.8638
Epoch 77/100
400/400 - 102s - loss: 0.1146 - dice_multi: 0.8581
Epoch 78/100
400/400 - 102s - loss: 0.1100 - dice_multi: 0.8594
Epoch 79/100
400/400 - 103s - loss: 0.1034 - dice_multi: 0.8688
Epoch 80/100
400/400 - 102s - loss: 0.1025 - dice_multi: 0.8685
Epoch 81/100
400/400 - 102s - loss: 0.1006 - dice_multi: 0.8692
Epoch 82/100
400/400 - 103s - loss: 0.1003 - dice_multi: 0.8697
Epoch 83/100
400/400 - 102s - loss: 0.0984 - dice_multi: 0.8716
Epoch 84/100
400/400 - 102s - loss: 0.1003 - dice_multi: 0.8724
Epoch 85/100
400/400 - 103s - loss: 0.1016 - dice_multi: 0.8696
Epoch 86/100
400/400 - 102s - loss: 0.1012 - dice_multi: 0.8721
Epoch 87/100
400/400 - 102s - loss: 0.1030 - dice_multi: 0.8693
Epoch 88/100
400/400 - 102s - loss: 0.1021 - dice_multi: 0.8669
Epoch 89/100
400/400 - 102s - loss: 0.0989 - dice_multi: 0.8752
Epoch 90/100
400/400 - 102s - loss: 0.0981 - dice_multi: 0.8709
Epoch 91/100
400/400 - 101s - loss: 0.1272 - dice_multi: 0.8521
Epoch 92/100
400/400 - 101s - loss: 0.1068 - dice_multi: 0.8650
Epoch 93/100
400/400 - 102s - loss: 0.0981 - dice_multi: 0.8677
Epoch 94/100
400/400 - 102s - loss: 0.0949 - dice_multi: 0.8726
Epoch 95/100
400/400 - 103s - loss: 0.0982 - dice_multi: 0.8755
Epoch 96/100
400/400 - 102s - loss: 0.0972 - dice_multi: 0.8686
Epoch 97/100
400/400 - 102s - loss: 0.0957 - dice_multi: 0.8768
Epoch 98/100
400/400 - 102s - loss: 0.0971 - dice_multi: 0.8664
Epoch 99/100
400/400 - 101s - loss: 0.0946 - dice_multi: 0.8743
Epoch 100/100
400/400 - 102s - loss: 0.0975 - dice_multi: 0.8671
training time: 10188.095380783081
executation time:143.63858422366056
[0.9928023  0.94587094 0.81816846 0.895635   0.83853483 0.90958947
 0.90246314]
