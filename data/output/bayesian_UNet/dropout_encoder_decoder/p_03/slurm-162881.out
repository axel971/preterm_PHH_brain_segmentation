Loading tensorflow/2.5
  Loading requirement: cuda11.2/toolkit/11.2.2 cudnn8.1-cuda11.2/8.1.1.33
    hdf5_18/1.8.20
run_bayesian_U-Net
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2021-09-22 16:25:23.144943: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(41, 256, 128, 256)
..loading data finished Wed Sep 22 16:25:50 2021
2021-09-22 16:25:50.122753: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-09-22 16:25:50.178527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-22 16:25:50.178572: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-22 16:25:50.185565: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-22 16:25:50.185656: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-09-22 16:25:50.188561: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-09-22 16:25:50.189326: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-09-22 16:25:50.190406: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-09-22 16:25:50.191713: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-09-22 16:25:50.192333: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-22 16:25:50.196193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-22 16:25:50.201226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-22 16:25:50.205059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-22 16:25:50.205098: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-22 16:25:50.731497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-22 16:25:50.731547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-09-22 16:25:50.731560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-09-22 16:25:50.738094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38184 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:3b:00.0, compute capability: 8.0)
---------fold--1---------
training set:  [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [0 1 2 3 4 5 6 7 8 9]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
2021-09-22 16:25:53.816636: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-09-22 16:25:53.817243: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2100000000 Hz
2021-09-22 16:25:56.226899: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-22 16:25:57.188720: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2021-09-22 16:25:58.183898: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-22 16:25:58.923820: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 129s - loss: 0.6689 - dice_multi: 0.3813
Epoch 2/100
400/400 - 99s - loss: 0.5212 - dice_multi: 0.4500
Epoch 3/100
400/400 - 99s - loss: 0.4450 - dice_multi: 0.5105
Epoch 4/100
400/400 - 98s - loss: 0.3777 - dice_multi: 0.5564
Epoch 5/100
400/400 - 99s - loss: 0.3444 - dice_multi: 0.5893
Epoch 6/100
400/400 - 99s - loss: 0.3043 - dice_multi: 0.6340
Epoch 7/100
400/400 - 98s - loss: 0.2761 - dice_multi: 0.6597
Epoch 8/100
400/400 - 99s - loss: 0.2704 - dice_multi: 0.6689
Epoch 9/100
400/400 - 98s - loss: 0.2284 - dice_multi: 0.7153
Epoch 10/100
400/400 - 99s - loss: 0.2121 - dice_multi: 0.7190
Epoch 11/100
400/400 - 98s - loss: 0.1961 - dice_multi: 0.7412
Epoch 12/100
400/400 - 98s - loss: 0.1819 - dice_multi: 0.7573
Epoch 13/100
400/400 - 99s - loss: 0.1848 - dice_multi: 0.7586
Epoch 14/100
400/400 - 98s - loss: 0.1698 - dice_multi: 0.7806
Epoch 15/100
400/400 - 98s - loss: 0.1754 - dice_multi: 0.7775
Epoch 16/100
400/400 - 98s - loss: 0.1566 - dice_multi: 0.7912
Epoch 17/100
400/400 - 98s - loss: 0.1537 - dice_multi: 0.7900
Epoch 18/100
400/400 - 98s - loss: 0.1710 - dice_multi: 0.7859
Epoch 19/100
400/400 - 98s - loss: 0.1463 - dice_multi: 0.8062
Epoch 20/100
400/400 - 98s - loss: 0.1458 - dice_multi: 0.8009
Epoch 21/100
400/400 - 98s - loss: 0.1375 - dice_multi: 0.8168
Epoch 22/100
400/400 - 98s - loss: 0.1404 - dice_multi: 0.8108
Epoch 23/100
400/400 - 98s - loss: 0.1401 - dice_multi: 0.8093
Epoch 24/100
400/400 - 98s - loss: 0.1449 - dice_multi: 0.8115
Epoch 25/100
400/400 - 98s - loss: 0.1322 - dice_multi: 0.8167
Epoch 26/100
400/400 - 98s - loss: 0.1268 - dice_multi: 0.8294
Epoch 27/100
400/400 - 98s - loss: 0.1316 - dice_multi: 0.8213
Epoch 28/100
400/400 - 98s - loss: 0.1272 - dice_multi: 0.8264
Epoch 29/100
400/400 - 98s - loss: 0.1373 - dice_multi: 0.8189
Epoch 30/100
400/400 - 98s - loss: 0.1212 - dice_multi: 0.8334
Epoch 31/100
400/400 - 98s - loss: 0.1439 - dice_multi: 0.8136
Epoch 32/100
400/400 - 98s - loss: 0.1197 - dice_multi: 0.8388
Epoch 33/100
400/400 - 98s - loss: 0.1209 - dice_multi: 0.8298
Epoch 34/100
400/400 - 98s - loss: 0.1202 - dice_multi: 0.8352
Epoch 35/100
400/400 - 98s - loss: 0.1190 - dice_multi: 0.8273
Epoch 36/100
400/400 - 97s - loss: 0.1159 - dice_multi: 0.8444
Epoch 37/100
400/400 - 98s - loss: 0.1176 - dice_multi: 0.8380
Epoch 38/100
400/400 - 98s - loss: 0.1187 - dice_multi: 0.8396
Epoch 39/100
400/400 - 98s - loss: 0.1148 - dice_multi: 0.8416
Epoch 40/100
400/400 - 98s - loss: 0.1146 - dice_multi: 0.8512
Epoch 41/100
400/400 - 98s - loss: 0.1237 - dice_multi: 0.8372
Epoch 42/100
400/400 - 97s - loss: 0.1225 - dice_multi: 0.8366
Epoch 43/100
400/400 - 98s - loss: 0.1170 - dice_multi: 0.8406
Epoch 44/100
400/400 - 98s - loss: 0.1107 - dice_multi: 0.8411
Epoch 45/100
400/400 - 97s - loss: 0.1081 - dice_multi: 0.8434
Epoch 46/100
400/400 - 98s - loss: 0.1088 - dice_multi: 0.8490
Epoch 47/100
400/400 - 98s - loss: 0.1051 - dice_multi: 0.8503
Epoch 48/100
400/400 - 98s - loss: 0.1039 - dice_multi: 0.8525
Epoch 49/100
400/400 - 98s - loss: 0.1081 - dice_multi: 0.8571
Epoch 50/100
400/400 - 98s - loss: 0.1070 - dice_multi: 0.8584
Epoch 51/100
400/400 - 98s - loss: 0.1169 - dice_multi: 0.8418
Epoch 52/100
400/400 - 98s - loss: 0.1084 - dice_multi: 0.8555
Epoch 53/100
400/400 - 98s - loss: 0.1030 - dice_multi: 0.8539
Epoch 54/100
400/400 - 98s - loss: 0.1040 - dice_multi: 0.8558
Epoch 55/100
400/400 - 98s - loss: 0.1317 - dice_multi: 0.8262
Epoch 56/100
400/400 - 99s - loss: 0.1086 - dice_multi: 0.8443
Epoch 57/100
400/400 - 98s - loss: 0.1027 - dice_multi: 0.8535
Epoch 58/100
400/400 - 98s - loss: 0.1029 - dice_multi: 0.8527
Epoch 59/100
400/400 - 98s - loss: 0.1031 - dice_multi: 0.8598
Epoch 60/100
400/400 - 98s - loss: 0.1009 - dice_multi: 0.8571
Epoch 61/100
400/400 - 98s - loss: 0.1016 - dice_multi: 0.8630
Epoch 62/100
400/400 - 99s - loss: 0.1037 - dice_multi: 0.8534
Epoch 63/100
400/400 - 99s - loss: 0.1131 - dice_multi: 0.8451
Epoch 64/100
400/400 - 98s - loss: 0.0997 - dice_multi: 0.8615
Epoch 65/100
400/400 - 99s - loss: 0.1004 - dice_multi: 0.8613
Epoch 66/100
400/400 - 99s - loss: 0.0993 - dice_multi: 0.8660
Epoch 67/100
400/400 - 99s - loss: 0.0979 - dice_multi: 0.8603
Epoch 68/100
400/400 - 99s - loss: 0.0984 - dice_multi: 0.8554
Epoch 69/100
400/400 - 98s - loss: 0.0983 - dice_multi: 0.8508
Epoch 70/100
400/400 - 98s - loss: 0.0986 - dice_multi: 0.8622
Epoch 71/100
400/400 - 98s - loss: 0.0989 - dice_multi: 0.8709
Epoch 72/100
400/400 - 98s - loss: 0.1012 - dice_multi: 0.8523
Epoch 73/100
400/400 - 99s - loss: 0.1060 - dice_multi: 0.8518
Epoch 74/100
400/400 - 99s - loss: 0.0964 - dice_multi: 0.8638
Epoch 75/100
400/400 - 98s - loss: 0.0945 - dice_multi: 0.8592
Epoch 76/100
400/400 - 98s - loss: 0.0957 - dice_multi: 0.8713
Epoch 77/100
400/400 - 99s - loss: 0.0964 - dice_multi: 0.8632
Epoch 78/100
400/400 - 99s - loss: 0.0959 - dice_multi: 0.8635
Epoch 79/100
400/400 - 98s - loss: 0.0968 - dice_multi: 0.8680
Epoch 80/100
400/400 - 98s - loss: 0.0953 - dice_multi: 0.8696
Epoch 81/100
400/400 - 98s - loss: 0.0950 - dice_multi: 0.8619
Epoch 82/100
400/400 - 99s - loss: 0.0947 - dice_multi: 0.8666
Epoch 83/100
400/400 - 98s - loss: 0.0917 - dice_multi: 0.8680
Epoch 84/100
400/400 - 98s - loss: 0.0949 - dice_multi: 0.8705
Epoch 85/100
400/400 - 99s - loss: 0.0932 - dice_multi: 0.8677
Epoch 86/100
400/400 - 99s - loss: 0.0909 - dice_multi: 0.8705
Epoch 87/100
400/400 - 100s - loss: 0.0910 - dice_multi: 0.8679
Epoch 88/100
400/400 - 99s - loss: 0.0917 - dice_multi: 0.8659
Epoch 89/100
400/400 - 99s - loss: 0.0928 - dice_multi: 0.8698
Epoch 90/100
400/400 - 99s - loss: 0.0989 - dice_multi: 0.8586
Epoch 91/100
400/400 - 99s - loss: 0.0936 - dice_multi: 0.8618
Epoch 92/100
400/400 - 99s - loss: 0.0907 - dice_multi: 0.8658
Epoch 93/100
400/400 - 99s - loss: 0.0932 - dice_multi: 0.8704
Epoch 94/100
400/400 - 98s - loss: 0.0936 - dice_multi: 0.8682
Epoch 95/100
400/400 - 99s - loss: 0.0881 - dice_multi: 0.8674
Epoch 96/100
400/400 - 98s - loss: 0.0894 - dice_multi: 0.8652
Epoch 97/100
400/400 - 99s - loss: 0.0889 - dice_multi: 0.8763
Epoch 98/100
400/400 - 99s - loss: 0.0871 - dice_multi: 0.8682
Epoch 99/100
400/400 - 99s - loss: 0.0886 - dice_multi: 0.8710
Epoch 100/100
400/400 - 99s - loss: 0.0884 - dice_multi: 0.8684
2021-09-22 19:10:25.007845: I tensorflow/stream_executor/cuda/cuda_blas.cc:1839] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
training time: 9866.143719434738
executation time:142.016321349144
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [10 11 12 13 14 15 16 17 18 19]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 103s - loss: 0.6868 - dice_multi: 0.3528
Epoch 2/100
400/400 - 101s - loss: 0.5318 - dice_multi: 0.4267
Epoch 3/100
400/400 - 101s - loss: 0.4678 - dice_multi: 0.4682
Epoch 4/100
400/400 - 101s - loss: 0.4107 - dice_multi: 0.5204
Epoch 5/100
400/400 - 101s - loss: 0.3820 - dice_multi: 0.5487
Epoch 6/100
400/400 - 101s - loss: 0.3399 - dice_multi: 0.5865
Epoch 7/100
400/400 - 101s - loss: 0.2986 - dice_multi: 0.6326
Epoch 8/100
400/400 - 101s - loss: 0.2712 - dice_multi: 0.6582
Epoch 9/100
400/400 - 101s - loss: 0.2532 - dice_multi: 0.6830
Epoch 10/100
400/400 - 101s - loss: 0.2272 - dice_multi: 0.7050
Epoch 11/100
400/400 - 101s - loss: 0.2259 - dice_multi: 0.7130
Epoch 12/100
400/400 - 101s - loss: 0.2046 - dice_multi: 0.7190
Epoch 13/100
400/400 - 101s - loss: 0.1873 - dice_multi: 0.7393
Epoch 14/100
400/400 - 101s - loss: 0.1911 - dice_multi: 0.7354
Epoch 15/100
400/400 - 101s - loss: 0.1864 - dice_multi: 0.7436
Epoch 16/100
400/400 - 101s - loss: 0.1667 - dice_multi: 0.7645
Epoch 17/100
400/400 - 101s - loss: 0.1731 - dice_multi: 0.7744
Epoch 18/100
400/400 - 101s - loss: 0.1677 - dice_multi: 0.7779
Epoch 19/100
400/400 - 101s - loss: 0.1691 - dice_multi: 0.7802
Epoch 20/100
400/400 - 101s - loss: 0.1600 - dice_multi: 0.7771
Epoch 21/100
400/400 - 102s - loss: 0.1578 - dice_multi: 0.7911
Epoch 22/100
400/400 - 101s - loss: 0.1622 - dice_multi: 0.7828
Epoch 23/100
400/400 - 101s - loss: 0.1397 - dice_multi: 0.8080
Epoch 24/100
400/400 - 101s - loss: 0.1457 - dice_multi: 0.8025
Epoch 25/100
400/400 - 101s - loss: 0.1420 - dice_multi: 0.8101
Epoch 26/100
400/400 - 101s - loss: 0.1450 - dice_multi: 0.7947
Epoch 27/100
400/400 - 101s - loss: 0.1433 - dice_multi: 0.7993
Epoch 28/100
400/400 - 101s - loss: 0.1421 - dice_multi: 0.7961
Epoch 29/100
400/400 - 101s - loss: 0.1344 - dice_multi: 0.8104
Epoch 30/100
400/400 - 101s - loss: 0.1273 - dice_multi: 0.8140
Epoch 31/100
400/400 - 101s - loss: 0.1363 - dice_multi: 0.8145
Epoch 32/100
400/400 - 101s - loss: 0.1278 - dice_multi: 0.8245
Epoch 33/100
400/400 - 101s - loss: 0.1235 - dice_multi: 0.8196
Epoch 34/100
400/400 - 101s - loss: 0.1235 - dice_multi: 0.8279
Epoch 35/100
400/400 - 101s - loss: 0.1272 - dice_multi: 0.8204
Epoch 36/100
400/400 - 101s - loss: 0.1219 - dice_multi: 0.8160
Epoch 37/100
400/400 - 101s - loss: 0.1238 - dice_multi: 0.8270
Epoch 38/100
400/400 - 102s - loss: 0.1373 - dice_multi: 0.8071
Epoch 39/100
400/400 - 101s - loss: 0.1192 - dice_multi: 0.8289
Epoch 40/100
400/400 - 101s - loss: 0.1244 - dice_multi: 0.8189
Epoch 41/100
400/400 - 101s - loss: 0.1206 - dice_multi: 0.8279
Epoch 42/100
400/400 - 101s - loss: 0.1139 - dice_multi: 0.8266
Epoch 43/100
400/400 - 101s - loss: 0.1175 - dice_multi: 0.8281
Epoch 44/100
400/400 - 101s - loss: 0.1250 - dice_multi: 0.8136
Epoch 45/100
400/400 - 101s - loss: 0.1116 - dice_multi: 0.8376
Epoch 46/100
400/400 - 101s - loss: 0.1112 - dice_multi: 0.8400
Epoch 47/100
400/400 - 101s - loss: 0.1121 - dice_multi: 0.8365
Epoch 48/100
400/400 - 101s - loss: 0.1108 - dice_multi: 0.8387
Epoch 49/100
400/400 - 102s - loss: 0.1207 - dice_multi: 0.8314
Epoch 50/100
400/400 - 102s - loss: 0.1225 - dice_multi: 0.8196
Epoch 51/100
400/400 - 101s - loss: 0.1108 - dice_multi: 0.8410
Epoch 52/100
400/400 - 101s - loss: 0.1122 - dice_multi: 0.8382
Epoch 53/100
400/400 - 101s - loss: 0.1169 - dice_multi: 0.8319
Epoch 54/100
400/400 - 101s - loss: 0.1120 - dice_multi: 0.8412
Epoch 55/100
400/400 - 102s - loss: 0.1069 - dice_multi: 0.8432
Epoch 56/100
400/400 - 101s - loss: 0.1055 - dice_multi: 0.8400
Epoch 57/100
400/400 - 101s - loss: 0.1077 - dice_multi: 0.8442
Epoch 58/100
400/400 - 102s - loss: 0.1087 - dice_multi: 0.8517
Epoch 59/100
400/400 - 102s - loss: 0.1071 - dice_multi: 0.8521
Epoch 60/100
400/400 - 101s - loss: 0.1319 - dice_multi: 0.8206
Epoch 61/100
400/400 - 101s - loss: 0.1060 - dice_multi: 0.8400
Epoch 62/100
400/400 - 101s - loss: 0.1042 - dice_multi: 0.8483
Epoch 63/100
400/400 - 102s - loss: 0.1049 - dice_multi: 0.8495
Epoch 64/100
400/400 - 102s - loss: 0.1001 - dice_multi: 0.8494
Epoch 65/100
400/400 - 101s - loss: 0.1020 - dice_multi: 0.8440
Epoch 66/100
400/400 - 102s - loss: 0.1017 - dice_multi: 0.8515
Epoch 67/100
400/400 - 101s - loss: 0.1032 - dice_multi: 0.8507
Epoch 68/100
400/400 - 102s - loss: 0.1282 - dice_multi: 0.8274
Epoch 69/100
400/400 - 102s - loss: 0.1123 - dice_multi: 0.8383
Epoch 70/100
400/400 - 102s - loss: 0.1035 - dice_multi: 0.8448
Epoch 71/100
400/400 - 101s - loss: 0.1004 - dice_multi: 0.8469
Epoch 72/100
400/400 - 101s - loss: 0.0997 - dice_multi: 0.8509
Epoch 73/100
400/400 - 101s - loss: 0.0992 - dice_multi: 0.8492
Epoch 74/100
400/400 - 101s - loss: 0.1049 - dice_multi: 0.8432
Epoch 75/100
400/400 - 101s - loss: 0.1082 - dice_multi: 0.8367
Epoch 76/100
400/400 - 101s - loss: 0.1021 - dice_multi: 0.8576
Epoch 77/100
400/400 - 101s - loss: 0.0950 - dice_multi: 0.8542
Epoch 78/100
400/400 - 101s - loss: 0.1002 - dice_multi: 0.8501
Epoch 79/100
400/400 - 101s - loss: 0.1168 - dice_multi: 0.8309
Epoch 80/100
400/400 - 101s - loss: 0.1025 - dice_multi: 0.8511
Epoch 81/100
400/400 - 101s - loss: 0.1012 - dice_multi: 0.8571
Epoch 82/100
400/400 - 101s - loss: 0.0958 - dice_multi: 0.8526
Epoch 83/100
400/400 - 101s - loss: 0.0968 - dice_multi: 0.8479
Epoch 84/100
400/400 - 101s - loss: 0.0973 - dice_multi: 0.8556
Epoch 85/100
400/400 - 101s - loss: 0.0977 - dice_multi: 0.8521
Epoch 86/100
400/400 - 101s - loss: 0.0969 - dice_multi: 0.8523
Epoch 87/100
400/400 - 101s - loss: 0.0960 - dice_multi: 0.8496
Epoch 88/100
400/400 - 101s - loss: 0.1005 - dice_multi: 0.8553
Epoch 89/100
400/400 - 101s - loss: 0.0972 - dice_multi: 0.8479
Epoch 90/100
400/400 - 101s - loss: 0.0946 - dice_multi: 0.8613
Epoch 91/100
400/400 - 101s - loss: 0.0928 - dice_multi: 0.8608
Epoch 92/100
400/400 - 101s - loss: 0.0955 - dice_multi: 0.8526
Epoch 93/100
400/400 - 101s - loss: 0.0962 - dice_multi: 0.8518
Epoch 94/100
400/400 - 101s - loss: 0.1071 - dice_multi: 0.8365
Epoch 95/100
400/400 - 102s - loss: 0.0976 - dice_multi: 0.8574
Epoch 96/100
400/400 - 102s - loss: 0.0952 - dice_multi: 0.8516
Epoch 97/100
400/400 - 101s - loss: 0.0936 - dice_multi: 0.8555
Epoch 98/100
400/400 - 101s - loss: 0.0942 - dice_multi: 0.8599
Epoch 99/100
400/400 - 101s - loss: 0.0928 - dice_multi: 0.8643
Epoch 100/100
400/400 - 101s - loss: 0.0928 - dice_multi: 0.8546
training time: 10133.55009317398
executation time:142.9862426519394
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [20 21 22 23 24 25 26 27 28 29]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 103s - loss: 0.6358 - dice_multi: 0.3580
Epoch 2/100
400/400 - 100s - loss: 0.5201 - dice_multi: 0.4186
Epoch 3/100
400/400 - 101s - loss: 0.4439 - dice_multi: 0.4640
Epoch 4/100
400/400 - 100s - loss: 0.4180 - dice_multi: 0.4998
Epoch 5/100
400/400 - 100s - loss: 0.3787 - dice_multi: 0.5309
Epoch 6/100
400/400 - 101s - loss: 0.3440 - dice_multi: 0.5685
Epoch 7/100
400/400 - 101s - loss: 0.3137 - dice_multi: 0.6121
Epoch 8/100
400/400 - 101s - loss: 0.2802 - dice_multi: 0.6339
Epoch 9/100
400/400 - 100s - loss: 0.2680 - dice_multi: 0.6547
Epoch 10/100
400/400 - 101s - loss: 0.2337 - dice_multi: 0.6913
Epoch 11/100
400/400 - 101s - loss: 0.2220 - dice_multi: 0.6918
Epoch 12/100
400/400 - 100s - loss: 0.2147 - dice_multi: 0.7149
Epoch 13/100
400/400 - 101s - loss: 0.1974 - dice_multi: 0.7273
Epoch 14/100
400/400 - 101s - loss: 0.1827 - dice_multi: 0.7390
Epoch 15/100
400/400 - 101s - loss: 0.1865 - dice_multi: 0.7406
Epoch 16/100
400/400 - 101s - loss: 0.1915 - dice_multi: 0.7383
Epoch 17/100
400/400 - 100s - loss: 0.1686 - dice_multi: 0.7605
Epoch 18/100
400/400 - 101s - loss: 0.1660 - dice_multi: 0.7657
Epoch 19/100
400/400 - 101s - loss: 0.1563 - dice_multi: 0.7802
Epoch 20/100
400/400 - 101s - loss: 0.1657 - dice_multi: 0.7660
Epoch 21/100
400/400 - 101s - loss: 0.1588 - dice_multi: 0.7784
Epoch 22/100
400/400 - 102s - loss: 0.1534 - dice_multi: 0.7833
Epoch 23/100
400/400 - 101s - loss: 0.1507 - dice_multi: 0.7851
Epoch 24/100
400/400 - 101s - loss: 0.1469 - dice_multi: 0.7847
Epoch 25/100
400/400 - 100s - loss: 0.1418 - dice_multi: 0.7962
Epoch 26/100
400/400 - 101s - loss: 0.1375 - dice_multi: 0.7940
Epoch 27/100
400/400 - 101s - loss: 0.1435 - dice_multi: 0.7930
Epoch 28/100
400/400 - 100s - loss: 0.1543 - dice_multi: 0.7873
Epoch 29/100
400/400 - 101s - loss: 0.1338 - dice_multi: 0.8075
Epoch 30/100
400/400 - 102s - loss: 0.1291 - dice_multi: 0.8087
Epoch 31/100
400/400 - 101s - loss: 0.1281 - dice_multi: 0.8132
Epoch 32/100
400/400 - 102s - loss: 0.1415 - dice_multi: 0.7896
Epoch 33/100
400/400 - 102s - loss: 0.1325 - dice_multi: 0.8058
Epoch 34/100
400/400 - 101s - loss: 0.1253 - dice_multi: 0.8116
Epoch 35/100
400/400 - 102s - loss: 0.1414 - dice_multi: 0.7987
Epoch 36/100
400/400 - 101s - loss: 0.1269 - dice_multi: 0.8122
Epoch 37/100
400/400 - 100s - loss: 0.1216 - dice_multi: 0.8111
Epoch 38/100
400/400 - 102s - loss: 0.1191 - dice_multi: 0.8169
Epoch 39/100
400/400 - 101s - loss: 0.1220 - dice_multi: 0.8137
Epoch 40/100
400/400 - 101s - loss: 0.1157 - dice_multi: 0.8201
Epoch 41/100
400/400 - 102s - loss: 0.1331 - dice_multi: 0.8102
Epoch 42/100
400/400 - 101s - loss: 0.1187 - dice_multi: 0.8262
Epoch 43/100
400/400 - 102s - loss: 0.1161 - dice_multi: 0.8296
Epoch 44/100
400/400 - 102s - loss: 0.1185 - dice_multi: 0.8254
Epoch 45/100
400/400 - 101s - loss: 0.1373 - dice_multi: 0.8004
Epoch 46/100
400/400 - 101s - loss: 0.1144 - dice_multi: 0.8338
Epoch 47/100
400/400 - 101s - loss: 0.1107 - dice_multi: 0.8393
Epoch 48/100
400/400 - 101s - loss: 0.1119 - dice_multi: 0.8292
Epoch 49/100
400/400 - 100s - loss: 0.1115 - dice_multi: 0.8372
Epoch 50/100
400/400 - 100s - loss: 0.1119 - dice_multi: 0.8293
Epoch 51/100
400/400 - 101s - loss: 0.1385 - dice_multi: 0.8142
Epoch 52/100
400/400 - 100s - loss: 0.1128 - dice_multi: 0.8288
Epoch 53/100
400/400 - 101s - loss: 0.1158 - dice_multi: 0.8366
Epoch 54/100
400/400 - 101s - loss: 0.1097 - dice_multi: 0.8338
Epoch 55/100
400/400 - 101s - loss: 0.1082 - dice_multi: 0.8392
Epoch 56/100
400/400 - 101s - loss: 0.1100 - dice_multi: 0.8285
Epoch 57/100
400/400 - 101s - loss: 0.1033 - dice_multi: 0.8320
Epoch 58/100
400/400 - 100s - loss: 0.1029 - dice_multi: 0.8395
Epoch 59/100
400/400 - 101s - loss: 0.1075 - dice_multi: 0.8432
Epoch 60/100
400/400 - 101s - loss: 0.1286 - dice_multi: 0.8150
Epoch 61/100
400/400 - 102s - loss: 0.1112 - dice_multi: 0.8370
Epoch 62/100
400/400 - 101s - loss: 0.1063 - dice_multi: 0.8425
Epoch 63/100
400/400 - 101s - loss: 0.1121 - dice_multi: 0.8396
Epoch 64/100
400/400 - 101s - loss: 0.1050 - dice_multi: 0.8437
Epoch 65/100
400/400 - 101s - loss: 0.0996 - dice_multi: 0.8477
Epoch 66/100
400/400 - 100s - loss: 0.1054 - dice_multi: 0.8429
Epoch 67/100
400/400 - 101s - loss: 0.1032 - dice_multi: 0.8473
Epoch 68/100
400/400 - 101s - loss: 0.1045 - dice_multi: 0.8403
Epoch 69/100
400/400 - 101s - loss: 0.1102 - dice_multi: 0.8361
Epoch 70/100
400/400 - 101s - loss: 0.1035 - dice_multi: 0.8460
Epoch 71/100
400/400 - 101s - loss: 0.1031 - dice_multi: 0.8439
Epoch 72/100
400/400 - 101s - loss: 0.1011 - dice_multi: 0.8525
Epoch 73/100
400/400 - 101s - loss: 0.1010 - dice_multi: 0.8440
Epoch 74/100
400/400 - 102s - loss: 0.0981 - dice_multi: 0.8471
Epoch 75/100
400/400 - 101s - loss: 0.1013 - dice_multi: 0.8425
Epoch 76/100
400/400 - 101s - loss: 0.1031 - dice_multi: 0.8446
Epoch 77/100
400/400 - 102s - loss: 0.1010 - dice_multi: 0.8487
Epoch 78/100
400/400 - 101s - loss: 0.0973 - dice_multi: 0.8557
Epoch 79/100
400/400 - 102s - loss: 0.1015 - dice_multi: 0.8432
Epoch 80/100
400/400 - 101s - loss: 0.0970 - dice_multi: 0.8461
Epoch 81/100
400/400 - 103s - loss: 0.0974 - dice_multi: 0.8508
Epoch 82/100
400/400 - 101s - loss: 0.0993 - dice_multi: 0.8526
Epoch 83/100
400/400 - 102s - loss: 0.1110 - dice_multi: 0.8353
Epoch 84/100
400/400 - 101s - loss: 0.0938 - dice_multi: 0.8463
Epoch 85/100
400/400 - 101s - loss: 0.0975 - dice_multi: 0.8479
Epoch 86/100
400/400 - 102s - loss: 0.0951 - dice_multi: 0.8512
Epoch 87/100
400/400 - 103s - loss: 0.0952 - dice_multi: 0.8505
Epoch 88/100
400/400 - 102s - loss: 0.0950 - dice_multi: 0.8535
Epoch 89/100
400/400 - 101s - loss: 0.0947 - dice_multi: 0.8488
Epoch 90/100
400/400 - 101s - loss: 0.0947 - dice_multi: 0.8534
Epoch 91/100
400/400 - 102s - loss: 0.1209 - dice_multi: 0.8238
Epoch 92/100
400/400 - 102s - loss: 0.0991 - dice_multi: 0.8509
Epoch 93/100
400/400 - 102s - loss: 0.0937 - dice_multi: 0.8548
Epoch 94/100
400/400 - 101s - loss: 0.0982 - dice_multi: 0.8553
Epoch 95/100
400/400 - 102s - loss: 0.0944 - dice_multi: 0.8574
Epoch 96/100
400/400 - 102s - loss: 0.0946 - dice_multi: 0.8513
Epoch 97/100
400/400 - 101s - loss: 0.0917 - dice_multi: 0.8580
Epoch 98/100
400/400 - 102s - loss: 0.0914 - dice_multi: 0.8544
Epoch 99/100
400/400 - 101s - loss: 0.1092 - dice_multi: 0.8326
Epoch 100/100
400/400 - 101s - loss: 0.0928 - dice_multi: 0.8539
training time: 10122.281501293182
executation time:144.41309101581572
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]
training set size:  30
testing set:  [30 31 32 33 34 35 36 37 38 39 40]
testing set size:  11
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 103s - loss: 0.6649 - dice_multi: 0.3996
Epoch 2/100
400/400 - 101s - loss: 0.5193 - dice_multi: 0.4817
Epoch 3/100
400/400 - 101s - loss: 0.4276 - dice_multi: 0.5421
Epoch 4/100
400/400 - 102s - loss: 0.3684 - dice_multi: 0.5995
Epoch 5/100
400/400 - 103s - loss: 0.3172 - dice_multi: 0.6571
Epoch 6/100
400/400 - 104s - loss: 0.2752 - dice_multi: 0.6888
Epoch 7/100
400/400 - 105s - loss: 0.2556 - dice_multi: 0.7120
Epoch 8/100
400/400 - 104s - loss: 0.2296 - dice_multi: 0.7378
Epoch 9/100
400/400 - 103s - loss: 0.2201 - dice_multi: 0.7477
Epoch 10/100
400/400 - 104s - loss: 0.2044 - dice_multi: 0.7530
Epoch 11/100
400/400 - 104s - loss: 0.1909 - dice_multi: 0.7773
Epoch 12/100
400/400 - 104s - loss: 0.1970 - dice_multi: 0.7753
Epoch 13/100
400/400 - 102s - loss: 0.1893 - dice_multi: 0.7806
Epoch 14/100
400/400 - 102s - loss: 0.1720 - dice_multi: 0.7992
Epoch 15/100
400/400 - 104s - loss: 0.1689 - dice_multi: 0.8034
Epoch 16/100
400/400 - 102s - loss: 0.1697 - dice_multi: 0.7958
Epoch 17/100
400/400 - 104s - loss: 0.1663 - dice_multi: 0.8014
Epoch 18/100
400/400 - 104s - loss: 0.1608 - dice_multi: 0.8056
Epoch 19/100
400/400 - 104s - loss: 0.1597 - dice_multi: 0.8144
Epoch 20/100
400/400 - 104s - loss: 0.1467 - dice_multi: 0.8113
Epoch 21/100
400/400 - 103s - loss: 0.1638 - dice_multi: 0.7985
Epoch 22/100
400/400 - 104s - loss: 0.1477 - dice_multi: 0.8126
Epoch 23/100
400/400 - 103s - loss: 0.1395 - dice_multi: 0.8220
Epoch 24/100
400/400 - 104s - loss: 0.1371 - dice_multi: 0.8260
Epoch 25/100
400/400 - 104s - loss: 0.1520 - dice_multi: 0.8192
Epoch 26/100
400/400 - 103s - loss: 0.1414 - dice_multi: 0.8217
Epoch 27/100
400/400 - 102s - loss: 0.1420 - dice_multi: 0.8274
Epoch 28/100
400/400 - 104s - loss: 0.1331 - dice_multi: 0.8332
Epoch 29/100
400/400 - 105s - loss: 0.1341 - dice_multi: 0.8373
Epoch 30/100
400/400 - 104s - loss: 0.1332 - dice_multi: 0.8424
Epoch 31/100
400/400 - 102s - loss: 0.1338 - dice_multi: 0.8377
Epoch 32/100
400/400 - 102s - loss: 0.1475 - dice_multi: 0.8226
Epoch 33/100
400/400 - 104s - loss: 0.1352 - dice_multi: 0.8373
Epoch 34/100
400/400 - 102s - loss: 0.1333 - dice_multi: 0.8335
Epoch 35/100
400/400 - 102s - loss: 0.1359 - dice_multi: 0.8382
Epoch 36/100
400/400 - 102s - loss: 0.1268 - dice_multi: 0.8462
Epoch 37/100
400/400 - 104s - loss: 0.1241 - dice_multi: 0.8453
Epoch 38/100
400/400 - 104s - loss: 0.1224 - dice_multi: 0.8488
Epoch 39/100
400/400 - 103s - loss: 0.1282 - dice_multi: 0.8418
Epoch 40/100
400/400 - 102s - loss: 0.1196 - dice_multi: 0.8501
Epoch 41/100
400/400 - 102s - loss: 0.1326 - dice_multi: 0.8486
Epoch 42/100
400/400 - 103s - loss: 0.1209 - dice_multi: 0.8460
Epoch 43/100
400/400 - 103s - loss: 0.1200 - dice_multi: 0.8537
Epoch 44/100
400/400 - 103s - loss: 0.1240 - dice_multi: 0.8452
Epoch 45/100
400/400 - 104s - loss: 0.1169 - dice_multi: 0.8494
Epoch 46/100
400/400 - 104s - loss: 0.1176 - dice_multi: 0.8524
Epoch 47/100
400/400 - 105s - loss: 0.1172 - dice_multi: 0.8486
Epoch 48/100
400/400 - 104s - loss: 0.1190 - dice_multi: 0.8483
Epoch 49/100
400/400 - 104s - loss: 0.1295 - dice_multi: 0.8396
Epoch 50/100
400/400 - 103s - loss: 0.1147 - dice_multi: 0.8463
Epoch 51/100
400/400 - 103s - loss: 0.1156 - dice_multi: 0.8563
Epoch 52/100
400/400 - 102s - loss: 0.1148 - dice_multi: 0.8569
Epoch 53/100
400/400 - 102s - loss: 0.1166 - dice_multi: 0.8544
Epoch 54/100
400/400 - 104s - loss: 0.1209 - dice_multi: 0.8517
Epoch 55/100
400/400 - 103s - loss: 0.1094 - dice_multi: 0.8610
Epoch 56/100
400/400 - 105s - loss: 0.1107 - dice_multi: 0.8594
Epoch 57/100
400/400 - 104s - loss: 0.1140 - dice_multi: 0.8606
Epoch 58/100
400/400 - 105s - loss: 0.1102 - dice_multi: 0.8586
Epoch 59/100
400/400 - 106s - loss: 0.1105 - dice_multi: 0.8589
Epoch 60/100
400/400 - 103s - loss: 0.1216 - dice_multi: 0.8482
Epoch 61/100
400/400 - 104s - loss: 0.1117 - dice_multi: 0.8544
Epoch 62/100
400/400 - 104s - loss: 0.1070 - dice_multi: 0.8586
Epoch 63/100
400/400 - 103s - loss: 0.1076 - dice_multi: 0.8610
Epoch 64/100
400/400 - 103s - loss: 0.1058 - dice_multi: 0.8633
Epoch 65/100
400/400 - 105s - loss: 0.1067 - dice_multi: 0.8668
Epoch 66/100
400/400 - 103s - loss: 0.1120 - dice_multi: 0.8556
Epoch 67/100
400/400 - 103s - loss: 0.1075 - dice_multi: 0.8565
Epoch 68/100
400/400 - 104s - loss: 0.1191 - dice_multi: 0.8466
Epoch 69/100
400/400 - 104s - loss: 0.1091 - dice_multi: 0.8600
Epoch 70/100
400/400 - 104s - loss: 0.1070 - dice_multi: 0.8615
Epoch 71/100
400/400 - 103s - loss: 0.1049 - dice_multi: 0.8681
Epoch 72/100
400/400 - 104s - loss: 0.1055 - dice_multi: 0.8651
Epoch 73/100
400/400 - 105s - loss: 0.1036 - dice_multi: 0.8637
Epoch 74/100
400/400 - 103s - loss: 0.1129 - dice_multi: 0.8610
Epoch 75/100
400/400 - 105s - loss: 0.1020 - dice_multi: 0.8621
Epoch 76/100
400/400 - 104s - loss: 0.1032 - dice_multi: 0.8618
Epoch 77/100
400/400 - 103s - loss: 0.1040 - dice_multi: 0.8711
Epoch 78/100
400/400 - 103s - loss: 0.1037 - dice_multi: 0.8651
Epoch 79/100
400/400 - 103s - loss: 0.1026 - dice_multi: 0.8642
Epoch 80/100
400/400 - 104s - loss: 0.1047 - dice_multi: 0.8648
Epoch 81/100
400/400 - 103s - loss: 0.1045 - dice_multi: 0.8660
Epoch 82/100
400/400 - 102s - loss: 0.1014 - dice_multi: 0.8710
Epoch 83/100
400/400 - 103s - loss: 0.1000 - dice_multi: 0.8676
Epoch 84/100
400/400 - 102s - loss: 0.1026 - dice_multi: 0.8674
Epoch 85/100
400/400 - 102s - loss: 0.1048 - dice_multi: 0.8649
Epoch 86/100
400/400 - 101s - loss: 0.1023 - dice_multi: 0.8704
Epoch 87/100
400/400 - 102s - loss: 0.1017 - dice_multi: 0.8702
Epoch 88/100
400/400 - 104s - loss: 0.1013 - dice_multi: 0.8642
Epoch 89/100
400/400 - 104s - loss: 0.1011 - dice_multi: 0.8733
Epoch 90/100
400/400 - 103s - loss: 0.1030 - dice_multi: 0.8714
Epoch 91/100
400/400 - 103s - loss: 0.0979 - dice_multi: 0.8711
Epoch 92/100
400/400 - 103s - loss: 0.0994 - dice_multi: 0.8679
Epoch 93/100
400/400 - 103s - loss: 0.1006 - dice_multi: 0.8699
Epoch 94/100
400/400 - 103s - loss: 0.0986 - dice_multi: 0.8700
Epoch 95/100
400/400 - 104s - loss: 0.0989 - dice_multi: 0.8707
Epoch 96/100
400/400 - 103s - loss: 0.0949 - dice_multi: 0.8727
Epoch 97/100
400/400 - 103s - loss: 0.0966 - dice_multi: 0.8686
Epoch 98/100
400/400 - 103s - loss: 0.0993 - dice_multi: 0.8675
Epoch 99/100
400/400 - 102s - loss: 0.0974 - dice_multi: 0.8731
Epoch 100/100
400/400 - 104s - loss: 0.0954 - dice_multi: 0.8700
training time: 10335.04391169548
executation time:144.1161027388139
[0.99285173 0.9112794  0.81917775 0.893047   0.8353972  0.8970954
 0.8980511 ]
