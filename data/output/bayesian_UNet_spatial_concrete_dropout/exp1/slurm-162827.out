Loading tensorflow/2.5
  Loading requirement: cuda11.2/toolkit/11.2.2 cudnn8.1-cuda11.2/8.1.1.33
    hdf5_18/1.8.20
bayesian U-Net with Spatial3DConcreteDropout
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2021-09-19 22:32:42.904009: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(41, 256, 128, 256)
..loading data finished Sun Sep 19 22:33:11 2021
2021-09-19 22:33:11.456577: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-09-19 22:33:11.512600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-19 22:33:11.512642: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-19 22:33:11.550251: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-19 22:33:11.550403: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-09-19 22:33:11.566372: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-09-19 22:33:11.578283: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-09-19 22:33:11.581219: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-09-19 22:33:11.585925: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-09-19 22:33:11.587784: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-19 22:33:11.597791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-19 22:33:11.603615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-19 22:33:11.607460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-19 22:33:11.607498: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-19 22:33:12.130939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-19 22:33:12.130991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-09-19 22:33:12.131003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-09-19 22:33:12.137078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38184 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:3b:00.0, compute capability: 8.0)
WARNING:tensorflow:AutoGraph could not transform <bound method Spatial3DConcreteDropout.call of <model.ConcreteDropout.spatialConcreteDropout.Spatial3DConcreteDropout object at 0x2aad6cce9f70>> and will run it as-is.
Cause: code mixing tabs and spaces for indentation is not allowed
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
---------fold--1---------
training set:  [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [0 1 2 3 4 5 6 7 8 9]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
2021-09-19 22:33:15.413846: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-09-19 22:33:15.414310: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2100000000 Hz
2021-09-19 22:33:19.414647: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-19 22:33:20.508760: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2021-09-19 22:33:21.709009: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-19 22:33:22.529510: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 144s - loss: 0.6595 - dice_multi: 0.3838
Epoch 2/100
400/400 - 110s - loss: 0.5175 - dice_multi: 0.4629
Epoch 3/100
400/400 - 109s - loss: 0.4376 - dice_multi: 0.5162
Epoch 4/100
400/400 - 110s - loss: 0.3696 - dice_multi: 0.5704
Epoch 5/100
400/400 - 109s - loss: 0.3338 - dice_multi: 0.6154
Epoch 6/100
400/400 - 109s - loss: 0.2839 - dice_multi: 0.6679
Epoch 7/100
400/400 - 109s - loss: 0.2425 - dice_multi: 0.7107
Epoch 8/100
400/400 - 109s - loss: 0.2231 - dice_multi: 0.7284
Epoch 9/100
400/400 - 109s - loss: 0.2208 - dice_multi: 0.7410
Epoch 10/100
400/400 - 109s - loss: 0.1908 - dice_multi: 0.7624
Epoch 11/100
400/400 - 110s - loss: 0.1852 - dice_multi: 0.7818
Epoch 12/100
400/400 - 110s - loss: 0.2098 - dice_multi: 0.7565
Epoch 13/100
400/400 - 110s - loss: 0.1715 - dice_multi: 0.7843
Epoch 14/100
400/400 - 110s - loss: 0.1614 - dice_multi: 0.8067
Epoch 15/100
400/400 - 109s - loss: 0.1524 - dice_multi: 0.8055
Epoch 16/100
400/400 - 110s - loss: 0.1531 - dice_multi: 0.8146
Epoch 17/100
400/400 - 110s - loss: 0.1649 - dice_multi: 0.7963
Epoch 18/100
400/400 - 109s - loss: 0.1500 - dice_multi: 0.8217
Epoch 19/100
400/400 - 110s - loss: 0.1372 - dice_multi: 0.8193
Epoch 20/100
400/400 - 109s - loss: 0.1519 - dice_multi: 0.8122
Epoch 21/100
400/400 - 109s - loss: 0.1368 - dice_multi: 0.8225
Epoch 22/100
400/400 - 110s - loss: 0.1555 - dice_multi: 0.8050
Epoch 23/100
400/400 - 110s - loss: 0.1345 - dice_multi: 0.8325
Epoch 24/100
400/400 - 109s - loss: 0.1470 - dice_multi: 0.8167
Epoch 25/100
400/400 - 109s - loss: 0.1285 - dice_multi: 0.8368
Epoch 26/100
400/400 - 110s - loss: 0.1415 - dice_multi: 0.8205
Epoch 27/100
400/400 - 109s - loss: 0.1451 - dice_multi: 0.8220
Epoch 28/100
400/400 - 109s - loss: 0.1266 - dice_multi: 0.8440
Epoch 29/100
400/400 - 110s - loss: 0.1212 - dice_multi: 0.8417
Epoch 30/100
400/400 - 110s - loss: 0.1218 - dice_multi: 0.8466
Epoch 31/100
400/400 - 110s - loss: 0.1426 - dice_multi: 0.8196
Epoch 32/100
400/400 - 110s - loss: 0.1275 - dice_multi: 0.8383
Epoch 33/100
400/400 - 110s - loss: 0.1260 - dice_multi: 0.8395
Epoch 34/100
400/400 - 110s - loss: 0.1192 - dice_multi: 0.8427
Epoch 35/100
400/400 - 109s - loss: 0.1161 - dice_multi: 0.8521
Epoch 36/100
400/400 - 110s - loss: 0.1145 - dice_multi: 0.8494
Epoch 37/100
400/400 - 110s - loss: 0.1183 - dice_multi: 0.8424
Epoch 38/100
400/400 - 110s - loss: 0.1260 - dice_multi: 0.8368
Epoch 39/100
400/400 - 110s - loss: 0.1222 - dice_multi: 0.8481
Epoch 40/100
400/400 - 110s - loss: 0.1591 - dice_multi: 0.8105
Epoch 41/100
400/400 - 110s - loss: 0.1178 - dice_multi: 0.8517
Epoch 42/100
400/400 - 109s - loss: 0.1118 - dice_multi: 0.8527
Epoch 43/100
400/400 - 110s - loss: 0.1118 - dice_multi: 0.8579
Epoch 44/100
400/400 - 109s - loss: 0.1135 - dice_multi: 0.8548
Epoch 45/100
400/400 - 110s - loss: 0.1082 - dice_multi: 0.8504
Epoch 46/100
400/400 - 109s - loss: 0.1154 - dice_multi: 0.8487
Epoch 47/100
400/400 - 110s - loss: 0.1363 - dice_multi: 0.8318
Epoch 48/100
400/400 - 109s - loss: 0.1125 - dice_multi: 0.8608
Epoch 49/100
400/400 - 109s - loss: 0.1075 - dice_multi: 0.8621
Epoch 50/100
400/400 - 110s - loss: 0.1053 - dice_multi: 0.8579
Epoch 51/100
400/400 - 109s - loss: 0.1169 - dice_multi: 0.8473
Epoch 52/100
400/400 - 110s - loss: 0.1183 - dice_multi: 0.8445
Epoch 53/100
400/400 - 110s - loss: 0.1107 - dice_multi: 0.8498
Epoch 54/100
400/400 - 110s - loss: 0.1088 - dice_multi: 0.8583
Epoch 55/100
400/400 - 110s - loss: 0.1075 - dice_multi: 0.8555
Epoch 56/100
400/400 - 110s - loss: 0.1378 - dice_multi: 0.8276
Epoch 57/100
400/400 - 109s - loss: 0.1125 - dice_multi: 0.8667
Epoch 58/100
400/400 - 110s - loss: 0.1052 - dice_multi: 0.8630
Epoch 59/100
400/400 - 109s - loss: 0.1046 - dice_multi: 0.8558
Epoch 60/100
400/400 - 109s - loss: 0.1293 - dice_multi: 0.8365
Epoch 61/100
400/400 - 110s - loss: 0.1056 - dice_multi: 0.8626
Epoch 62/100
400/400 - 109s - loss: 0.1034 - dice_multi: 0.8631
Epoch 63/100
400/400 - 109s - loss: 0.1015 - dice_multi: 0.8640
Epoch 64/100
400/400 - 110s - loss: 0.1009 - dice_multi: 0.8622
Epoch 65/100
400/400 - 109s - loss: 0.1040 - dice_multi: 0.8643
Epoch 66/100
400/400 - 109s - loss: 0.1260 - dice_multi: 0.8323
Epoch 67/100
400/400 - 109s - loss: 0.1145 - dice_multi: 0.8539
Epoch 68/100
400/400 - 110s - loss: 0.1032 - dice_multi: 0.8669
Epoch 69/100
400/400 - 110s - loss: 0.1136 - dice_multi: 0.8504
Epoch 70/100
400/400 - 110s - loss: 0.1067 - dice_multi: 0.8725
Epoch 71/100
400/400 - 110s - loss: 0.1020 - dice_multi: 0.8661
Epoch 72/100
400/400 - 109s - loss: 0.0990 - dice_multi: 0.8657
Epoch 73/100
400/400 - 109s - loss: 0.0999 - dice_multi: 0.8690
Epoch 74/100
400/400 - 109s - loss: 0.1010 - dice_multi: 0.8594
Epoch 75/100
400/400 - 109s - loss: 0.1028 - dice_multi: 0.8633
Epoch 76/100
400/400 - 109s - loss: 0.1216 - dice_multi: 0.8421
Epoch 77/100
400/400 - 110s - loss: 0.1026 - dice_multi: 0.8653
Epoch 78/100
400/400 - 109s - loss: 0.0990 - dice_multi: 0.8648
Epoch 79/100
400/400 - 109s - loss: 0.1035 - dice_multi: 0.8581
Epoch 80/100
400/400 - 109s - loss: 0.0989 - dice_multi: 0.8678
Epoch 81/100
400/400 - 109s - loss: 0.0972 - dice_multi: 0.8704
Epoch 82/100
400/400 - 109s - loss: 0.0960 - dice_multi: 0.8723
Epoch 83/100
400/400 - 109s - loss: 0.1112 - dice_multi: 0.8543
Epoch 84/100
400/400 - 110s - loss: 0.1199 - dice_multi: 0.8443
Epoch 85/100
400/400 - 110s - loss: 0.1011 - dice_multi: 0.8650
Epoch 86/100
400/400 - 110s - loss: 0.0974 - dice_multi: 0.8680
Epoch 87/100
400/400 - 109s - loss: 0.0986 - dice_multi: 0.8710
Epoch 88/100
400/400 - 109s - loss: 0.0968 - dice_multi: 0.8691
Epoch 89/100
400/400 - 109s - loss: 0.1037 - dice_multi: 0.8619
Epoch 90/100
400/400 - 109s - loss: 0.0963 - dice_multi: 0.8685
Epoch 91/100
400/400 - 110s - loss: 0.0914 - dice_multi: 0.8669
Epoch 92/100
400/400 - 110s - loss: 0.0958 - dice_multi: 0.8671
Epoch 93/100
400/400 - 110s - loss: 0.0940 - dice_multi: 0.8695
Epoch 94/100
400/400 - 109s - loss: 0.0989 - dice_multi: 0.8679
Epoch 95/100
400/400 - 109s - loss: 0.1100 - dice_multi: 0.8549
Epoch 96/100
400/400 - 110s - loss: 0.0968 - dice_multi: 0.8679
Epoch 97/100
400/400 - 109s - loss: 0.0945 - dice_multi: 0.8709
Epoch 98/100
400/400 - 109s - loss: 0.0907 - dice_multi: 0.8688
Epoch 99/100
400/400 - 109s - loss: 0.1116 - dice_multi: 0.8455
Epoch 100/100
400/400 - 109s - loss: 0.0965 - dice_multi: 0.8685
2021-09-20 01:36:34.167930: I tensorflow/stream_executor/cuda/cuda_blas.cc:1839] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
training time: 10998.972296714783
executation time:167.66496851444245
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [10 11 12 13 14 15 16 17 18 19]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 114s - loss: 0.6653 - dice_multi: 0.3710
Epoch 2/100
400/400 - 110s - loss: 0.5273 - dice_multi: 0.4273
Epoch 3/100
400/400 - 110s - loss: 0.4698 - dice_multi: 0.4728
Epoch 4/100
400/400 - 110s - loss: 0.4168 - dice_multi: 0.5154
Epoch 5/100
400/400 - 110s - loss: 0.3718 - dice_multi: 0.5624
Epoch 6/100
400/400 - 110s - loss: 0.3336 - dice_multi: 0.6068
Epoch 7/100
400/400 - 110s - loss: 0.2818 - dice_multi: 0.6576
Epoch 8/100
400/400 - 110s - loss: 0.2503 - dice_multi: 0.6944
Epoch 9/100
400/400 - 110s - loss: 0.2376 - dice_multi: 0.7090
Epoch 10/100
400/400 - 111s - loss: 0.2112 - dice_multi: 0.7383
Epoch 11/100
400/400 - 110s - loss: 0.2102 - dice_multi: 0.7371
Epoch 12/100
400/400 - 110s - loss: 0.2080 - dice_multi: 0.7492
Epoch 13/100
400/400 - 110s - loss: 0.1878 - dice_multi: 0.7576
Epoch 14/100
400/400 - 111s - loss: 0.1936 - dice_multi: 0.7686
Epoch 15/100
400/400 - 111s - loss: 0.1720 - dice_multi: 0.7792
Epoch 16/100
400/400 - 111s - loss: 0.1683 - dice_multi: 0.7826
Epoch 17/100
400/400 - 111s - loss: 0.1724 - dice_multi: 0.7872
Epoch 18/100
400/400 - 111s - loss: 0.1637 - dice_multi: 0.7975
Epoch 19/100
400/400 - 111s - loss: 0.1650 - dice_multi: 0.7927
Epoch 20/100
400/400 - 111s - loss: 0.1475 - dice_multi: 0.8077
Epoch 21/100
400/400 - 111s - loss: 0.1815 - dice_multi: 0.7748
Epoch 22/100
400/400 - 110s - loss: 0.1540 - dice_multi: 0.7997
Epoch 23/100
400/400 - 111s - loss: 0.1496 - dice_multi: 0.8078
Epoch 24/100
400/400 - 111s - loss: 0.1353 - dice_multi: 0.8169
Epoch 25/100
400/400 - 110s - loss: 0.1488 - dice_multi: 0.8113
Epoch 26/100
400/400 - 111s - loss: 0.1495 - dice_multi: 0.8110
Epoch 27/100
400/400 - 110s - loss: 0.1377 - dice_multi: 0.8229
Epoch 28/100
400/400 - 110s - loss: 0.1293 - dice_multi: 0.8257
Epoch 29/100
400/400 - 110s - loss: 0.1313 - dice_multi: 0.8205
Epoch 30/100
400/400 - 110s - loss: 0.1562 - dice_multi: 0.7976
Epoch 31/100
400/400 - 111s - loss: 0.1319 - dice_multi: 0.8246
Epoch 32/100
400/400 - 111s - loss: 0.1351 - dice_multi: 0.8160
Epoch 33/100
400/400 - 110s - loss: 0.1267 - dice_multi: 0.8300
Epoch 34/100
400/400 - 111s - loss: 0.1373 - dice_multi: 0.8268
Epoch 35/100
400/400 - 111s - loss: 0.1261 - dice_multi: 0.8305
Epoch 36/100
400/400 - 110s - loss: 0.1284 - dice_multi: 0.8272
Epoch 37/100
400/400 - 111s - loss: 0.1270 - dice_multi: 0.8290
Epoch 38/100
400/400 - 110s - loss: 0.1259 - dice_multi: 0.8348
Epoch 39/100
400/400 - 111s - loss: 0.1192 - dice_multi: 0.8380
Epoch 40/100
400/400 - 110s - loss: 0.1473 - dice_multi: 0.8150
Epoch 41/100
400/400 - 110s - loss: 0.1235 - dice_multi: 0.8429
Epoch 42/100
400/400 - 111s - loss: 0.1318 - dice_multi: 0.8290
Epoch 43/100
400/400 - 110s - loss: 0.1396 - dice_multi: 0.8159
Epoch 44/100
400/400 - 111s - loss: 0.1206 - dice_multi: 0.8409
Epoch 45/100
400/400 - 110s - loss: 0.1184 - dice_multi: 0.8393
Epoch 46/100
400/400 - 111s - loss: 0.1136 - dice_multi: 0.8414
Epoch 47/100
400/400 - 111s - loss: 0.1460 - dice_multi: 0.8169
Epoch 48/100
400/400 - 111s - loss: 0.1188 - dice_multi: 0.8385
Epoch 49/100
400/400 - 111s - loss: 0.1147 - dice_multi: 0.8491
Epoch 50/100
400/400 - 111s - loss: 0.1158 - dice_multi: 0.8435
Epoch 51/100
400/400 - 111s - loss: 0.1109 - dice_multi: 0.8450
Epoch 52/100
400/400 - 111s - loss: 0.1210 - dice_multi: 0.8420
Epoch 53/100
400/400 - 110s - loss: 0.1209 - dice_multi: 0.8338
Epoch 54/100
400/400 - 110s - loss: 0.1145 - dice_multi: 0.8418
Epoch 55/100
400/400 - 111s - loss: 0.1375 - dice_multi: 0.8215
Epoch 56/100
400/400 - 111s - loss: 0.1149 - dice_multi: 0.8464
Epoch 57/100
400/400 - 111s - loss: 0.1135 - dice_multi: 0.8470
Epoch 58/100
400/400 - 111s - loss: 0.1129 - dice_multi: 0.8444
Epoch 59/100
400/400 - 111s - loss: 0.1086 - dice_multi: 0.8506
Epoch 60/100
400/400 - 111s - loss: 0.1087 - dice_multi: 0.8490
Epoch 61/100
400/400 - 111s - loss: 0.1419 - dice_multi: 0.8213
Epoch 62/100
400/400 - 111s - loss: 0.1165 - dice_multi: 0.8442
Epoch 63/100
400/400 - 111s - loss: 0.1098 - dice_multi: 0.8505
Epoch 64/100
400/400 - 111s - loss: 0.1067 - dice_multi: 0.8504
Epoch 65/100
400/400 - 110s - loss: 0.1098 - dice_multi: 0.8530
Epoch 66/100
400/400 - 110s - loss: 0.1204 - dice_multi: 0.8432
Epoch 67/100
400/400 - 111s - loss: 0.1072 - dice_multi: 0.8557
Epoch 68/100
400/400 - 111s - loss: 0.1061 - dice_multi: 0.8515
Epoch 69/100
400/400 - 110s - loss: 0.1073 - dice_multi: 0.8544
Epoch 70/100
400/400 - 110s - loss: 0.1439 - dice_multi: 0.8179
Epoch 71/100
400/400 - 111s - loss: 0.1104 - dice_multi: 0.8450
Epoch 72/100
400/400 - 110s - loss: 0.1062 - dice_multi: 0.8490
Epoch 73/100
400/400 - 110s - loss: 0.1040 - dice_multi: 0.8530
Epoch 74/100
400/400 - 111s - loss: 0.1033 - dice_multi: 0.8524
Epoch 75/100
400/400 - 111s - loss: 0.1025 - dice_multi: 0.8457
Epoch 76/100
400/400 - 111s - loss: 0.1087 - dice_multi: 0.8527
Epoch 77/100
400/400 - 110s - loss: 0.1073 - dice_multi: 0.8492
Epoch 78/100
400/400 - 111s - loss: 0.1134 - dice_multi: 0.8399
Epoch 79/100
400/400 - 110s - loss: 0.1041 - dice_multi: 0.8501
Epoch 80/100
400/400 - 111s - loss: 0.1107 - dice_multi: 0.8523
Epoch 81/100
400/400 - 111s - loss: 0.1026 - dice_multi: 0.8565
Epoch 82/100
400/400 - 111s - loss: 0.1018 - dice_multi: 0.8615
Epoch 83/100
400/400 - 111s - loss: 0.1067 - dice_multi: 0.8465
Epoch 84/100
400/400 - 111s - loss: 0.1133 - dice_multi: 0.8474
Epoch 85/100
400/400 - 111s - loss: 0.1230 - dice_multi: 0.8345
Epoch 86/100
400/400 - 111s - loss: 0.1020 - dice_multi: 0.8509
Epoch 87/100
400/400 - 110s - loss: 0.1014 - dice_multi: 0.8560
Epoch 88/100
400/400 - 111s - loss: 0.1102 - dice_multi: 0.8481
Epoch 89/100
400/400 - 110s - loss: 0.1007 - dice_multi: 0.8537
Epoch 90/100
400/400 - 110s - loss: 0.1024 - dice_multi: 0.8579
Epoch 91/100
400/400 - 110s - loss: 0.1060 - dice_multi: 0.8524
Epoch 92/100
400/400 - 111s - loss: 0.1036 - dice_multi: 0.8548
Epoch 93/100
400/400 - 110s - loss: 0.1029 - dice_multi: 0.8540
Epoch 94/100
400/400 - 111s - loss: 0.0995 - dice_multi: 0.8527
Epoch 95/100
400/400 - 111s - loss: 0.0985 - dice_multi: 0.8587
Epoch 96/100
400/400 - 110s - loss: 0.0991 - dice_multi: 0.8573
Epoch 97/100
400/400 - 110s - loss: 0.1029 - dice_multi: 0.8577
Epoch 98/100
400/400 - 110s - loss: 0.1104 - dice_multi: 0.8541
Epoch 99/100
400/400 - 111s - loss: 0.1151 - dice_multi: 0.8459
Epoch 100/100
400/400 - 111s - loss: 0.0996 - dice_multi: 0.8607
training time: 11074.22809457779
executation time:166.61103138923644
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [20 21 22 23 24 25 26 27 28 29]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 113s - loss: 0.6422 - dice_multi: 0.3583
Epoch 2/100
400/400 - 108s - loss: 0.5013 - dice_multi: 0.4224
Epoch 3/100
400/400 - 108s - loss: 0.4709 - dice_multi: 0.4621
Epoch 4/100
400/400 - 109s - loss: 0.4175 - dice_multi: 0.4952
Epoch 5/100
400/400 - 109s - loss: 0.3924 - dice_multi: 0.5303
Epoch 6/100
400/400 - 109s - loss: 0.3482 - dice_multi: 0.5615
Epoch 7/100
400/400 - 109s - loss: 0.3517 - dice_multi: 0.5855
Epoch 8/100
400/400 - 110s - loss: 0.3018 - dice_multi: 0.6300
Epoch 9/100
400/400 - 109s - loss: 0.2899 - dice_multi: 0.6407
Epoch 10/100
400/400 - 108s - loss: 0.2649 - dice_multi: 0.6698
Epoch 11/100
400/400 - 108s - loss: 0.2353 - dice_multi: 0.6979
Epoch 12/100
400/400 - 109s - loss: 0.2241 - dice_multi: 0.7182
Epoch 13/100
400/400 - 109s - loss: 0.2233 - dice_multi: 0.7146
Epoch 14/100
400/400 - 109s - loss: 0.2057 - dice_multi: 0.7283
Epoch 15/100
400/400 - 109s - loss: 0.1967 - dice_multi: 0.7533
Epoch 16/100
400/400 - 109s - loss: 0.1942 - dice_multi: 0.7492
Epoch 17/100
400/400 - 109s - loss: 0.1851 - dice_multi: 0.7595
Epoch 18/100
400/400 - 109s - loss: 0.1791 - dice_multi: 0.7650
Epoch 19/100
400/400 - 109s - loss: 0.1946 - dice_multi: 0.7549
Epoch 20/100
400/400 - 109s - loss: 0.1614 - dice_multi: 0.7786
Epoch 21/100
400/400 - 109s - loss: 0.1581 - dice_multi: 0.7871
Epoch 22/100
400/400 - 109s - loss: 0.1558 - dice_multi: 0.7908
Epoch 23/100
400/400 - 109s - loss: 0.1623 - dice_multi: 0.7852
Epoch 24/100
400/400 - 109s - loss: 0.1635 - dice_multi: 0.7864
Epoch 25/100
400/400 - 109s - loss: 0.1513 - dice_multi: 0.8039
Epoch 26/100
400/400 - 109s - loss: 0.1695 - dice_multi: 0.7818
Epoch 27/100
400/400 - 109s - loss: 0.1422 - dice_multi: 0.8048
Epoch 28/100
400/400 - 109s - loss: 0.1416 - dice_multi: 0.8186
Epoch 29/100
400/400 - 109s - loss: 0.1533 - dice_multi: 0.7921
Epoch 30/100
400/400 - 109s - loss: 0.1511 - dice_multi: 0.8023
Epoch 31/100
400/400 - 109s - loss: 0.1436 - dice_multi: 0.8038
Epoch 32/100
400/400 - 109s - loss: 0.1443 - dice_multi: 0.8044
Epoch 33/100
400/400 - 109s - loss: 0.1353 - dice_multi: 0.8212
Epoch 34/100
400/400 - 108s - loss: 0.1379 - dice_multi: 0.8156
Epoch 35/100
400/400 - 109s - loss: 0.1265 - dice_multi: 0.8248
Epoch 36/100
400/400 - 109s - loss: 0.1598 - dice_multi: 0.7994
Epoch 37/100
400/400 - 109s - loss: 0.1269 - dice_multi: 0.8221
Epoch 38/100
400/400 - 109s - loss: 0.1247 - dice_multi: 0.8227
Epoch 39/100
400/400 - 109s - loss: 0.1270 - dice_multi: 0.8181
Epoch 40/100
400/400 - 109s - loss: 0.1284 - dice_multi: 0.8178
Epoch 41/100
400/400 - 108s - loss: 0.1422 - dice_multi: 0.8180
Epoch 42/100
400/400 - 109s - loss: 0.1278 - dice_multi: 0.8312
Epoch 43/100
400/400 - 108s - loss: 0.1188 - dice_multi: 0.8200
Epoch 44/100
400/400 - 109s - loss: 0.1221 - dice_multi: 0.8339
Epoch 45/100
400/400 - 109s - loss: 0.1229 - dice_multi: 0.8265
Epoch 46/100
400/400 - 109s - loss: 0.1262 - dice_multi: 0.8275
Epoch 47/100
400/400 - 109s - loss: 0.1211 - dice_multi: 0.8234
Epoch 48/100
400/400 - 109s - loss: 0.1173 - dice_multi: 0.8426
Epoch 49/100
400/400 - 109s - loss: 0.1220 - dice_multi: 0.8339
Epoch 50/100
400/400 - 109s - loss: 0.1174 - dice_multi: 0.8373
Epoch 51/100
400/400 - 109s - loss: 0.1228 - dice_multi: 0.8251
Epoch 52/100
400/400 - 109s - loss: 0.1379 - dice_multi: 0.8117
Epoch 53/100
400/400 - 109s - loss: 0.1167 - dice_multi: 0.8344
Epoch 54/100
400/400 - 109s - loss: 0.1207 - dice_multi: 0.8338
Epoch 55/100
400/400 - 109s - loss: 0.1193 - dice_multi: 0.8280
Epoch 56/100
400/400 - 109s - loss: 0.1111 - dice_multi: 0.8370
Epoch 57/100
400/400 - 109s - loss: 0.1122 - dice_multi: 0.8416
Epoch 58/100
400/400 - 109s - loss: 0.1433 - dice_multi: 0.8015
Epoch 59/100
400/400 - 109s - loss: 0.1209 - dice_multi: 0.8321
Epoch 60/100
400/400 - 109s - loss: 0.1132 - dice_multi: 0.8340
Epoch 61/100
400/400 - 109s - loss: 0.1106 - dice_multi: 0.8375
Epoch 62/100
400/400 - 109s - loss: 0.1186 - dice_multi: 0.8402
Epoch 63/100
400/400 - 109s - loss: 0.1131 - dice_multi: 0.8434
Epoch 64/100
400/400 - 109s - loss: 0.1081 - dice_multi: 0.8401
Epoch 65/100
400/400 - 109s - loss: 0.1115 - dice_multi: 0.8433
Epoch 66/100
400/400 - 109s - loss: 0.1107 - dice_multi: 0.8391
Epoch 67/100
400/400 - 108s - loss: 0.1080 - dice_multi: 0.8475
Epoch 68/100
400/400 - 109s - loss: 0.1579 - dice_multi: 0.7982
Epoch 69/100
400/400 - 109s - loss: 0.1178 - dice_multi: 0.8369
Epoch 70/100
400/400 - 109s - loss: 0.1097 - dice_multi: 0.8464
Epoch 71/100
400/400 - 109s - loss: 0.1081 - dice_multi: 0.8500
Epoch 72/100
400/400 - 109s - loss: 0.1042 - dice_multi: 0.8429
Epoch 73/100
400/400 - 108s - loss: 0.1104 - dice_multi: 0.8371
Epoch 74/100
400/400 - 109s - loss: 0.1102 - dice_multi: 0.8386
Epoch 75/100
400/400 - 109s - loss: 0.1069 - dice_multi: 0.8451
Epoch 76/100
400/400 - 109s - loss: 0.1044 - dice_multi: 0.8494
Epoch 77/100
400/400 - 109s - loss: 0.1090 - dice_multi: 0.8416
Epoch 78/100
400/400 - 109s - loss: 0.1320 - dice_multi: 0.8174
Epoch 79/100
400/400 - 109s - loss: 0.1146 - dice_multi: 0.8443
Epoch 80/100
400/400 - 109s - loss: 0.1085 - dice_multi: 0.8490
Epoch 81/100
400/400 - 110s - loss: 0.1051 - dice_multi: 0.8547
Epoch 82/100
400/400 - 109s - loss: 0.1026 - dice_multi: 0.8463
Epoch 83/100
400/400 - 109s - loss: 0.1180 - dice_multi: 0.8373
Epoch 84/100
400/400 - 109s - loss: 0.1052 - dice_multi: 0.8514
Epoch 85/100
400/400 - 109s - loss: 0.1020 - dice_multi: 0.8565
Epoch 86/100
400/400 - 109s - loss: 0.1324 - dice_multi: 0.8272
Epoch 87/100
400/400 - 109s - loss: 0.1073 - dice_multi: 0.8493
Epoch 88/100
400/400 - 109s - loss: 0.1032 - dice_multi: 0.8485
Epoch 89/100
400/400 - 109s - loss: 0.1007 - dice_multi: 0.8507
Epoch 90/100
400/400 - 109s - loss: 0.1029 - dice_multi: 0.8556
Epoch 91/100
400/400 - 109s - loss: 0.1014 - dice_multi: 0.8524
Epoch 92/100
400/400 - 109s - loss: 0.1004 - dice_multi: 0.8462
Epoch 93/100
400/400 - 108s - loss: 0.1303 - dice_multi: 0.8213
Epoch 94/100
400/400 - 109s - loss: 0.1040 - dice_multi: 0.8568
Epoch 95/100
400/400 - 109s - loss: 0.1002 - dice_multi: 0.8512
Epoch 96/100
400/400 - 110s - loss: 0.0991 - dice_multi: 0.8469
Epoch 97/100
400/400 - 109s - loss: 0.1039 - dice_multi: 0.8481
Epoch 98/100
400/400 - 109s - loss: 0.1103 - dice_multi: 0.8439
Epoch 99/100
400/400 - 109s - loss: 0.1001 - dice_multi: 0.8520
Epoch 100/100
400/400 - 109s - loss: 0.0990 - dice_multi: 0.8599
training time: 10907.174207687378
executation time:167.09028112888336
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]
training set size:  30
testing set:  [30 31 32 33 34 35 36 37 38 39 40]
testing set size:  11
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 113s - loss: 0.6655 - dice_multi: 0.4019
Epoch 2/100
400/400 - 109s - loss: 0.5331 - dice_multi: 0.4742
Epoch 3/100
400/400 - 109s - loss: 0.4376 - dice_multi: 0.5380
Epoch 4/100
400/400 - 110s - loss: 0.3858 - dice_multi: 0.5831
Epoch 5/100
400/400 - 110s - loss: 0.3350 - dice_multi: 0.6382
Epoch 6/100
400/400 - 110s - loss: 0.2953 - dice_multi: 0.6826
Epoch 7/100
400/400 - 110s - loss: 0.2648 - dice_multi: 0.7052
Epoch 8/100
400/400 - 110s - loss: 0.2552 - dice_multi: 0.7218
Epoch 9/100
400/400 - 110s - loss: 0.2318 - dice_multi: 0.7562
Epoch 10/100
400/400 - 111s - loss: 0.2045 - dice_multi: 0.7749
Epoch 11/100
400/400 - 111s - loss: 0.2043 - dice_multi: 0.7718
Epoch 12/100
400/400 - 110s - loss: 0.1858 - dice_multi: 0.7883
Epoch 13/100
400/400 - 110s - loss: 0.1807 - dice_multi: 0.7891
Epoch 14/100
400/400 - 110s - loss: 0.1823 - dice_multi: 0.7978
Epoch 15/100
400/400 - 110s - loss: 0.1779 - dice_multi: 0.8011
Epoch 16/100
400/400 - 110s - loss: 0.1864 - dice_multi: 0.8036
Epoch 17/100
400/400 - 110s - loss: 0.1583 - dice_multi: 0.8179
Epoch 18/100
400/400 - 110s - loss: 0.1632 - dice_multi: 0.8160
Epoch 19/100
400/400 - 110s - loss: 0.1912 - dice_multi: 0.7915
Epoch 20/100
400/400 - 110s - loss: 0.1525 - dice_multi: 0.8257
Epoch 21/100
400/400 - 110s - loss: 0.1504 - dice_multi: 0.8307
Epoch 22/100
400/400 - 110s - loss: 0.1598 - dice_multi: 0.8185
Epoch 23/100
400/400 - 110s - loss: 0.1470 - dice_multi: 0.8323
Epoch 24/100
400/400 - 111s - loss: 0.1593 - dice_multi: 0.8205
Epoch 25/100
400/400 - 110s - loss: 0.1565 - dice_multi: 0.8213
Epoch 26/100
400/400 - 110s - loss: 0.1452 - dice_multi: 0.8355
Epoch 27/100
400/400 - 111s - loss: 0.1424 - dice_multi: 0.8431
Epoch 28/100
400/400 - 110s - loss: 0.1397 - dice_multi: 0.8402
Epoch 29/100
400/400 - 111s - loss: 0.1607 - dice_multi: 0.8163
Epoch 30/100
400/400 - 110s - loss: 0.1370 - dice_multi: 0.8428
Epoch 31/100
400/400 - 110s - loss: 0.1313 - dice_multi: 0.8474
Epoch 32/100
400/400 - 110s - loss: 0.1597 - dice_multi: 0.8218
Epoch 33/100
400/400 - 111s - loss: 0.1421 - dice_multi: 0.8366
Epoch 34/100
400/400 - 110s - loss: 0.1306 - dice_multi: 0.8406
Epoch 35/100
400/400 - 111s - loss: 0.1306 - dice_multi: 0.8472
Epoch 36/100
400/400 - 110s - loss: 0.1615 - dice_multi: 0.8157
Epoch 37/100
400/400 - 110s - loss: 0.1287 - dice_multi: 0.8362
Epoch 38/100
400/400 - 110s - loss: 0.1273 - dice_multi: 0.8499
Epoch 39/100
400/400 - 110s - loss: 0.1256 - dice_multi: 0.8544
Epoch 40/100
400/400 - 111s - loss: 0.1365 - dice_multi: 0.8440
Epoch 41/100
400/400 - 110s - loss: 0.1282 - dice_multi: 0.8551
Epoch 42/100
400/400 - 110s - loss: 0.1241 - dice_multi: 0.8466
Epoch 43/100
400/400 - 110s - loss: 0.1256 - dice_multi: 0.8536
Epoch 44/100
400/400 - 110s - loss: 0.1467 - dice_multi: 0.8275
Epoch 45/100
400/400 - 110s - loss: 0.1425 - dice_multi: 0.8385
Epoch 46/100
400/400 - 110s - loss: 0.1256 - dice_multi: 0.8548
Epoch 47/100
400/400 - 110s - loss: 0.1271 - dice_multi: 0.8544
Epoch 48/100
400/400 - 110s - loss: 0.1196 - dice_multi: 0.8529
Epoch 49/100
400/400 - 110s - loss: 0.1183 - dice_multi: 0.8538
Epoch 50/100
400/400 - 110s - loss: 0.1331 - dice_multi: 0.8501
Epoch 51/100
400/400 - 110s - loss: 0.1499 - dice_multi: 0.8334
Epoch 52/100
400/400 - 110s - loss: 0.1311 - dice_multi: 0.8498
Epoch 53/100
400/400 - 110s - loss: 0.1198 - dice_multi: 0.8546
Epoch 54/100
400/400 - 110s - loss: 0.1172 - dice_multi: 0.8535
Epoch 55/100
400/400 - 110s - loss: 0.1157 - dice_multi: 0.8617
Epoch 56/100
400/400 - 110s - loss: 0.1197 - dice_multi: 0.8538
Epoch 57/100
400/400 - 110s - loss: 0.1199 - dice_multi: 0.8574
Epoch 58/100
400/400 - 110s - loss: 0.1194 - dice_multi: 0.8568
Epoch 59/100
400/400 - 110s - loss: 0.1141 - dice_multi: 0.8585
Epoch 60/100
400/400 - 111s - loss: 0.1543 - dice_multi: 0.8288
Epoch 61/100
400/400 - 110s - loss: 0.1230 - dice_multi: 0.8597
Epoch 62/100
400/400 - 110s - loss: 0.1188 - dice_multi: 0.8609
Epoch 63/100
400/400 - 110s - loss: 0.1143 - dice_multi: 0.8658
Epoch 64/100
400/400 - 110s - loss: 0.1154 - dice_multi: 0.8600
Epoch 65/100
400/400 - 110s - loss: 0.1124 - dice_multi: 0.8552
Epoch 66/100
400/400 - 110s - loss: 0.1128 - dice_multi: 0.8631
Epoch 67/100
400/400 - 110s - loss: 0.1116 - dice_multi: 0.8694
Epoch 68/100
400/400 - 110s - loss: 0.1100 - dice_multi: 0.8643
Epoch 69/100
400/400 - 110s - loss: 0.1545 - dice_multi: 0.8203
Epoch 70/100
400/400 - 110s - loss: 0.1190 - dice_multi: 0.8546
Epoch 71/100
400/400 - 110s - loss: 0.1140 - dice_multi: 0.8699
Epoch 72/100
400/400 - 110s - loss: 0.1114 - dice_multi: 0.8689
Epoch 73/100
400/400 - 110s - loss: 0.1115 - dice_multi: 0.8597
Epoch 74/100
400/400 - 110s - loss: 0.1128 - dice_multi: 0.8546
Epoch 75/100
400/400 - 110s - loss: 0.1175 - dice_multi: 0.8604
Epoch 76/100
400/400 - 110s - loss: 0.1074 - dice_multi: 0.8690
Epoch 77/100
400/400 - 110s - loss: 0.1274 - dice_multi: 0.8547
Epoch 78/100
400/400 - 110s - loss: 0.1372 - dice_multi: 0.8426
Epoch 79/100
400/400 - 110s - loss: 0.1163 - dice_multi: 0.8638
Epoch 80/100
400/400 - 110s - loss: 0.1130 - dice_multi: 0.8642
Epoch 81/100
400/400 - 110s - loss: 0.1113 - dice_multi: 0.8662
Epoch 82/100
400/400 - 110s - loss: 0.1101 - dice_multi: 0.8660
Epoch 83/100
400/400 - 111s - loss: 0.1073 - dice_multi: 0.8715
Epoch 84/100
400/400 - 110s - loss: 0.1042 - dice_multi: 0.8682
Epoch 85/100
400/400 - 110s - loss: 0.1162 - dice_multi: 0.8560
Epoch 86/100
400/400 - 110s - loss: 0.1146 - dice_multi: 0.8620
Epoch 87/100
400/400 - 111s - loss: 0.1062 - dice_multi: 0.8689
Epoch 88/100
400/400 - 110s - loss: 0.1099 - dice_multi: 0.8683
Epoch 89/100
400/400 - 110s - loss: 0.1314 - dice_multi: 0.8409
Epoch 90/100
400/400 - 110s - loss: 0.1089 - dice_multi: 0.8676
Epoch 91/100
400/400 - 110s - loss: 0.1049 - dice_multi: 0.8605
Epoch 92/100
400/400 - 110s - loss: 0.1090 - dice_multi: 0.8712
Epoch 93/100
400/400 - 110s - loss: 0.1055 - dice_multi: 0.8711
Epoch 94/100
400/400 - 110s - loss: 0.1046 - dice_multi: 0.8711
Epoch 95/100
400/400 - 110s - loss: 0.1037 - dice_multi: 0.8773
Epoch 96/100
400/400 - 110s - loss: 0.1369 - dice_multi: 0.8417
Epoch 97/100
400/400 - 110s - loss: 0.1094 - dice_multi: 0.8630
Epoch 98/100
400/400 - 110s - loss: 0.1038 - dice_multi: 0.8631
Epoch 99/100
400/400 - 110s - loss: 0.1015 - dice_multi: 0.8755
Epoch 100/100
400/400 - 110s - loss: 0.1086 - dice_multi: 0.8665
training time: 11042.133910655975
executation time:167.91115162589332
[0.99299574 0.94819695 0.823008   0.89942366 0.84047663 0.9065025
 0.8998    ]
