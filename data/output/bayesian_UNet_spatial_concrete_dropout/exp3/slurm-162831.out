Loading tensorflow/2.5
  Loading requirement: cuda11.2/toolkit/11.2.2 cudnn8.1-cuda11.2/8.1.1.33
    hdf5_18/1.8.20
bayesian U-Net with Spatial3DConcreteDropout
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2021-09-21 02:53:16.800900: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(41, 256, 128, 256)
..loading data finished Tue Sep 21 02:53:44 2021
2021-09-21 02:53:44.043710: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-09-21 02:53:44.098010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-21 02:53:44.098059: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-21 02:53:44.105085: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-21 02:53:44.105170: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-09-21 02:53:44.108016: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-09-21 02:53:44.108801: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-09-21 02:53:44.109768: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-09-21 02:53:44.111108: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-09-21 02:53:44.111748: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-21 02:53:44.115599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-21 02:53:44.120554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-21 02:53:44.124392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-21 02:53:44.124433: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-21 02:53:44.630276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-21 02:53:44.630325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-09-21 02:53:44.630336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-09-21 02:53:44.636744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38184 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:3b:00.0, compute capability: 8.0)
WARNING:tensorflow:AutoGraph could not transform <bound method Spatial3DConcreteDropout.call of <model.ConcreteDropout.spatialConcreteDropout.Spatial3DConcreteDropout object at 0x2aad6ccdc760>> and will run it as-is.
Cause: code mixing tabs and spaces for indentation is not allowed
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
---------fold--1---------
training set:  [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [0 1 2 3 4 5 6 7 8 9]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
2021-09-21 02:53:47.786972: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-09-21 02:53:47.787459: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2100000000 Hz
2021-09-21 02:53:52.015616: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-21 02:53:53.026086: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2021-09-21 02:53:54.017427: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-21 02:53:54.820387: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 138s - loss: 0.6725 - dice_multi: 0.3831
Epoch 2/100
400/400 - 108s - loss: 0.5017 - dice_multi: 0.4629
Epoch 3/100
400/400 - 108s - loss: 0.4615 - dice_multi: 0.4986
Epoch 4/100
400/400 - 109s - loss: 0.3906 - dice_multi: 0.5398
Epoch 5/100
400/400 - 108s - loss: 0.3446 - dice_multi: 0.5882
Epoch 6/100
400/400 - 108s - loss: 0.2998 - dice_multi: 0.6357
Epoch 7/100
400/400 - 108s - loss: 0.2809 - dice_multi: 0.6627
Epoch 8/100
400/400 - 108s - loss: 0.2504 - dice_multi: 0.6945
Epoch 9/100
400/400 - 109s - loss: 0.2215 - dice_multi: 0.7331
Epoch 10/100
400/400 - 109s - loss: 0.2066 - dice_multi: 0.7465
Epoch 11/100
400/400 - 109s - loss: 0.1977 - dice_multi: 0.7589
Epoch 12/100
400/400 - 109s - loss: 0.1914 - dice_multi: 0.7747
Epoch 13/100
400/400 - 109s - loss: 0.1887 - dice_multi: 0.7691
Epoch 14/100
400/400 - 109s - loss: 0.1708 - dice_multi: 0.7869
Epoch 15/100
400/400 - 109s - loss: 0.1680 - dice_multi: 0.7937
Epoch 16/100
400/400 - 109s - loss: 0.1630 - dice_multi: 0.7980
Epoch 17/100
400/400 - 109s - loss: 0.1605 - dice_multi: 0.8009
Epoch 18/100
400/400 - 109s - loss: 0.1488 - dice_multi: 0.8137
Epoch 19/100
400/400 - 108s - loss: 0.1541 - dice_multi: 0.8062
Epoch 20/100
400/400 - 109s - loss: 0.1483 - dice_multi: 0.8153
Epoch 21/100
400/400 - 109s - loss: 0.1618 - dice_multi: 0.7975
Epoch 22/100
400/400 - 109s - loss: 0.1436 - dice_multi: 0.8233
Epoch 23/100
400/400 - 109s - loss: 0.1822 - dice_multi: 0.7839
Epoch 24/100
400/400 - 108s - loss: 0.1422 - dice_multi: 0.8228
Epoch 25/100
400/400 - 108s - loss: 0.1324 - dice_multi: 0.8339
Epoch 26/100
400/400 - 109s - loss: 0.1398 - dice_multi: 0.8299
Epoch 27/100
400/400 - 108s - loss: 0.1333 - dice_multi: 0.8292
Epoch 28/100
400/400 - 108s - loss: 0.1279 - dice_multi: 0.8383
Epoch 29/100
400/400 - 109s - loss: 0.1345 - dice_multi: 0.8334
Epoch 30/100
400/400 - 109s - loss: 0.1385 - dice_multi: 0.8186
Epoch 31/100
400/400 - 108s - loss: 0.1235 - dice_multi: 0.8380
Epoch 32/100
400/400 - 109s - loss: 0.1223 - dice_multi: 0.8442
Epoch 33/100
400/400 - 108s - loss: 0.1240 - dice_multi: 0.8473
Epoch 34/100
400/400 - 109s - loss: 0.1643 - dice_multi: 0.8032
Epoch 35/100
400/400 - 109s - loss: 0.1270 - dice_multi: 0.8406
Epoch 36/100
400/400 - 109s - loss: 0.1266 - dice_multi: 0.8409
Epoch 37/100
400/400 - 109s - loss: 0.1223 - dice_multi: 0.8446
Epoch 38/100
400/400 - 109s - loss: 0.1326 - dice_multi: 0.8370
Epoch 39/100
400/400 - 109s - loss: 0.1257 - dice_multi: 0.8357
Epoch 40/100
400/400 - 109s - loss: 0.1170 - dice_multi: 0.8448
Epoch 41/100
400/400 - 109s - loss: 0.1151 - dice_multi: 0.8527
Epoch 42/100
400/400 - 109s - loss: 0.1152 - dice_multi: 0.8388
Epoch 43/100
400/400 - 109s - loss: 0.1468 - dice_multi: 0.8180
Epoch 44/100
400/400 - 109s - loss: 0.1230 - dice_multi: 0.8477
Epoch 45/100
400/400 - 109s - loss: 0.1162 - dice_multi: 0.8525
Epoch 46/100
400/400 - 109s - loss: 0.1146 - dice_multi: 0.8459
Epoch 47/100
400/400 - 109s - loss: 0.1188 - dice_multi: 0.8442
Epoch 48/100
400/400 - 109s - loss: 0.1148 - dice_multi: 0.8548
Epoch 49/100
400/400 - 109s - loss: 0.1242 - dice_multi: 0.8366
Epoch 50/100
400/400 - 109s - loss: 0.1111 - dice_multi: 0.8584
Epoch 51/100
400/400 - 109s - loss: 0.1096 - dice_multi: 0.8557
Epoch 52/100
400/400 - 109s - loss: 0.1073 - dice_multi: 0.8476
Epoch 53/100
400/400 - 110s - loss: 0.1140 - dice_multi: 0.8435
Epoch 54/100
400/400 - 110s - loss: 0.1108 - dice_multi: 0.8527
Epoch 55/100
400/400 - 109s - loss: 0.1325 - dice_multi: 0.8365
Epoch 56/100
400/400 - 110s - loss: 0.1116 - dice_multi: 0.8522
Epoch 57/100
400/400 - 109s - loss: 0.1052 - dice_multi: 0.8592
Epoch 58/100
400/400 - 110s - loss: 0.1032 - dice_multi: 0.8586
Epoch 59/100
400/400 - 109s - loss: 0.1093 - dice_multi: 0.8541
Epoch 60/100
400/400 - 110s - loss: 0.1059 - dice_multi: 0.8601
Epoch 61/100
400/400 - 109s - loss: 0.1058 - dice_multi: 0.8586
Epoch 62/100
400/400 - 109s - loss: 0.1044 - dice_multi: 0.8628
Epoch 63/100
400/400 - 110s - loss: 0.1461 - dice_multi: 0.8271
Epoch 64/100
400/400 - 110s - loss: 0.1071 - dice_multi: 0.8582
Epoch 65/100
400/400 - 110s - loss: 0.1066 - dice_multi: 0.8573
Epoch 66/100
400/400 - 109s - loss: 0.1040 - dice_multi: 0.8595
Epoch 67/100
400/400 - 110s - loss: 0.1030 - dice_multi: 0.8619
Epoch 68/100
400/400 - 110s - loss: 0.1012 - dice_multi: 0.8612
Epoch 69/100
400/400 - 109s - loss: 0.1229 - dice_multi: 0.8559
Epoch 70/100
400/400 - 110s - loss: 0.1192 - dice_multi: 0.8377
Epoch 71/100
400/400 - 110s - loss: 0.1072 - dice_multi: 0.8574
Epoch 72/100
400/400 - 110s - loss: 0.1015 - dice_multi: 0.8653
Epoch 73/100
400/400 - 109s - loss: 0.1014 - dice_multi: 0.8651
Epoch 74/100
400/400 - 109s - loss: 0.0995 - dice_multi: 0.8639
Epoch 75/100
400/400 - 110s - loss: 0.1030 - dice_multi: 0.8598
Epoch 76/100
400/400 - 110s - loss: 0.1137 - dice_multi: 0.8549
Epoch 77/100
400/400 - 110s - loss: 0.0990 - dice_multi: 0.8632
Epoch 78/100
400/400 - 110s - loss: 0.0997 - dice_multi: 0.8644
Epoch 79/100
400/400 - 110s - loss: 0.1089 - dice_multi: 0.8622
Epoch 80/100
400/400 - 109s - loss: 0.1162 - dice_multi: 0.8474
Epoch 81/100
400/400 - 110s - loss: 0.1119 - dice_multi: 0.8578
Epoch 82/100
400/400 - 110s - loss: 0.1005 - dice_multi: 0.8593
Epoch 83/100
400/400 - 110s - loss: 0.0975 - dice_multi: 0.8704
Epoch 84/100
400/400 - 110s - loss: 0.0960 - dice_multi: 0.8659
Epoch 85/100
400/400 - 110s - loss: 0.0988 - dice_multi: 0.8648
Epoch 86/100
400/400 - 110s - loss: 0.0983 - dice_multi: 0.8644
Epoch 87/100
400/400 - 110s - loss: 0.1088 - dice_multi: 0.8548
Epoch 88/100
400/400 - 110s - loss: 0.1003 - dice_multi: 0.8642
Epoch 89/100
400/400 - 110s - loss: 0.0953 - dice_multi: 0.8723
Epoch 90/100
400/400 - 110s - loss: 0.0948 - dice_multi: 0.8728
Epoch 91/100
400/400 - 110s - loss: 0.0986 - dice_multi: 0.8639
Epoch 92/100
400/400 - 110s - loss: 0.0992 - dice_multi: 0.8697
Epoch 93/100
400/400 - 110s - loss: 0.1219 - dice_multi: 0.8409
Epoch 94/100
400/400 - 110s - loss: 0.1020 - dice_multi: 0.8675
Epoch 95/100
400/400 - 109s - loss: 0.0954 - dice_multi: 0.8705
Epoch 96/100
400/400 - 110s - loss: 0.0945 - dice_multi: 0.8669
Epoch 97/100
400/400 - 110s - loss: 0.0976 - dice_multi: 0.8666
Epoch 98/100
400/400 - 110s - loss: 0.0925 - dice_multi: 0.8702
Epoch 99/100
400/400 - 109s - loss: 0.0955 - dice_multi: 0.8673
Epoch 100/100
400/400 - 110s - loss: 0.0947 - dice_multi: 0.8715
2021-09-21 05:56:29.571276: I tensorflow/stream_executor/cuda/cuda_blas.cc:1839] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
training time: 10961.991844892502
executation time:167.91399540901185
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [10 11 12 13 14 15 16 17 18 19]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 113s - loss: 0.6805 - dice_multi: 0.3717
Epoch 2/100
400/400 - 109s - loss: 0.5532 - dice_multi: 0.4174
Epoch 3/100
400/400 - 110s - loss: 0.4729 - dice_multi: 0.4583
Epoch 4/100
400/400 - 110s - loss: 0.4449 - dice_multi: 0.5078
Epoch 5/100
400/400 - 110s - loss: 0.3754 - dice_multi: 0.5551
Epoch 6/100
400/400 - 110s - loss: 0.3405 - dice_multi: 0.6000
Epoch 7/100
400/400 - 110s - loss: 0.2985 - dice_multi: 0.6458
Epoch 8/100
400/400 - 110s - loss: 0.2614 - dice_multi: 0.6719
Epoch 9/100
400/400 - 110s - loss: 0.2333 - dice_multi: 0.7020
Epoch 10/100
400/400 - 110s - loss: 0.2302 - dice_multi: 0.7190
Epoch 11/100
400/400 - 110s - loss: 0.2082 - dice_multi: 0.7396
Epoch 12/100
400/400 - 110s - loss: 0.1954 - dice_multi: 0.7481
Epoch 13/100
400/400 - 110s - loss: 0.1949 - dice_multi: 0.7561
Epoch 14/100
400/400 - 110s - loss: 0.1973 - dice_multi: 0.7613
Epoch 15/100
400/400 - 110s - loss: 0.1833 - dice_multi: 0.7674
Epoch 16/100
400/400 - 110s - loss: 0.1808 - dice_multi: 0.7736
Epoch 17/100
400/400 - 110s - loss: 0.1660 - dice_multi: 0.7739
Epoch 18/100
400/400 - 110s - loss: 0.1716 - dice_multi: 0.7857
Epoch 19/100
400/400 - 110s - loss: 0.1571 - dice_multi: 0.7922
Epoch 20/100
400/400 - 110s - loss: 0.1652 - dice_multi: 0.7882
Epoch 21/100
400/400 - 110s - loss: 0.1467 - dice_multi: 0.8096
Epoch 22/100
400/400 - 110s - loss: 0.1479 - dice_multi: 0.8168
Epoch 23/100
400/400 - 110s - loss: 0.1532 - dice_multi: 0.7987
Epoch 24/100
400/400 - 110s - loss: 0.1527 - dice_multi: 0.7996
Epoch 25/100
400/400 - 110s - loss: 0.1400 - dice_multi: 0.8160
Epoch 26/100
400/400 - 110s - loss: 0.1414 - dice_multi: 0.8192
Epoch 27/100
400/400 - 110s - loss: 0.1431 - dice_multi: 0.8085
Epoch 28/100
400/400 - 110s - loss: 0.1427 - dice_multi: 0.8068
Epoch 29/100
400/400 - 110s - loss: 0.1399 - dice_multi: 0.8171
Epoch 30/100
400/400 - 110s - loss: 0.1348 - dice_multi: 0.8250
Epoch 31/100
400/400 - 110s - loss: 0.1340 - dice_multi: 0.8244
Epoch 32/100
400/400 - 109s - loss: 0.1446 - dice_multi: 0.8109
Epoch 33/100
400/400 - 110s - loss: 0.1279 - dice_multi: 0.8368
Epoch 34/100
400/400 - 110s - loss: 0.1250 - dice_multi: 0.8340
Epoch 35/100
400/400 - 110s - loss: 0.1613 - dice_multi: 0.7956
Epoch 36/100
400/400 - 110s - loss: 0.1268 - dice_multi: 0.8323
Epoch 37/100
400/400 - 110s - loss: 0.1321 - dice_multi: 0.8231
Epoch 38/100
400/400 - 110s - loss: 0.1298 - dice_multi: 0.8190
Epoch 39/100
400/400 - 110s - loss: 0.1303 - dice_multi: 0.8257
Epoch 40/100
400/400 - 110s - loss: 0.1193 - dice_multi: 0.8384
Epoch 41/100
400/400 - 110s - loss: 0.1187 - dice_multi: 0.8381
Epoch 42/100
400/400 - 110s - loss: 0.1533 - dice_multi: 0.7900
Epoch 43/100
400/400 - 110s - loss: 0.1302 - dice_multi: 0.8234
Epoch 44/100
400/400 - 110s - loss: 0.1226 - dice_multi: 0.8341
Epoch 45/100
400/400 - 110s - loss: 0.1180 - dice_multi: 0.8398
Epoch 46/100
400/400 - 110s - loss: 0.1202 - dice_multi: 0.8354
Epoch 47/100
400/400 - 110s - loss: 0.1162 - dice_multi: 0.8377
Epoch 48/100
400/400 - 110s - loss: 0.1215 - dice_multi: 0.8456
Epoch 49/100
400/400 - 110s - loss: 0.1157 - dice_multi: 0.8367
Epoch 50/100
400/400 - 110s - loss: 0.1296 - dice_multi: 0.8194
Epoch 51/100
400/400 - 110s - loss: 0.1162 - dice_multi: 0.8398
Epoch 52/100
400/400 - 110s - loss: 0.1165 - dice_multi: 0.8384
Epoch 53/100
400/400 - 110s - loss: 0.1153 - dice_multi: 0.8402
Epoch 54/100
400/400 - 110s - loss: 0.1243 - dice_multi: 0.8280
Epoch 55/100
400/400 - 110s - loss: 0.1236 - dice_multi: 0.8396
Epoch 56/100
400/400 - 110s - loss: 0.1110 - dice_multi: 0.8456
Epoch 57/100
400/400 - 110s - loss: 0.1173 - dice_multi: 0.8312
Epoch 58/100
400/400 - 110s - loss: 0.1263 - dice_multi: 0.8329
Epoch 59/100
400/400 - 110s - loss: 0.1172 - dice_multi: 0.8364
Epoch 60/100
400/400 - 110s - loss: 0.1117 - dice_multi: 0.8524
Epoch 61/100
400/400 - 110s - loss: 0.1106 - dice_multi: 0.8485
Epoch 62/100
400/400 - 110s - loss: 0.1105 - dice_multi: 0.8473
Epoch 63/100
400/400 - 110s - loss: 0.1131 - dice_multi: 0.8409
Epoch 64/100
400/400 - 110s - loss: 0.1067 - dice_multi: 0.8518
Epoch 65/100
400/400 - 110s - loss: 0.1072 - dice_multi: 0.8494
Epoch 66/100
400/400 - 110s - loss: 0.1215 - dice_multi: 0.8393
Epoch 67/100
400/400 - 110s - loss: 0.1168 - dice_multi: 0.8396
Epoch 68/100
400/400 - 110s - loss: 0.1115 - dice_multi: 0.8432
Epoch 69/100
400/400 - 110s - loss: 0.1075 - dice_multi: 0.8390
Epoch 70/100
400/400 - 110s - loss: 0.1093 - dice_multi: 0.8483
Epoch 71/100
400/400 - 110s - loss: 0.1140 - dice_multi: 0.8395
Epoch 72/100
400/400 - 110s - loss: 0.1030 - dice_multi: 0.8449
Epoch 73/100
400/400 - 110s - loss: 0.1038 - dice_multi: 0.8548
Epoch 74/100
400/400 - 110s - loss: 0.1053 - dice_multi: 0.8473
Epoch 75/100
400/400 - 110s - loss: 0.1268 - dice_multi: 0.8279
Epoch 76/100
400/400 - 110s - loss: 0.1119 - dice_multi: 0.8431
Epoch 77/100
400/400 - 110s - loss: 0.1043 - dice_multi: 0.8526
Epoch 78/100
400/400 - 110s - loss: 0.1078 - dice_multi: 0.8452
Epoch 79/100
400/400 - 110s - loss: 0.1053 - dice_multi: 0.8513
Epoch 80/100
400/400 - 110s - loss: 0.1036 - dice_multi: 0.8615
Epoch 81/100
400/400 - 110s - loss: 0.1073 - dice_multi: 0.8463
Epoch 82/100
400/400 - 110s - loss: 0.1027 - dice_multi: 0.8503
Epoch 83/100
400/400 - 110s - loss: 0.1016 - dice_multi: 0.8547
Epoch 84/100
400/400 - 110s - loss: 0.1056 - dice_multi: 0.8556
Epoch 85/100
400/400 - 110s - loss: 0.1178 - dice_multi: 0.8353
Epoch 86/100
400/400 - 110s - loss: 0.1058 - dice_multi: 0.8492
Epoch 87/100
400/400 - 110s - loss: 0.0999 - dice_multi: 0.8508
Epoch 88/100
400/400 - 110s - loss: 0.1006 - dice_multi: 0.8541
Epoch 89/100
400/400 - 110s - loss: 0.0992 - dice_multi: 0.8576
Epoch 90/100
400/400 - 110s - loss: 0.1082 - dice_multi: 0.8473
Epoch 91/100
400/400 - 110s - loss: 0.1016 - dice_multi: 0.8512
Epoch 92/100
400/400 - 110s - loss: 0.1039 - dice_multi: 0.8520
Epoch 93/100
400/400 - 110s - loss: 0.0995 - dice_multi: 0.8509
Epoch 94/100
400/400 - 110s - loss: 0.1019 - dice_multi: 0.8564
Epoch 95/100
400/400 - 110s - loss: 0.0996 - dice_multi: 0.8566
Epoch 96/100
400/400 - 110s - loss: 0.1207 - dice_multi: 0.8384
Epoch 97/100
400/400 - 110s - loss: 0.1034 - dice_multi: 0.8539
Epoch 98/100
400/400 - 110s - loss: 0.0991 - dice_multi: 0.8553
Epoch 99/100
400/400 - 110s - loss: 0.1013 - dice_multi: 0.8592
Epoch 100/100
400/400 - 110s - loss: 0.0968 - dice_multi: 0.8634
training time: 11009.635890245438
executation time:167.6713881254196
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [20 21 22 23 24 25 26 27 28 29]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 114s - loss: 0.6503 - dice_multi: 0.3631
Epoch 2/100
400/400 - 110s - loss: 0.5004 - dice_multi: 0.4282
Epoch 3/100
400/400 - 110s - loss: 0.4581 - dice_multi: 0.4661
Epoch 4/100
400/400 - 110s - loss: 0.3904 - dice_multi: 0.5204
Epoch 5/100
400/400 - 110s - loss: 0.3609 - dice_multi: 0.5587
Epoch 6/100
400/400 - 110s - loss: 0.3330 - dice_multi: 0.5964
Epoch 7/100
400/400 - 110s - loss: 0.2958 - dice_multi: 0.6252
Epoch 8/100
400/400 - 110s - loss: 0.2817 - dice_multi: 0.6632
Epoch 9/100
400/400 - 110s - loss: 0.2499 - dice_multi: 0.6880
Epoch 10/100
400/400 - 110s - loss: 0.2428 - dice_multi: 0.6975
Epoch 11/100
400/400 - 110s - loss: 0.2192 - dice_multi: 0.7193
Epoch 12/100
400/400 - 110s - loss: 0.2037 - dice_multi: 0.7293
Epoch 13/100
400/400 - 110s - loss: 0.2000 - dice_multi: 0.7422
Epoch 14/100
400/400 - 110s - loss: 0.1875 - dice_multi: 0.7532
Epoch 15/100
400/400 - 110s - loss: 0.1753 - dice_multi: 0.7689
Epoch 16/100
400/400 - 110s - loss: 0.1881 - dice_multi: 0.7590
Epoch 17/100
400/400 - 110s - loss: 0.1692 - dice_multi: 0.7779
Epoch 18/100
400/400 - 110s - loss: 0.1657 - dice_multi: 0.7740
Epoch 19/100
400/400 - 110s - loss: 0.1804 - dice_multi: 0.7695
Epoch 20/100
400/400 - 110s - loss: 0.1566 - dice_multi: 0.7919
Epoch 21/100
400/400 - 110s - loss: 0.1681 - dice_multi: 0.7816
Epoch 22/100
400/400 - 110s - loss: 0.1486 - dice_multi: 0.8042
Epoch 23/100
400/400 - 110s - loss: 0.1440 - dice_multi: 0.8002
Epoch 24/100
400/400 - 110s - loss: 0.1438 - dice_multi: 0.8142
Epoch 25/100
400/400 - 110s - loss: 0.1709 - dice_multi: 0.7915
Epoch 26/100
400/400 - 110s - loss: 0.1536 - dice_multi: 0.7871
Epoch 27/100
400/400 - 110s - loss: 0.1423 - dice_multi: 0.8073
Epoch 28/100
400/400 - 110s - loss: 0.1515 - dice_multi: 0.7924
Epoch 29/100
400/400 - 110s - loss: 0.1597 - dice_multi: 0.7970
Epoch 30/100
400/400 - 110s - loss: 0.1410 - dice_multi: 0.8152
Epoch 31/100
400/400 - 110s - loss: 0.1319 - dice_multi: 0.8195
Epoch 32/100
400/400 - 110s - loss: 0.1334 - dice_multi: 0.8218
Epoch 33/100
400/400 - 110s - loss: 0.1305 - dice_multi: 0.8152
Epoch 34/100
400/400 - 110s - loss: 0.1314 - dice_multi: 0.8056
Epoch 35/100
400/400 - 110s - loss: 0.1424 - dice_multi: 0.8083
Epoch 36/100
400/400 - 110s - loss: 0.1426 - dice_multi: 0.8117
Epoch 37/100
400/400 - 110s - loss: 0.1265 - dice_multi: 0.8255
Epoch 38/100
400/400 - 110s - loss: 0.1234 - dice_multi: 0.8282
Epoch 39/100
400/400 - 110s - loss: 0.1276 - dice_multi: 0.8238
Epoch 40/100
400/400 - 110s - loss: 0.1227 - dice_multi: 0.8316
Epoch 41/100
400/400 - 110s - loss: 0.1322 - dice_multi: 0.8246
Epoch 42/100
400/400 - 110s - loss: 0.1245 - dice_multi: 0.8300
Epoch 43/100
400/400 - 110s - loss: 0.1212 - dice_multi: 0.8327
Epoch 44/100
400/400 - 110s - loss: 0.1442 - dice_multi: 0.8015
Epoch 45/100
400/400 - 110s - loss: 0.1232 - dice_multi: 0.8311
Epoch 46/100
400/400 - 110s - loss: 0.1223 - dice_multi: 0.8278
Epoch 47/100
400/400 - 110s - loss: 0.1130 - dice_multi: 0.8380
Epoch 48/100
400/400 - 110s - loss: 0.1142 - dice_multi: 0.8311
Epoch 49/100
400/400 - 110s - loss: 0.1459 - dice_multi: 0.8051
Epoch 50/100
400/400 - 110s - loss: 0.1237 - dice_multi: 0.8189
Epoch 51/100
400/400 - 110s - loss: 0.1146 - dice_multi: 0.8371
Epoch 52/100
400/400 - 110s - loss: 0.1119 - dice_multi: 0.8415
Epoch 53/100
400/400 - 110s - loss: 0.1263 - dice_multi: 0.8194
Epoch 54/100
400/400 - 110s - loss: 0.1114 - dice_multi: 0.8339
Epoch 55/100
400/400 - 110s - loss: 0.1092 - dice_multi: 0.8383
Epoch 56/100
400/400 - 110s - loss: 0.1265 - dice_multi: 0.8205
Epoch 57/100
400/400 - 110s - loss: 0.1215 - dice_multi: 0.8335
Epoch 58/100
400/400 - 110s - loss: 0.1115 - dice_multi: 0.8445
Epoch 59/100
400/400 - 110s - loss: 0.1167 - dice_multi: 0.8347
Epoch 60/100
400/400 - 110s - loss: 0.1164 - dice_multi: 0.8391
Epoch 61/100
400/400 - 110s - loss: 0.1099 - dice_multi: 0.8448
Epoch 62/100
400/400 - 110s - loss: 0.1096 - dice_multi: 0.8421
Epoch 63/100
400/400 - 110s - loss: 0.1145 - dice_multi: 0.8418
Epoch 64/100
400/400 - 110s - loss: 0.1209 - dice_multi: 0.8273
Epoch 65/100
400/400 - 110s - loss: 0.1085 - dice_multi: 0.8433
Epoch 66/100
400/400 - 110s - loss: 0.1046 - dice_multi: 0.8441
Epoch 67/100
400/400 - 110s - loss: 0.1072 - dice_multi: 0.8448
Epoch 68/100
400/400 - 110s - loss: 0.1163 - dice_multi: 0.8375
Epoch 69/100
400/400 - 110s - loss: 0.1295 - dice_multi: 0.8206
Epoch 70/100
400/400 - 110s - loss: 0.1079 - dice_multi: 0.8461
Epoch 71/100
400/400 - 110s - loss: 0.1054 - dice_multi: 0.8538
Epoch 72/100
400/400 - 110s - loss: 0.1074 - dice_multi: 0.8444
Epoch 73/100
400/400 - 110s - loss: 0.1150 - dice_multi: 0.8264
Epoch 74/100
400/400 - 111s - loss: 0.1071 - dice_multi: 0.8400
Epoch 75/100
400/400 - 110s - loss: 0.1034 - dice_multi: 0.8518
Epoch 76/100
400/400 - 111s - loss: 0.1164 - dice_multi: 0.8308
Epoch 77/100
400/400 - 110s - loss: 0.1064 - dice_multi: 0.8522
Epoch 78/100
400/400 - 110s - loss: 0.1223 - dice_multi: 0.8289
Epoch 79/100
400/400 - 110s - loss: 0.1096 - dice_multi: 0.8488
Epoch 80/100
400/400 - 110s - loss: 0.1039 - dice_multi: 0.8502
Epoch 81/100
400/400 - 110s - loss: 0.1045 - dice_multi: 0.8464
Epoch 82/100
400/400 - 110s - loss: 0.1093 - dice_multi: 0.8363
Epoch 83/100
400/400 - 110s - loss: 0.1151 - dice_multi: 0.8388
Epoch 84/100
400/400 - 110s - loss: 0.1078 - dice_multi: 0.8465
Epoch 85/100
400/400 - 110s - loss: 0.1008 - dice_multi: 0.8442
Epoch 86/100
400/400 - 110s - loss: 0.1060 - dice_multi: 0.8439
Epoch 87/100
400/400 - 110s - loss: 0.1013 - dice_multi: 0.8543
Epoch 88/100
400/400 - 110s - loss: 0.1053 - dice_multi: 0.8459
Epoch 89/100
400/400 - 110s - loss: 0.1046 - dice_multi: 0.8489
Epoch 90/100
400/400 - 110s - loss: 0.1003 - dice_multi: 0.8515
Epoch 91/100
400/400 - 110s - loss: 0.1031 - dice_multi: 0.8516
Epoch 92/100
400/400 - 110s - loss: 0.1010 - dice_multi: 0.8522
Epoch 93/100
400/400 - 110s - loss: 0.0988 - dice_multi: 0.8477
Epoch 94/100
400/400 - 110s - loss: 0.1286 - dice_multi: 0.8195
Epoch 95/100
400/400 - 110s - loss: 0.1069 - dice_multi: 0.8447
Epoch 96/100
400/400 - 110s - loss: 0.1176 - dice_multi: 0.8337
Epoch 97/100
400/400 - 110s - loss: 0.1025 - dice_multi: 0.8454
Epoch 98/100
400/400 - 110s - loss: 0.1008 - dice_multi: 0.8498
Epoch 99/100
400/400 - 110s - loss: 0.0972 - dice_multi: 0.8510
Epoch 100/100
400/400 - 110s - loss: 0.1150 - dice_multi: 0.8301
training time: 11026.61344909668
executation time:167.36526308059692
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]
training set size:  30
testing set:  [30 31 32 33 34 35 36 37 38 39 40]
testing set size:  11
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 114s - loss: 0.6781 - dice_multi: 0.4059
Epoch 2/100
400/400 - 110s - loss: 0.5198 - dice_multi: 0.4824
Epoch 3/100
400/400 - 110s - loss: 0.4420 - dice_multi: 0.5451
Epoch 4/100
400/400 - 110s - loss: 0.3892 - dice_multi: 0.6111
Epoch 5/100
400/400 - 110s - loss: 0.3419 - dice_multi: 0.6493
Epoch 6/100
400/400 - 110s - loss: 0.3010 - dice_multi: 0.6800
Epoch 7/100
400/400 - 110s - loss: 0.2815 - dice_multi: 0.6989
Epoch 8/100
400/400 - 110s - loss: 0.2488 - dice_multi: 0.7396
Epoch 9/100
400/400 - 110s - loss: 0.2298 - dice_multi: 0.7484
Epoch 10/100
400/400 - 110s - loss: 0.2204 - dice_multi: 0.7537
Epoch 11/100
400/400 - 110s - loss: 0.2078 - dice_multi: 0.7774
Epoch 12/100
400/400 - 110s - loss: 0.2067 - dice_multi: 0.7737
Epoch 13/100
400/400 - 110s - loss: 0.1846 - dice_multi: 0.8010
Epoch 14/100
400/400 - 110s - loss: 0.1914 - dice_multi: 0.7778
Epoch 15/100
400/400 - 111s - loss: 0.1797 - dice_multi: 0.8097
Epoch 16/100
400/400 - 110s - loss: 0.1785 - dice_multi: 0.8057
Epoch 17/100
400/400 - 110s - loss: 0.1780 - dice_multi: 0.7981
Epoch 18/100
400/400 - 111s - loss: 0.1606 - dice_multi: 0.8148
Epoch 19/100
400/400 - 111s - loss: 0.1730 - dice_multi: 0.8047
Epoch 20/100
400/400 - 110s - loss: 0.1679 - dice_multi: 0.8153
Epoch 21/100
400/400 - 110s - loss: 0.1685 - dice_multi: 0.8166
Epoch 22/100
400/400 - 110s - loss: 0.1592 - dice_multi: 0.8255
Epoch 23/100
400/400 - 110s - loss: 0.1698 - dice_multi: 0.8108
Epoch 24/100
400/400 - 111s - loss: 0.1476 - dice_multi: 0.8326
Epoch 25/100
400/400 - 110s - loss: 0.1512 - dice_multi: 0.8247
Epoch 26/100
400/400 - 111s - loss: 0.1458 - dice_multi: 0.8367
Epoch 27/100
400/400 - 110s - loss: 0.1519 - dice_multi: 0.8293
Epoch 28/100
400/400 - 110s - loss: 0.1466 - dice_multi: 0.8337
Epoch 29/100
400/400 - 110s - loss: 0.1357 - dice_multi: 0.8429
Epoch 30/100
400/400 - 110s - loss: 0.1784 - dice_multi: 0.8042
Epoch 31/100
400/400 - 110s - loss: 0.1401 - dice_multi: 0.8399
Epoch 32/100
400/400 - 110s - loss: 0.1386 - dice_multi: 0.8397
Epoch 33/100
400/400 - 110s - loss: 0.1351 - dice_multi: 0.8430
Epoch 34/100
400/400 - 110s - loss: 0.1628 - dice_multi: 0.8138
Epoch 35/100
400/400 - 110s - loss: 0.1499 - dice_multi: 0.8329
Epoch 36/100
400/400 - 110s - loss: 0.1385 - dice_multi: 0.8462
Epoch 37/100
400/400 - 110s - loss: 0.1354 - dice_multi: 0.8432
Epoch 38/100
400/400 - 110s - loss: 0.1280 - dice_multi: 0.8495
Epoch 39/100
400/400 - 110s - loss: 0.1388 - dice_multi: 0.8386
Epoch 40/100
400/400 - 110s - loss: 0.1290 - dice_multi: 0.8479
Epoch 41/100
400/400 - 111s - loss: 0.1317 - dice_multi: 0.8435
Epoch 42/100
400/400 - 111s - loss: 0.1284 - dice_multi: 0.8532
Epoch 43/100
400/400 - 110s - loss: 0.1506 - dice_multi: 0.8354
Epoch 44/100
400/400 - 110s - loss: 0.1317 - dice_multi: 0.8486
Epoch 45/100
400/400 - 110s - loss: 0.1267 - dice_multi: 0.8592
Epoch 46/100
400/400 - 110s - loss: 0.1280 - dice_multi: 0.8503
Epoch 47/100
400/400 - 110s - loss: 0.1558 - dice_multi: 0.8265
Epoch 48/100
400/400 - 110s - loss: 0.1277 - dice_multi: 0.8559
Epoch 49/100
400/400 - 110s - loss: 0.1219 - dice_multi: 0.8555
Epoch 50/100
400/400 - 110s - loss: 0.1219 - dice_multi: 0.8541
Epoch 51/100
400/400 - 110s - loss: 0.1202 - dice_multi: 0.8591
Epoch 52/100
400/400 - 110s - loss: 0.1426 - dice_multi: 0.8345
Epoch 53/100
400/400 - 111s - loss: 0.1260 - dice_multi: 0.8474
Epoch 54/100
400/400 - 110s - loss: 0.1221 - dice_multi: 0.8605
Epoch 55/100
400/400 - 110s - loss: 0.1196 - dice_multi: 0.8582
Epoch 56/100
400/400 - 110s - loss: 0.1319 - dice_multi: 0.8415
Epoch 57/100
400/400 - 110s - loss: 0.1222 - dice_multi: 0.8553
Epoch 58/100
400/400 - 110s - loss: 0.1145 - dice_multi: 0.8558
Epoch 59/100
400/400 - 110s - loss: 0.1205 - dice_multi: 0.8582
Epoch 60/100
400/400 - 110s - loss: 0.1313 - dice_multi: 0.8511
Epoch 61/100
400/400 - 110s - loss: 0.1183 - dice_multi: 0.8585
Epoch 62/100
400/400 - 110s - loss: 0.1150 - dice_multi: 0.8615
Epoch 63/100
400/400 - 111s - loss: 0.1298 - dice_multi: 0.8489
Epoch 64/100
400/400 - 110s - loss: 0.1269 - dice_multi: 0.8460
Epoch 65/100
400/400 - 110s - loss: 0.1151 - dice_multi: 0.8608
Epoch 66/100
400/400 - 111s - loss: 0.1168 - dice_multi: 0.8605
Epoch 67/100
400/400 - 110s - loss: 0.1318 - dice_multi: 0.8477
Epoch 68/100
400/400 - 110s - loss: 0.1183 - dice_multi: 0.8622
Epoch 69/100
400/400 - 110s - loss: 0.1191 - dice_multi: 0.8608
Epoch 70/100
400/400 - 110s - loss: 0.1112 - dice_multi: 0.8609
Epoch 71/100
400/400 - 111s - loss: 0.1118 - dice_multi: 0.8589
Epoch 72/100
400/400 - 110s - loss: 0.1296 - dice_multi: 0.8386
Epoch 73/100
400/400 - 110s - loss: 0.1134 - dice_multi: 0.8642
Epoch 74/100
400/400 - 110s - loss: 0.1123 - dice_multi: 0.8629
Epoch 75/100
400/400 - 110s - loss: 0.1111 - dice_multi: 0.8662
Epoch 76/100
400/400 - 110s - loss: 0.1179 - dice_multi: 0.8536
Epoch 77/100
400/400 - 110s - loss: 0.1135 - dice_multi: 0.8688
Epoch 78/100
400/400 - 110s - loss: 0.1114 - dice_multi: 0.8679
Epoch 79/100
400/400 - 111s - loss: 0.1073 - dice_multi: 0.8663
Epoch 80/100
400/400 - 110s - loss: 0.1119 - dice_multi: 0.8642
Epoch 81/100
400/400 - 111s - loss: 0.1086 - dice_multi: 0.8621
Epoch 82/100
400/400 - 111s - loss: 0.1188 - dice_multi: 0.8622
Epoch 83/100
400/400 - 110s - loss: 0.1260 - dice_multi: 0.8501
Epoch 84/100
400/400 - 110s - loss: 0.1096 - dice_multi: 0.8677
Epoch 85/100
400/400 - 110s - loss: 0.1108 - dice_multi: 0.8705
Epoch 86/100
400/400 - 110s - loss: 0.1080 - dice_multi: 0.8643
Epoch 87/100
400/400 - 110s - loss: 0.1129 - dice_multi: 0.8619
Epoch 88/100
400/400 - 110s - loss: 0.1071 - dice_multi: 0.8651
Epoch 89/100
400/400 - 110s - loss: 0.1085 - dice_multi: 0.8645
Epoch 90/100
400/400 - 110s - loss: 0.1270 - dice_multi: 0.8539
Epoch 91/100
400/400 - 110s - loss: 0.1077 - dice_multi: 0.8679
Epoch 92/100
400/400 - 110s - loss: 0.1052 - dice_multi: 0.8655
Epoch 93/100
400/400 - 110s - loss: 0.1070 - dice_multi: 0.8710
Epoch 94/100
400/400 - 110s - loss: 0.1176 - dice_multi: 0.8548
Epoch 95/100
400/400 - 110s - loss: 0.1095 - dice_multi: 0.8621
Epoch 96/100
400/400 - 110s - loss: 0.1135 - dice_multi: 0.8661
Epoch 97/100
400/400 - 110s - loss: 0.1053 - dice_multi: 0.8701
Epoch 98/100
400/400 - 110s - loss: 0.1043 - dice_multi: 0.8700
Epoch 99/100
400/400 - 110s - loss: 0.1122 - dice_multi: 0.8571
Epoch 100/100
400/400 - 110s - loss: 0.1044 - dice_multi: 0.8769
training time: 11049.043602228165
executation time:172.26896940578115
[0.99197036 0.942106   0.81866086 0.894959   0.83787256 0.90879005
 0.8994877 ]
