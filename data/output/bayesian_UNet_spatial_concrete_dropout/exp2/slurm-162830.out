Loading tensorflow/2.5
  Loading requirement: cuda11.2/toolkit/11.2.2 cudnn8.1-cuda11.2/8.1.1.33
    hdf5_18/1.8.20
bayesian U-Net with Spatial3DConcreteDropout
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2021-09-20 12:41:31.709524: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(41, 256, 128, 256)
..loading data finished Mon Sep 20 12:41:57 2021
2021-09-20 12:41:57.686665: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-09-20 12:41:57.748586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-20 12:41:57.748632: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-20 12:41:57.762562: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-20 12:41:57.762687: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-09-20 12:41:57.767150: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-09-20 12:41:57.768114: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-09-20 12:41:57.769255: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-09-20 12:41:57.770545: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-09-20 12:41:57.771151: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-20 12:41:57.775016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-20 12:41:57.779946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: A100-PCIE-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-09-20 12:41:57.783779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0
2021-09-20 12:41:57.783822: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-09-20 12:41:58.261365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-20 12:41:58.261414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-09-20 12:41:58.261426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-09-20 12:41:58.267010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38184 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:3b:00.0, compute capability: 8.0)
WARNING:tensorflow:AutoGraph could not transform <bound method Spatial3DConcreteDropout.call of <model.ConcreteDropout.spatialConcreteDropout.Spatial3DConcreteDropout object at 0x2aad6cce9760>> and will run it as-is.
Cause: code mixing tabs and spaces for indentation is not allowed
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
---------fold--1---------
training set:  [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [0 1 2 3 4 5 6 7 8 9]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
2021-09-20 12:42:01.121007: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-09-20 12:42:01.121651: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2100000000 Hz
2021-09-20 12:42:05.011948: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-09-20 12:42:06.017257: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2021-09-20 12:42:07.021837: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-09-20 12:42:07.818023: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 138s - loss: 0.6617 - dice_multi: 0.3829
Epoch 2/100
400/400 - 109s - loss: 0.5198 - dice_multi: 0.4544
Epoch 3/100
400/400 - 109s - loss: 0.4379 - dice_multi: 0.5053
Epoch 4/100
400/400 - 109s - loss: 0.3871 - dice_multi: 0.5557
Epoch 5/100
400/400 - 109s - loss: 0.3443 - dice_multi: 0.6012
Epoch 6/100
400/400 - 109s - loss: 0.2964 - dice_multi: 0.6523
Epoch 7/100
400/400 - 109s - loss: 0.2554 - dice_multi: 0.6941
Epoch 8/100
400/400 - 108s - loss: 0.2401 - dice_multi: 0.7170
Epoch 9/100
400/400 - 109s - loss: 0.2112 - dice_multi: 0.7418
Epoch 10/100
400/400 - 109s - loss: 0.1875 - dice_multi: 0.7683
Epoch 11/100
400/400 - 109s - loss: 0.1862 - dice_multi: 0.7701
Epoch 12/100
400/400 - 109s - loss: 0.1777 - dice_multi: 0.7809
Epoch 13/100
400/400 - 110s - loss: 0.1829 - dice_multi: 0.7808
Epoch 14/100
400/400 - 110s - loss: 0.1610 - dice_multi: 0.7979
Epoch 15/100
400/400 - 110s - loss: 0.1610 - dice_multi: 0.8002
Epoch 16/100
400/400 - 110s - loss: 0.1552 - dice_multi: 0.7982
Epoch 17/100
400/400 - 110s - loss: 0.1658 - dice_multi: 0.7946
Epoch 18/100
400/400 - 110s - loss: 0.1479 - dice_multi: 0.8135
Epoch 19/100
400/400 - 110s - loss: 0.1467 - dice_multi: 0.8154
Epoch 20/100
400/400 - 110s - loss: 0.1541 - dice_multi: 0.8119
Epoch 21/100
400/400 - 110s - loss: 0.1410 - dice_multi: 0.8232
Epoch 22/100
400/400 - 110s - loss: 0.1611 - dice_multi: 0.8067
Epoch 23/100
400/400 - 110s - loss: 0.1323 - dice_multi: 0.8252
Epoch 24/100
400/400 - 110s - loss: 0.1466 - dice_multi: 0.8128
Epoch 25/100
400/400 - 110s - loss: 0.1400 - dice_multi: 0.8221
Epoch 26/100
400/400 - 110s - loss: 0.1362 - dice_multi: 0.8289
Epoch 27/100
400/400 - 110s - loss: 0.1261 - dice_multi: 0.8406
Epoch 28/100
400/400 - 110s - loss: 0.1216 - dice_multi: 0.8445
Epoch 29/100
400/400 - 110s - loss: 0.1327 - dice_multi: 0.8274
Epoch 30/100
400/400 - 110s - loss: 0.1238 - dice_multi: 0.8402
Epoch 31/100
400/400 - 110s - loss: 0.1334 - dice_multi: 0.8279
Epoch 32/100
400/400 - 110s - loss: 0.1469 - dice_multi: 0.8143
Epoch 33/100
400/400 - 110s - loss: 0.1211 - dice_multi: 0.8480
Epoch 34/100
400/400 - 109s - loss: 0.1229 - dice_multi: 0.8453
Epoch 35/100
400/400 - 109s - loss: 0.1175 - dice_multi: 0.8521
Epoch 36/100
400/400 - 109s - loss: 0.1180 - dice_multi: 0.8452
Epoch 37/100
400/400 - 108s - loss: 0.1313 - dice_multi: 0.8291
Epoch 38/100
400/400 - 108s - loss: 0.1220 - dice_multi: 0.8445
Epoch 39/100
400/400 - 108s - loss: 0.1169 - dice_multi: 0.8494
Epoch 40/100
400/400 - 109s - loss: 0.1145 - dice_multi: 0.8457
Epoch 41/100
400/400 - 109s - loss: 0.1237 - dice_multi: 0.8350
Epoch 42/100
400/400 - 109s - loss: 0.1128 - dice_multi: 0.8499
Epoch 43/100
400/400 - 108s - loss: 0.1105 - dice_multi: 0.8518
Epoch 44/100
400/400 - 108s - loss: 0.1132 - dice_multi: 0.8560
Epoch 45/100
400/400 - 109s - loss: 0.1175 - dice_multi: 0.8470
Epoch 46/100
400/400 - 109s - loss: 0.1621 - dice_multi: 0.8053
Epoch 47/100
400/400 - 109s - loss: 0.1212 - dice_multi: 0.8434
Epoch 48/100
400/400 - 110s - loss: 0.1147 - dice_multi: 0.8508
Epoch 49/100
400/400 - 110s - loss: 0.1111 - dice_multi: 0.8561
Epoch 50/100
400/400 - 109s - loss: 0.1079 - dice_multi: 0.8581
Epoch 51/100
400/400 - 109s - loss: 0.1093 - dice_multi: 0.8582
Epoch 52/100
400/400 - 110s - loss: 0.1055 - dice_multi: 0.8560
Epoch 53/100
400/400 - 110s - loss: 0.1206 - dice_multi: 0.8448
Epoch 54/100
400/400 - 109s - loss: 0.1136 - dice_multi: 0.8588
Epoch 55/100
400/400 - 109s - loss: 0.1041 - dice_multi: 0.8603
Epoch 56/100
400/400 - 109s - loss: 0.1108 - dice_multi: 0.8495
Epoch 57/100
400/400 - 110s - loss: 0.1103 - dice_multi: 0.8531
Epoch 58/100
400/400 - 110s - loss: 0.1393 - dice_multi: 0.8201
Epoch 59/100
400/400 - 110s - loss: 0.1077 - dice_multi: 0.8554
Epoch 60/100
400/400 - 110s - loss: 0.1087 - dice_multi: 0.8538
Epoch 61/100
400/400 - 110s - loss: 0.1050 - dice_multi: 0.8581
Epoch 62/100
400/400 - 110s - loss: 0.1057 - dice_multi: 0.8663
Epoch 63/100
400/400 - 110s - loss: 0.1213 - dice_multi: 0.8500
Epoch 64/100
400/400 - 110s - loss: 0.1038 - dice_multi: 0.8571
Epoch 65/100
400/400 - 110s - loss: 0.1023 - dice_multi: 0.8622
Epoch 66/100
400/400 - 110s - loss: 0.1181 - dice_multi: 0.8531
Epoch 67/100
400/400 - 110s - loss: 0.1111 - dice_multi: 0.8578
Epoch 68/100
400/400 - 111s - loss: 0.1039 - dice_multi: 0.8579
Epoch 69/100
400/400 - 110s - loss: 0.1021 - dice_multi: 0.8626
Epoch 70/100
400/400 - 110s - loss: 0.0985 - dice_multi: 0.8670
Epoch 71/100
400/400 - 110s - loss: 0.1131 - dice_multi: 0.8490
Epoch 72/100
400/400 - 110s - loss: 0.1078 - dice_multi: 0.8591
Epoch 73/100
400/400 - 110s - loss: 0.1015 - dice_multi: 0.8672
Epoch 74/100
400/400 - 110s - loss: 0.0978 - dice_multi: 0.8661
Epoch 75/100
400/400 - 110s - loss: 0.1010 - dice_multi: 0.8546
Epoch 76/100
400/400 - 110s - loss: 0.1039 - dice_multi: 0.8631
Epoch 77/100
400/400 - 110s - loss: 0.0966 - dice_multi: 0.8689
Epoch 78/100
400/400 - 110s - loss: 0.0986 - dice_multi: 0.8671
Epoch 79/100
400/400 - 110s - loss: 0.1196 - dice_multi: 0.8343
Epoch 80/100
400/400 - 111s - loss: 0.1057 - dice_multi: 0.8516
Epoch 81/100
400/400 - 111s - loss: 0.0994 - dice_multi: 0.8668
Epoch 82/100
400/400 - 110s - loss: 0.0971 - dice_multi: 0.8747
Epoch 83/100
400/400 - 110s - loss: 0.0949 - dice_multi: 0.8678
Epoch 84/100
400/400 - 110s - loss: 0.1070 - dice_multi: 0.8545
Epoch 85/100
400/400 - 110s - loss: 0.0986 - dice_multi: 0.8667
Epoch 86/100
400/400 - 111s - loss: 0.0960 - dice_multi: 0.8653
Epoch 87/100
400/400 - 111s - loss: 0.1166 - dice_multi: 0.8432
Epoch 88/100
400/400 - 111s - loss: 0.1135 - dice_multi: 0.8495
Epoch 89/100
400/400 - 111s - loss: 0.0994 - dice_multi: 0.8704
Epoch 90/100
400/400 - 111s - loss: 0.0961 - dice_multi: 0.8734
Epoch 91/100
400/400 - 111s - loss: 0.0937 - dice_multi: 0.8696
Epoch 92/100
400/400 - 111s - loss: 0.0967 - dice_multi: 0.8724
Epoch 93/100
400/400 - 111s - loss: 0.0938 - dice_multi: 0.8683
Epoch 94/100
400/400 - 111s - loss: 0.0964 - dice_multi: 0.8705
Epoch 95/100
400/400 - 110s - loss: 0.0938 - dice_multi: 0.8706
Epoch 96/100
400/400 - 110s - loss: 0.0918 - dice_multi: 0.8694
Epoch 97/100
400/400 - 111s - loss: 0.1114 - dice_multi: 0.8498
Epoch 98/100
400/400 - 110s - loss: 0.1001 - dice_multi: 0.8721
Epoch 99/100
400/400 - 110s - loss: 0.1055 - dice_multi: 0.8592
Epoch 100/100
400/400 - 111s - loss: 0.1054 - dice_multi: 0.8573
2021-09-20 15:45:41.625637: I tensorflow/stream_executor/cuda/cuda_blas.cc:1839] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
training time: 11020.729196310043
executation time:169.0009095430374
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [10 11 12 13 14 15 16 17 18 19]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 113s - loss: 0.6551 - dice_multi: 0.3682
Epoch 2/100
400/400 - 110s - loss: 0.5500 - dice_multi: 0.4263
Epoch 3/100
400/400 - 110s - loss: 0.4718 - dice_multi: 0.4641
Epoch 4/100
400/400 - 110s - loss: 0.4389 - dice_multi: 0.5007
Epoch 5/100
400/400 - 110s - loss: 0.3936 - dice_multi: 0.5377
Epoch 6/100
400/400 - 110s - loss: 0.3394 - dice_multi: 0.5917
Epoch 7/100
400/400 - 111s - loss: 0.3112 - dice_multi: 0.6260
Epoch 8/100
400/400 - 110s - loss: 0.2784 - dice_multi: 0.6634
Epoch 9/100
400/400 - 110s - loss: 0.2550 - dice_multi: 0.6913
Epoch 10/100
400/400 - 110s - loss: 0.2409 - dice_multi: 0.7100
Epoch 11/100
400/400 - 110s - loss: 0.2110 - dice_multi: 0.7300
Epoch 12/100
400/400 - 110s - loss: 0.2110 - dice_multi: 0.7347
Epoch 13/100
400/400 - 110s - loss: 0.2044 - dice_multi: 0.7524
Epoch 14/100
400/400 - 110s - loss: 0.1875 - dice_multi: 0.7545
Epoch 15/100
400/400 - 110s - loss: 0.1804 - dice_multi: 0.7715
Epoch 16/100
400/400 - 110s - loss: 0.1837 - dice_multi: 0.7666
Epoch 17/100
400/400 - 110s - loss: 0.1704 - dice_multi: 0.7780
Epoch 18/100
400/400 - 111s - loss: 0.1619 - dice_multi: 0.7929
Epoch 19/100
400/400 - 110s - loss: 0.1664 - dice_multi: 0.7973
Epoch 20/100
400/400 - 111s - loss: 0.1654 - dice_multi: 0.7920
Epoch 21/100
400/400 - 111s - loss: 0.1599 - dice_multi: 0.7922
Epoch 22/100
400/400 - 111s - loss: 0.1657 - dice_multi: 0.7927
Epoch 23/100
400/400 - 111s - loss: 0.1473 - dice_multi: 0.8092
Epoch 24/100
400/400 - 111s - loss: 0.1496 - dice_multi: 0.8055
Epoch 25/100
400/400 - 111s - loss: 0.1533 - dice_multi: 0.8080
Epoch 26/100
400/400 - 110s - loss: 0.1417 - dice_multi: 0.8173
Epoch 27/100
400/400 - 110s - loss: 0.1413 - dice_multi: 0.8084
Epoch 28/100
400/400 - 111s - loss: 0.1370 - dice_multi: 0.8172
Epoch 29/100
400/400 - 110s - loss: 0.1360 - dice_multi: 0.8209
Epoch 30/100
400/400 - 110s - loss: 0.1485 - dice_multi: 0.8148
Epoch 31/100
400/400 - 111s - loss: 0.1292 - dice_multi: 0.8318
Epoch 32/100
400/400 - 110s - loss: 0.1643 - dice_multi: 0.7995
Epoch 33/100
400/400 - 111s - loss: 0.1322 - dice_multi: 0.8252
Epoch 34/100
400/400 - 110s - loss: 0.1320 - dice_multi: 0.8240
Epoch 35/100
400/400 - 110s - loss: 0.1475 - dice_multi: 0.8055
Epoch 36/100
400/400 - 110s - loss: 0.1323 - dice_multi: 0.8321
Epoch 37/100
400/400 - 110s - loss: 0.1267 - dice_multi: 0.8378
Epoch 38/100
400/400 - 110s - loss: 0.1545 - dice_multi: 0.8024
Epoch 39/100
400/400 - 110s - loss: 0.1415 - dice_multi: 0.8128
Epoch 40/100
400/400 - 110s - loss: 0.1285 - dice_multi: 0.8284
Epoch 41/100
400/400 - 110s - loss: 0.1227 - dice_multi: 0.8331
Epoch 42/100
400/400 - 110s - loss: 0.1288 - dice_multi: 0.8261
Epoch 43/100
400/400 - 110s - loss: 0.1181 - dice_multi: 0.8317
Epoch 44/100
400/400 - 110s - loss: 0.1202 - dice_multi: 0.8395
Epoch 45/100
400/400 - 110s - loss: 0.1220 - dice_multi: 0.8438
Epoch 46/100
400/400 - 110s - loss: 0.1355 - dice_multi: 0.8231
Epoch 47/100
400/400 - 110s - loss: 0.1365 - dice_multi: 0.8233
Epoch 48/100
400/400 - 110s - loss: 0.1213 - dice_multi: 0.8427
Epoch 49/100
400/400 - 110s - loss: 0.1179 - dice_multi: 0.8399
Epoch 50/100
400/400 - 110s - loss: 0.1214 - dice_multi: 0.8449
Epoch 51/100
400/400 - 110s - loss: 0.1355 - dice_multi: 0.8249
Epoch 52/100
400/400 - 110s - loss: 0.1171 - dice_multi: 0.8339
Epoch 53/100
400/400 - 110s - loss: 0.1134 - dice_multi: 0.8396
Epoch 54/100
400/400 - 110s - loss: 0.1205 - dice_multi: 0.8396
Epoch 55/100
400/400 - 110s - loss: 0.1180 - dice_multi: 0.8450
Epoch 56/100
400/400 - 111s - loss: 0.1326 - dice_multi: 0.8238
Epoch 57/100
400/400 - 110s - loss: 0.1121 - dice_multi: 0.8480
Epoch 58/100
400/400 - 110s - loss: 0.1095 - dice_multi: 0.8459
Epoch 59/100
400/400 - 110s - loss: 0.1141 - dice_multi: 0.8390
Epoch 60/100
400/400 - 110s - loss: 0.1196 - dice_multi: 0.8413
Epoch 61/100
400/400 - 110s - loss: 0.1136 - dice_multi: 0.8462
Epoch 62/100
400/400 - 110s - loss: 0.1150 - dice_multi: 0.8410
Epoch 63/100
400/400 - 111s - loss: 0.1133 - dice_multi: 0.8527
Epoch 64/100
400/400 - 111s - loss: 0.1113 - dice_multi: 0.8477
Epoch 65/100
400/400 - 111s - loss: 0.1072 - dice_multi: 0.8482
Epoch 66/100
400/400 - 110s - loss: 0.1108 - dice_multi: 0.8451
Epoch 67/100
400/400 - 111s - loss: 0.1148 - dice_multi: 0.8445
Epoch 68/100
400/400 - 111s - loss: 0.1069 - dice_multi: 0.8554
Epoch 69/100
400/400 - 110s - loss: 0.1277 - dice_multi: 0.8256
Epoch 70/100
400/400 - 110s - loss: 0.1167 - dice_multi: 0.8401
Epoch 71/100
400/400 - 110s - loss: 0.1061 - dice_multi: 0.8468
Epoch 72/100
400/400 - 111s - loss: 0.1071 - dice_multi: 0.8571
Epoch 73/100
400/400 - 110s - loss: 0.1062 - dice_multi: 0.8537
Epoch 74/100
400/400 - 110s - loss: 0.1335 - dice_multi: 0.8320
Epoch 75/100
400/400 - 110s - loss: 0.1130 - dice_multi: 0.8490
Epoch 76/100
400/400 - 111s - loss: 0.1059 - dice_multi: 0.8503
Epoch 77/100
400/400 - 111s - loss: 0.1048 - dice_multi: 0.8550
Epoch 78/100
400/400 - 111s - loss: 0.1017 - dice_multi: 0.8572
Epoch 79/100
400/400 - 110s - loss: 0.1058 - dice_multi: 0.8548
Epoch 80/100
400/400 - 110s - loss: 0.1024 - dice_multi: 0.8541
Epoch 81/100
400/400 - 110s - loss: 0.1358 - dice_multi: 0.8256
Epoch 82/100
400/400 - 110s - loss: 0.1113 - dice_multi: 0.8567
Epoch 83/100
400/400 - 110s - loss: 0.1053 - dice_multi: 0.8534
Epoch 84/100
400/400 - 110s - loss: 0.0983 - dice_multi: 0.8596
Epoch 85/100
400/400 - 110s - loss: 0.1027 - dice_multi: 0.8486
Epoch 86/100
400/400 - 111s - loss: 0.1032 - dice_multi: 0.8579
Epoch 87/100
400/400 - 111s - loss: 0.1087 - dice_multi: 0.8561
Epoch 88/100
400/400 - 110s - loss: 0.1034 - dice_multi: 0.8507
Epoch 89/100
400/400 - 110s - loss: 0.1054 - dice_multi: 0.8577
Epoch 90/100
400/400 - 110s - loss: 0.1015 - dice_multi: 0.8560
Epoch 91/100
400/400 - 111s - loss: 0.1063 - dice_multi: 0.8501
Epoch 92/100
400/400 - 110s - loss: 0.1000 - dice_multi: 0.8623
Epoch 93/100
400/400 - 110s - loss: 0.1182 - dice_multi: 0.8351
Epoch 94/100
400/400 - 111s - loss: 0.1049 - dice_multi: 0.8571
Epoch 95/100
400/400 - 110s - loss: 0.1007 - dice_multi: 0.8596
Epoch 96/100
400/400 - 110s - loss: 0.0988 - dice_multi: 0.8575
Epoch 97/100
400/400 - 110s - loss: 0.0979 - dice_multi: 0.8575
Epoch 98/100
400/400 - 110s - loss: 0.1026 - dice_multi: 0.8519
Epoch 99/100
400/400 - 110s - loss: 0.0997 - dice_multi: 0.8636
Epoch 100/100
400/400 - 110s - loss: 0.1105 - dice_multi: 0.8444
training time: 11054.088688850403
executation time:168.28334846496583
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33
 34 35 36 37 38 39]
training set size:  30
testing set:  [20 21 22 23 24 25 26 27 28 29]
testing set size:  10
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 113s - loss: 0.6477 - dice_multi: 0.3510
Epoch 2/100
400/400 - 110s - loss: 0.5315 - dice_multi: 0.4099
Epoch 3/100
400/400 - 110s - loss: 0.4759 - dice_multi: 0.4453
Epoch 4/100
400/400 - 110s - loss: 0.4243 - dice_multi: 0.4833
Epoch 5/100
400/400 - 110s - loss: 0.3764 - dice_multi: 0.5273
Epoch 6/100
400/400 - 110s - loss: 0.3455 - dice_multi: 0.5754
Epoch 7/100
400/400 - 110s - loss: 0.3056 - dice_multi: 0.6155
Epoch 8/100
400/400 - 110s - loss: 0.2792 - dice_multi: 0.6454
Epoch 9/100
400/400 - 110s - loss: 0.2615 - dice_multi: 0.6887
Epoch 10/100
400/400 - 110s - loss: 0.2395 - dice_multi: 0.6988
Epoch 11/100
400/400 - 110s - loss: 0.2288 - dice_multi: 0.7108
Epoch 12/100
400/400 - 110s - loss: 0.2152 - dice_multi: 0.7274
Epoch 13/100
400/400 - 110s - loss: 0.2023 - dice_multi: 0.7377
Epoch 14/100
400/400 - 110s - loss: 0.1962 - dice_multi: 0.7395
Epoch 15/100
400/400 - 110s - loss: 0.1921 - dice_multi: 0.7492
Epoch 16/100
400/400 - 110s - loss: 0.1796 - dice_multi: 0.7730
Epoch 17/100
400/400 - 110s - loss: 0.1705 - dice_multi: 0.7740
Epoch 18/100
400/400 - 110s - loss: 0.1724 - dice_multi: 0.7794
Epoch 19/100
400/400 - 110s - loss: 0.1720 - dice_multi: 0.7728
Epoch 20/100
400/400 - 110s - loss: 0.1551 - dice_multi: 0.8049
Epoch 21/100
400/400 - 110s - loss: 0.1543 - dice_multi: 0.7961
Epoch 22/100
400/400 - 110s - loss: 0.1688 - dice_multi: 0.7836
Epoch 23/100
400/400 - 110s - loss: 0.1616 - dice_multi: 0.7891
Epoch 24/100
400/400 - 110s - loss: 0.1496 - dice_multi: 0.8100
Epoch 25/100
400/400 - 110s - loss: 0.1481 - dice_multi: 0.8073
Epoch 26/100
400/400 - 110s - loss: 0.1349 - dice_multi: 0.8102
Epoch 27/100
400/400 - 110s - loss: 0.1545 - dice_multi: 0.7916
Epoch 28/100
400/400 - 110s - loss: 0.1506 - dice_multi: 0.8041
Epoch 29/100
400/400 - 110s - loss: 0.1339 - dice_multi: 0.8191
Epoch 30/100
400/400 - 110s - loss: 0.1361 - dice_multi: 0.8121
Epoch 31/100
400/400 - 110s - loss: 0.1478 - dice_multi: 0.8046
Epoch 32/100
400/400 - 110s - loss: 0.1369 - dice_multi: 0.8122
Epoch 33/100
400/400 - 110s - loss: 0.1337 - dice_multi: 0.8205
Epoch 34/100
400/400 - 110s - loss: 0.1482 - dice_multi: 0.8009
Epoch 35/100
400/400 - 110s - loss: 0.1303 - dice_multi: 0.8185
Epoch 36/100
400/400 - 111s - loss: 0.1236 - dice_multi: 0.8292
Epoch 37/100
400/400 - 110s - loss: 0.1218 - dice_multi: 0.8266
Epoch 38/100
400/400 - 110s - loss: 0.1375 - dice_multi: 0.8239
Epoch 39/100
400/400 - 110s - loss: 0.1284 - dice_multi: 0.8233
Epoch 40/100
400/400 - 110s - loss: 0.1503 - dice_multi: 0.8001
Epoch 41/100
400/400 - 111s - loss: 0.1280 - dice_multi: 0.8204
Epoch 42/100
400/400 - 110s - loss: 0.1200 - dice_multi: 0.8292
Epoch 43/100
400/400 - 110s - loss: 0.1190 - dice_multi: 0.8305
Epoch 44/100
400/400 - 111s - loss: 0.1174 - dice_multi: 0.8348
Epoch 45/100
400/400 - 110s - loss: 0.1179 - dice_multi: 0.8289
Epoch 46/100
400/400 - 110s - loss: 0.1215 - dice_multi: 0.8327
Epoch 47/100
400/400 - 111s - loss: 0.1243 - dice_multi: 0.8167
Epoch 48/100
400/400 - 110s - loss: 0.1178 - dice_multi: 0.8405
Epoch 49/100
400/400 - 110s - loss: 0.1121 - dice_multi: 0.8407
Epoch 50/100
400/400 - 110s - loss: 0.1516 - dice_multi: 0.8053
Epoch 51/100
400/400 - 110s - loss: 0.1182 - dice_multi: 0.8359
Epoch 52/100
400/400 - 111s - loss: 0.1136 - dice_multi: 0.8378
Epoch 53/100
400/400 - 110s - loss: 0.1085 - dice_multi: 0.8400
Epoch 54/100
400/400 - 111s - loss: 0.1107 - dice_multi: 0.8372
Epoch 55/100
400/400 - 110s - loss: 0.1234 - dice_multi: 0.8263
Epoch 56/100
400/400 - 110s - loss: 0.1215 - dice_multi: 0.8262
Epoch 57/100
400/400 - 110s - loss: 0.1115 - dice_multi: 0.8385
Epoch 58/100
400/400 - 111s - loss: 0.1111 - dice_multi: 0.8366
Epoch 59/100
400/400 - 110s - loss: 0.1092 - dice_multi: 0.8360
Epoch 60/100
400/400 - 110s - loss: 0.1069 - dice_multi: 0.8465
Epoch 61/100
400/400 - 110s - loss: 0.1171 - dice_multi: 0.8388
Epoch 62/100
400/400 - 110s - loss: 0.1061 - dice_multi: 0.8487
Epoch 63/100
400/400 - 110s - loss: 0.1188 - dice_multi: 0.8393
Epoch 64/100
400/400 - 110s - loss: 0.1166 - dice_multi: 0.8382
Epoch 65/100
400/400 - 110s - loss: 0.1051 - dice_multi: 0.8493
Epoch 66/100
400/400 - 110s - loss: 0.1331 - dice_multi: 0.8179
Epoch 67/100
400/400 - 110s - loss: 0.1111 - dice_multi: 0.8417
Epoch 68/100
400/400 - 110s - loss: 0.1059 - dice_multi: 0.8510
Epoch 69/100
400/400 - 110s - loss: 0.1037 - dice_multi: 0.8472
Epoch 70/100
400/400 - 110s - loss: 0.1156 - dice_multi: 0.8357
Epoch 71/100
400/400 - 110s - loss: 0.1066 - dice_multi: 0.8433
Epoch 72/100
400/400 - 111s - loss: 0.1029 - dice_multi: 0.8508
Epoch 73/100
400/400 - 111s - loss: 0.1013 - dice_multi: 0.8546
Epoch 74/100
400/400 - 110s - loss: 0.1020 - dice_multi: 0.8533
Epoch 75/100
400/400 - 110s - loss: 0.1591 - dice_multi: 0.8053
Epoch 76/100
400/400 - 110s - loss: 0.1139 - dice_multi: 0.8430
Epoch 77/100
400/400 - 110s - loss: 0.1038 - dice_multi: 0.8503
Epoch 78/100
400/400 - 111s - loss: 0.1039 - dice_multi: 0.8531
Epoch 79/100
400/400 - 110s - loss: 0.1015 - dice_multi: 0.8531
Epoch 80/100
400/400 - 110s - loss: 0.1012 - dice_multi: 0.8522
Epoch 81/100
400/400 - 110s - loss: 0.1016 - dice_multi: 0.8524
Epoch 82/100
400/400 - 111s - loss: 0.1228 - dice_multi: 0.8278
Epoch 83/100
400/400 - 111s - loss: 0.1074 - dice_multi: 0.8518
Epoch 84/100
400/400 - 111s - loss: 0.1015 - dice_multi: 0.8504
Epoch 85/100
400/400 - 110s - loss: 0.1039 - dice_multi: 0.8572
Epoch 86/100
400/400 - 110s - loss: 0.1017 - dice_multi: 0.8570
Epoch 87/100
400/400 - 110s - loss: 0.0991 - dice_multi: 0.8602
Epoch 88/100
400/400 - 111s - loss: 0.0966 - dice_multi: 0.8555
Epoch 89/100
400/400 - 110s - loss: 0.1341 - dice_multi: 0.8153
Epoch 90/100
400/400 - 111s - loss: 0.1066 - dice_multi: 0.8479
Epoch 91/100
400/400 - 111s - loss: 0.0998 - dice_multi: 0.8589
Epoch 92/100
400/400 - 110s - loss: 0.0978 - dice_multi: 0.8533
Epoch 93/100
400/400 - 110s - loss: 0.1040 - dice_multi: 0.8494
Epoch 94/100
400/400 - 110s - loss: 0.1284 - dice_multi: 0.8227
Epoch 95/100
400/400 - 110s - loss: 0.1055 - dice_multi: 0.8524
Epoch 96/100
400/400 - 110s - loss: 0.0991 - dice_multi: 0.8549
Epoch 97/100
400/400 - 110s - loss: 0.0989 - dice_multi: 0.8607
Epoch 98/100
400/400 - 110s - loss: 0.0968 - dice_multi: 0.8619
Epoch 99/100
400/400 - 110s - loss: 0.0969 - dice_multi: 0.8565
Epoch 100/100
400/400 - 111s - loss: 0.0969 - dice_multi: 0.8585
training time: 11043.359975337982
executation time:168.14693644046784
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]
training set size:  30
testing set:  [30 31 32 33 34 35 36 37 38 39 40]
testing set size:  11
..generator_len: 400
..training_n_subject: 30
..training_n_patch_per_sub: 2421185
Epoch 1/100
400/400 - 114s - loss: 0.6810 - dice_multi: 0.3945
Epoch 2/100
400/400 - 110s - loss: 0.5527 - dice_multi: 0.4624
Epoch 3/100
400/400 - 110s - loss: 0.4579 - dice_multi: 0.5255
Epoch 4/100
400/400 - 110s - loss: 0.3988 - dice_multi: 0.5792
Epoch 5/100
400/400 - 110s - loss: 0.3445 - dice_multi: 0.6313
Epoch 6/100
400/400 - 110s - loss: 0.3112 - dice_multi: 0.6703
Epoch 7/100
400/400 - 110s - loss: 0.2827 - dice_multi: 0.6948
Epoch 8/100
400/400 - 110s - loss: 0.2629 - dice_multi: 0.7251
Epoch 9/100
400/400 - 110s - loss: 0.2353 - dice_multi: 0.7465
Epoch 10/100
400/400 - 110s - loss: 0.2250 - dice_multi: 0.7539
Epoch 11/100
400/400 - 110s - loss: 0.2303 - dice_multi: 0.7520
Epoch 12/100
400/400 - 110s - loss: 0.2149 - dice_multi: 0.7757
Epoch 13/100
400/400 - 110s - loss: 0.1990 - dice_multi: 0.7771
Epoch 14/100
400/400 - 110s - loss: 0.1931 - dice_multi: 0.7910
Epoch 15/100
400/400 - 110s - loss: 0.1859 - dice_multi: 0.7932
Epoch 16/100
400/400 - 110s - loss: 0.1795 - dice_multi: 0.8050
Epoch 17/100
400/400 - 110s - loss: 0.1857 - dice_multi: 0.7921
Epoch 18/100
400/400 - 110s - loss: 0.1626 - dice_multi: 0.8092
Epoch 19/100
400/400 - 110s - loss: 0.1617 - dice_multi: 0.8135
Epoch 20/100
400/400 - 110s - loss: 0.1791 - dice_multi: 0.7981
Epoch 21/100
400/400 - 110s - loss: 0.1706 - dice_multi: 0.8098
Epoch 22/100
400/400 - 110s - loss: 0.1576 - dice_multi: 0.8263
Epoch 23/100
400/400 - 110s - loss: 0.1571 - dice_multi: 0.8201
Epoch 24/100
400/400 - 110s - loss: 0.1670 - dice_multi: 0.8096
Epoch 25/100
400/400 - 110s - loss: 0.1655 - dice_multi: 0.8101
Epoch 26/100
400/400 - 110s - loss: 0.1475 - dice_multi: 0.8392
Epoch 27/100
400/400 - 110s - loss: 0.1591 - dice_multi: 0.8316
Epoch 28/100
400/400 - 110s - loss: 0.1625 - dice_multi: 0.8147
Epoch 29/100
400/400 - 110s - loss: 0.1462 - dice_multi: 0.8348
Epoch 30/100
400/400 - 110s - loss: 0.1410 - dice_multi: 0.8372
Epoch 31/100
400/400 - 110s - loss: 0.1503 - dice_multi: 0.8335
Epoch 32/100
400/400 - 110s - loss: 0.1585 - dice_multi: 0.8209
Epoch 33/100
400/400 - 110s - loss: 0.1541 - dice_multi: 0.8311
Epoch 34/100
400/400 - 110s - loss: 0.1571 - dice_multi: 0.8189
Epoch 35/100
400/400 - 110s - loss: 0.1432 - dice_multi: 0.8386
Epoch 36/100
400/400 - 110s - loss: 0.1354 - dice_multi: 0.8395
Epoch 37/100
400/400 - 110s - loss: 0.1332 - dice_multi: 0.8449
Epoch 38/100
400/400 - 110s - loss: 0.1303 - dice_multi: 0.8468
Epoch 39/100
400/400 - 110s - loss: 0.1359 - dice_multi: 0.8418
Epoch 40/100
400/400 - 110s - loss: 0.1366 - dice_multi: 0.8429
Epoch 41/100
400/400 - 110s - loss: 0.1373 - dice_multi: 0.8347
Epoch 42/100
400/400 - 110s - loss: 0.1377 - dice_multi: 0.8381
Epoch 43/100
400/400 - 110s - loss: 0.1624 - dice_multi: 0.8266
Epoch 44/100
400/400 - 110s - loss: 0.1310 - dice_multi: 0.8509
Epoch 45/100
400/400 - 110s - loss: 0.1249 - dice_multi: 0.8508
Epoch 46/100
400/400 - 110s - loss: 0.1265 - dice_multi: 0.8538
Epoch 47/100
400/400 - 110s - loss: 0.1225 - dice_multi: 0.8521
Epoch 48/100
400/400 - 110s - loss: 0.1261 - dice_multi: 0.8464
Epoch 49/100
400/400 - 110s - loss: 0.1470 - dice_multi: 0.8296
Epoch 50/100
400/400 - 110s - loss: 0.1301 - dice_multi: 0.8524
Epoch 51/100
400/400 - 110s - loss: 0.1240 - dice_multi: 0.8458
Epoch 52/100
400/400 - 110s - loss: 0.1223 - dice_multi: 0.8509
Epoch 53/100
400/400 - 110s - loss: 0.1401 - dice_multi: 0.8439
Epoch 54/100
400/400 - 110s - loss: 0.1264 - dice_multi: 0.8531
Epoch 55/100
400/400 - 110s - loss: 0.1174 - dice_multi: 0.8598
Epoch 56/100
400/400 - 110s - loss: 0.1221 - dice_multi: 0.8551
Epoch 57/100
400/400 - 110s - loss: 0.1196 - dice_multi: 0.8624
Epoch 58/100
400/400 - 110s - loss: 0.1373 - dice_multi: 0.8438
Epoch 59/100
400/400 - 110s - loss: 0.1292 - dice_multi: 0.8538
Epoch 60/100
400/400 - 110s - loss: 0.1200 - dice_multi: 0.8512
Epoch 61/100
400/400 - 110s - loss: 0.1207 - dice_multi: 0.8646
Epoch 62/100
400/400 - 110s - loss: 0.1301 - dice_multi: 0.8484
Epoch 63/100
400/400 - 110s - loss: 0.1249 - dice_multi: 0.8540
Epoch 64/100
400/400 - 110s - loss: 0.1182 - dice_multi: 0.8591
Epoch 65/100
400/400 - 110s - loss: 0.1171 - dice_multi: 0.8557
Epoch 66/100
400/400 - 110s - loss: 0.1163 - dice_multi: 0.8492
Epoch 67/100
400/400 - 110s - loss: 0.1439 - dice_multi: 0.8328
Epoch 68/100
400/400 - 110s - loss: 0.1226 - dice_multi: 0.8514
Epoch 69/100
400/400 - 110s - loss: 0.1140 - dice_multi: 0.8598
Epoch 70/100
400/400 - 110s - loss: 0.1166 - dice_multi: 0.8578
Epoch 71/100
400/400 - 110s - loss: 0.1114 - dice_multi: 0.8570
Epoch 72/100
400/400 - 110s - loss: 0.1123 - dice_multi: 0.8619
Epoch 73/100
400/400 - 110s - loss: 0.1145 - dice_multi: 0.8622
Epoch 74/100
400/400 - 110s - loss: 0.1133 - dice_multi: 0.8651
Epoch 75/100
400/400 - 110s - loss: 0.1136 - dice_multi: 0.8616
Epoch 76/100
400/400 - 110s - loss: 0.1109 - dice_multi: 0.8596
Epoch 77/100
400/400 - 110s - loss: 0.1467 - dice_multi: 0.8415
Epoch 78/100
400/400 - 110s - loss: 0.1188 - dice_multi: 0.8630
Epoch 79/100
400/400 - 110s - loss: 0.1131 - dice_multi: 0.8637
Epoch 80/100
400/400 - 110s - loss: 0.1117 - dice_multi: 0.8691
Epoch 81/100
400/400 - 111s - loss: 0.1117 - dice_multi: 0.8609
Epoch 82/100
400/400 - 110s - loss: 0.1095 - dice_multi: 0.8698
Epoch 83/100
400/400 - 110s - loss: 0.1111 - dice_multi: 0.8626
Epoch 84/100
400/400 - 110s - loss: 0.1316 - dice_multi: 0.8479
Epoch 85/100
400/400 - 110s - loss: 0.1146 - dice_multi: 0.8615
Epoch 86/100
400/400 - 110s - loss: 0.1138 - dice_multi: 0.8714
Epoch 87/100
400/400 - 110s - loss: 0.1095 - dice_multi: 0.8684
Epoch 88/100
400/400 - 110s - loss: 0.1118 - dice_multi: 0.8594
Epoch 89/100
400/400 - 110s - loss: 0.1184 - dice_multi: 0.8562
Epoch 90/100
400/400 - 110s - loss: 0.1082 - dice_multi: 0.8699
Epoch 91/100
400/400 - 110s - loss: 0.1082 - dice_multi: 0.8678
Epoch 92/100
400/400 - 110s - loss: 0.1412 - dice_multi: 0.8407
Epoch 93/100
400/400 - 110s - loss: 0.1147 - dice_multi: 0.8601
Epoch 94/100
400/400 - 110s - loss: 0.1104 - dice_multi: 0.8657
Epoch 95/100
400/400 - 110s - loss: 0.1067 - dice_multi: 0.8651
Epoch 96/100
400/400 - 111s - loss: 0.1056 - dice_multi: 0.8648
Epoch 97/100
400/400 - 110s - loss: 0.1071 - dice_multi: 0.8680
Epoch 98/100
400/400 - 111s - loss: 0.1074 - dice_multi: 0.8650
Epoch 99/100
400/400 - 110s - loss: 0.1063 - dice_multi: 0.8671
Epoch 100/100
400/400 - 110s - loss: 0.1104 - dice_multi: 0.8583
training time: 11039.511606931686
executation time:168.2520540410822
[0.992859  0.9460151 0.8190444 0.8978563 0.8364852 0.9048908 0.9013922]
